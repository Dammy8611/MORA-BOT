const a0_0x5c3163=a0_0x31ef;(function(_0x57aa39,_0x3fa67a){const _0x295a47=a0_0x31ef,_0x57fc45=_0x57aa39();while(!![]){try{const _0xcb683d=parseInt(_0x295a47(0x178))/0x1+-parseInt(_0x295a47(0x167))/0x2*(parseInt(_0x295a47(0x1d5))/0x3)+-parseInt(_0x295a47(0x1c7))/0x4*(parseInt(_0x295a47(0x1c0))/0x5)+-parseInt(_0x295a47(0x1da))/0x6*(-parseInt(_0x295a47(0x1c9))/0x7)+-parseInt(_0x295a47(0x1a0))/0x8*(parseInt(_0x295a47(0x1a7))/0x9)+-parseInt(_0x295a47(0x18e))/0xa*(parseInt(_0x295a47(0x1cf))/0xb)+parseInt(_0x295a47(0x191))/0xc;if(_0xcb683d===_0x3fa67a)break;else _0x57fc45['push'](_0x57fc45['shift']());}catch(_0x280210){_0x57fc45['push'](_0x57fc45['shift']());}}}(a0_0x3e29,0xb2d7a));const {downloadMediaMessage}=require(a0_0x5c3163(0x1d9)),fs=require('fs'),path=require('path'),ffmpeg=require(a0_0x5c3163(0x18f)),{StatusUpdater}=require(a0_0x5c3163(0x16b));let ffmpegPath;try{ffmpegPath=require(a0_0x5c3163(0x1b0)),ffmpeg[a0_0x5c3163(0x1b9)](ffmpegPath);}catch(a0_0x22b759){console['warn'](a0_0x5c3163(0x16e));}function a0_0x3e29(){const _0x5e3d59=['status','mimetype','string','length','Please\x20try\x20with\x20a\x20different\x20file\x20format\x20(MP3/WAV\x20preferred).','audio_document','27379nkOauC','now','•\x20Reply\x20to\x20a\x20voice\x20note/audio\x20message\x0a','video','remoteJid','Network\x20error\x20occurred.','includes','toFixed','video_document','input_','readFileSync','FFmpeg\x20processing\x20failed.\x20','\x0aSupported\x20formats:\x20','No\x20such\x20file','audioCodec','mp3','audio/','!transcribe\x20[custom_prompt]\x20(reply\x20to\x20voice/audio/video\x20or\x20audio\x20document)','message','fileName','error','end','8560whfEed','fluent-ffmpeg','🎙️\x20Processing\x20audio...\x20Please\x20wait...','38943876fyNmIz','format','output_','startsWith','existsSync','pow','network','writeFileSync','❌\x20An\x20error\x20occurred\x20while\x20processing\x20your\x20request.\x20Please\x20try\x20again.','Invalid\x20response\x20format','videoMessage','🔄\x20Converting\x20to\x20supported\x20format...\x20Please\x20wait...','❌\x20Unsupported\x20audio\x20format:\x20','Please\x20try\x20again\x20later.','Download\x20error:','16gUZlRE','user','Audio\x20format\x20may\x20not\x20be\x20supported\x20or\x20file\x20is\x20corrupted.','video/','•\x20Use\x20this\x20command\x20as\x20caption\x20on\x20audio/video\x0a\x0a','.mp3','pcm_s16le','6041322ySJAin','.mp4','•\x20Size:\x20','openai-audio','application/json','../../temp','quotedMessage','audio','📊\x20*Audio\x20Info:*\x0a','ffmpeg-static','json','https://text.pollinations.ai/openai?token=mbyimPYnoahfK2cW','contextInfo','📝\x20Example:\x20!transcribe\x0a','•\x20Duration:\x20~','.wav','start','extendedTextMessage','setFfmpegPath','❌\x20File\x20too\x20large!\x20Maximum\x20size\x20is\x2050MB.\x0aYour\x20file:\x20','exports','noVideo','prompt','Audio\x20file\x20is\x20too\x20large.','HTTP\x20error!\x20status:\x20','9355IyPoOF','toString','POST','update','forEach','audioChannels','replace','1564MbOFfE','done','656908RwKmMX','•\x20Format:\x20','floor','0\x20B','stringify','FFmpeg\x20error:','12386eGnxHV','content','📝\x20*Transcription:*\x0a','❌\x20Failed\x20to\x20convert\x20audio/video.\x20','Convert\x20speech\x20to\x20text\x20from\x20voice\x20notes,\x20audio,\x20or\x20video\x20files','•\x20Reply\x20to\x20an\x20audio/video\x20document\x0a','14613RBfZEJ','choices','key','❌\x20Failed\x20to\x20download\x20the\x20media.\x20Please\x20try\x20again.','@yupra/baileys','72MXUnFd','input_audio','document','progress','Output\x20file\x20was\x20not\x20created','percent','audioMessage','🤖\x20Transcribing\x20audio\x20with\x20AI...\x20Please\x20wait...','round','join','log','stt','toUpperCase','wav','📝\x20Custom:\x20!transcribe\x20Please\x20transcribe\x20this\x20meeting\x20recording\x0a\x0a','Conversion\x20failed:\x20','toLowerCase','258vebKqB','Direct\x20transcription\x20failed,\x20trying\x20conversion:','documentMessage','unlinkSync','../../utils/statusUpdater.js','text','buffer','ffmpeg-static\x20not\x20found,\x20falling\x20back\x20to\x20system\x20ffmpeg','fetch','audioFrequency','FFmpeg\x20stderr:'];a0_0x3e29=function(){return _0x5e3d59;};return a0_0x3e29();}module[a0_0x5c3163(0x1bb)]={'meta':{'name':'transcribe','description':a0_0x5c3163(0x1d3),'aliases':[a0_0x5c3163(0x161),'speechtotext','voicetotext'],'usage':a0_0x5c3163(0x189),'category':'ai','args':[{'name':'prompt','type':a0_0x5c3163(0x174),'greedy':!![],'required':![]}]},'run':async({m:_0x392083,sock:_0x4b1285,args:_0x1f58e5})=>{const _0x221c87=a0_0x5c3163,_0x398e0a=new StatusUpdater(_0x4b1285,_0x392083[_0x221c87(0x1d7)][_0x221c87(0x17c)]);try{let _0x5705e3=null,_0x57f25a=![],_0x1ef16b=null;const _0x17705c=_0x1f58e5[_0x221c87(0x1bd)]||'Transcribe\x20this\x20audio\x20accurately\x20with\x20proper\x20punctuation\x20and\x20formatting.';await _0x398e0a[_0x221c87(0x1b7)]();if(_0x392083[_0x221c87(0x18a)]?.[_0x221c87(0x1b8)]?.[_0x221c87(0x1b3)]?.['quotedMessage']){const _0x3ce004=_0x392083[_0x221c87(0x18a)][_0x221c87(0x1b8)][_0x221c87(0x1b3)]['quotedMessage'];if(_0x3ce004['audioMessage'])_0x5705e3=_0x3ce004[_0x221c87(0x1e0)],_0x1ef16b=_0x221c87(0x1ae),_0x57f25a=!![];else{if(_0x3ce004[_0x221c87(0x19b)])_0x5705e3=_0x3ce004[_0x221c87(0x19b)],_0x1ef16b=_0x221c87(0x17b),_0x57f25a=!![];else{if(_0x3ce004['documentMessage']){const _0x3e32ee=_0x3ce004['documentMessage'][_0x221c87(0x173)]||'';(_0x3e32ee[_0x221c87(0x194)](_0x221c87(0x188))||_0x3e32ee[_0x221c87(0x194)]('video/'))&&(_0x5705e3=_0x3ce004[_0x221c87(0x169)],_0x1ef16b=_0x3e32ee[_0x221c87(0x194)](_0x221c87(0x188))?'audio_document':_0x221c87(0x180),_0x57f25a=!![]);}}}}if(!_0x57f25a){if(_0x392083[_0x221c87(0x18a)]?.[_0x221c87(0x1e0)])_0x5705e3=_0x392083[_0x221c87(0x18a)][_0x221c87(0x1e0)],_0x1ef16b=_0x221c87(0x1ae);else{if(_0x392083[_0x221c87(0x18a)]?.[_0x221c87(0x19b)])_0x5705e3=_0x392083[_0x221c87(0x18a)][_0x221c87(0x19b)],_0x1ef16b=_0x221c87(0x17b);else{if(_0x392083[_0x221c87(0x18a)]?.['documentMessage']){const _0x123c1c=_0x392083[_0x221c87(0x18a)][_0x221c87(0x169)][_0x221c87(0x173)]||'';(_0x123c1c[_0x221c87(0x194)](_0x221c87(0x188))||_0x123c1c[_0x221c87(0x194)](_0x221c87(0x1a3)))&&(_0x5705e3=_0x392083[_0x221c87(0x18a)][_0x221c87(0x169)],_0x1ef16b=_0x123c1c[_0x221c87(0x194)](_0x221c87(0x188))?_0x221c87(0x177):_0x221c87(0x180));}}}}if(!_0x5705e3)return await _0x398e0a[_0x221c87(0x1c8)]({'text':'❌\x20No\x20audio/video\x20found!\x20Please:\x0a'+_0x221c87(0x17a)+'•\x20Reply\x20to\x20a\x20video\x20message\x0a'+_0x221c87(0x1d4)+_0x221c87(0x1a4)+_0x221c87(0x1b4)+_0x221c87(0x164)+'🎙️\x20Supported:\x20Voice\x20notes,\x20audio\x20files\x20(MP3,\x20WAV),\x20video\x20files'});await _0x398e0a[_0x221c87(0x1c3)](_0x221c87(0x190));let _0x2af84b,_0x3d63cc=_0x221c87(0x1ae);try{if(_0x57f25a){const _0x205909={'key':_0x392083[_0x221c87(0x1d7)],'message':_0x392083[_0x221c87(0x18a)]['extendedTextMessage']['contextInfo'][_0x221c87(0x1ad)]};_0x2af84b=await downloadMediaMessage(_0x205909,_0x221c87(0x16d),{});}else _0x2af84b=await downloadMediaMessage(_0x392083,_0x221c87(0x16d),{});_0x1ef16b[_0x221c87(0x17e)](_0x221c87(0x1dc))&&_0x5705e3[_0x221c87(0x18b)]&&(_0x3d63cc=_0x5705e3[_0x221c87(0x18b)]);const _0x26eb39=0x32*0x400*0x400;if(_0x2af84b[_0x221c87(0x175)]>_0x26eb39)return await _0x398e0a['done']({'text':_0x221c87(0x1ba)+(_0x2af84b['length']/(0x400*0x400))['toFixed'](0x2)+'MB'});}catch(_0x54edf0){return console[_0x221c87(0x18c)](_0x221c87(0x19f),_0x54edf0),await _0x398e0a['done']({'text':_0x221c87(0x1d8)});}return await _0x398e0a[_0x221c87(0x1c3)](_0x221c87(0x19c)),await processAndTranscribe(_0x2af84b,_0x1ef16b,_0x3d63cc,_0x17705c,_0x392083,_0x4b1285,_0x398e0a);}catch(_0x204719){return console['error']('Transcribe\x20command\x20error:',_0x204719),await _0x398e0a[_0x221c87(0x1c8)]({'text':_0x221c87(0x199)});}}};function a0_0x31ef(_0x2d2761,_0x2d1ec4){const _0x3e2998=a0_0x3e29();return a0_0x31ef=function(_0x31efec,_0x4a7b6d){_0x31efec=_0x31efec-0x15d;let _0x21b359=_0x3e2998[_0x31efec];return _0x21b359;},a0_0x31ef(_0x2d2761,_0x2d1ec4);}async function processAndTranscribe(_0x5e6736,_0x4d62ad,_0x431560,_0x460d5b,_0x3334b2,_0x16ece0,_0x5ea180){const _0x32594a=a0_0x5c3163,_0x495398=path[_0x32594a(0x15f)](__dirname,_0x32594a(0x1ac));!fs['existsSync'](_0x495398)&&fs['mkdirSync'](_0x495398,{'recursive':!![]});const _0x222e33=Date[_0x32594a(0x179)]();let _0x5a846a,_0x8f1936;try{let _0x1d532f='.ogg';if(_0x4d62ad[_0x32594a(0x17e)]('document')){const _0x3c8b10=path['extname'](_0x431560)[_0x32594a(0x166)]();_0x1d532f=_0x3c8b10||_0x32594a(0x1a5);}else(_0x4d62ad==='video'||_0x4d62ad===_0x32594a(0x180))&&(_0x1d532f=_0x32594a(0x1a8));_0x5a846a=path[_0x32594a(0x15f)](_0x495398,_0x32594a(0x181)+_0x222e33+_0x1d532f),_0x8f1936=path[_0x32594a(0x15f)](_0x495398,_0x32594a(0x193)+_0x222e33+_0x32594a(0x1b6)),fs[_0x32594a(0x198)](_0x5a846a,_0x5e6736);if((_0x1d532f===_0x32594a(0x1a5)||_0x1d532f===_0x32594a(0x1b6))&&!_0x4d62ad[_0x32594a(0x17e)](_0x32594a(0x17b)))try{return await transcribeAudio(_0x5e6736,_0x1d532f[_0x32594a(0x1c6)]('.',''),_0x460d5b,_0x3334b2,_0x16ece0,_0x5ea180,_0x431560);}catch(_0x268c9c){console[_0x32594a(0x160)](_0x32594a(0x168),_0x268c9c['message']);}await new Promise((_0x191c3d,_0x58eda3)=>{const _0x2d3e59=_0x32594a;let _0x2ff0de=ffmpeg(_0x5a846a);_0x4d62ad===_0x2d3e59(0x17b)||_0x4d62ad==='video_document'?_0x2ff0de=_0x2ff0de[_0x2d3e59(0x1bc)]()['audioCodec'](_0x2d3e59(0x1a6))[_0x2d3e59(0x170)](0xac44)[_0x2d3e59(0x1c5)](0x2)[_0x2d3e59(0x192)](_0x2d3e59(0x163)):_0x2ff0de=_0x2ff0de[_0x2d3e59(0x186)]('pcm_s16le')['audioFrequency'](0xac44)[_0x2d3e59(0x1c5)](0x2)['format']('wav'),_0x2ff0de['on'](_0x2d3e59(0x1b7),_0x2a421a=>{})['on'](_0x2d3e59(0x1dd),_0x27c0c2=>{const _0x5b3b80=_0x2d3e59;if(_0x27c0c2[_0x5b3b80(0x1df)]){}})['on'](_0x2d3e59(0x18c),(_0x572d76,_0x119e30,_0x48cd59)=>{const _0x27c9d6=_0x2d3e59;console[_0x27c9d6(0x18c)](_0x27c9d6(0x1ce),_0x572d76[_0x27c9d6(0x18a)]),console[_0x27c9d6(0x18c)](_0x27c9d6(0x171),_0x48cd59),_0x58eda3(new Error(_0x27c9d6(0x165)+_0x572d76[_0x27c9d6(0x18a)]));})['on'](_0x2d3e59(0x18d),()=>{_0x191c3d();})['save'](_0x8f1936);});if(!fs[_0x32594a(0x195)](_0x8f1936))throw new Error(_0x32594a(0x1de));const _0x10815d=fs[_0x32594a(0x182)](_0x8f1936);return await transcribeAudio(_0x10815d,_0x32594a(0x163),_0x460d5b,_0x3334b2,_0x16ece0,_0x5ea180,_0x431560);}catch(_0x39c4b2){console[_0x32594a(0x18c)]('Audio\x20conversion\x20error:',_0x39c4b2),[_0x5a846a,_0x8f1936][_0x32594a(0x1c4)](_0x16e5ee=>{const _0x574a22=_0x32594a;if(_0x16e5ee&&fs[_0x574a22(0x195)](_0x16e5ee))try{fs['unlinkSync'](_0x16e5ee);}catch(_0x329835){}});let _0x1c227f=_0x32594a(0x1d2);return _0x39c4b2['message'][_0x32594a(0x17e)]('ffmpeg')&&(_0x1c227f+=_0x32594a(0x183)),_0x39c4b2[_0x32594a(0x18a)][_0x32594a(0x17e)](_0x32594a(0x185))&&(_0x1c227f+='Input\x20file\x20not\x20found.\x20'),_0x1c227f+=_0x32594a(0x176),await _0x5ea180['done']({'text':_0x1c227f});}finally{[_0x5a846a,_0x8f1936][_0x32594a(0x1c4)](_0x2c3326=>{const _0x4ec73e=_0x32594a;if(_0x2c3326&&fs['existsSync'](_0x2c3326))try{fs[_0x4ec73e(0x16a)](_0x2c3326);}catch(_0x4d1235){}});}}async function transcribeAudio(_0x4f2ed9,_0xff9639,_0x3cc02a,_0x8d5fa5,_0x8ad296,_0x2acf96,_0x21e87f){const _0x1bd31d=a0_0x5c3163;try{const _0x554ba4=_0x4f2ed9[_0x1bd31d(0x1c1)]('base64'),_0x543673=[_0x1bd31d(0x187),_0x1bd31d(0x163)];if(!_0x543673[_0x1bd31d(0x17e)](_0xff9639))return await _0x2acf96[_0x1bd31d(0x1c8)]({'text':_0x1bd31d(0x19d)+_0xff9639+_0x1bd31d(0x184)+_0x543673['join'](',\x20')});await _0x2acf96[_0x1bd31d(0x1c3)](_0x1bd31d(0x15d));const _0x2c5413={'model':_0x1bd31d(0x1aa),'messages':[{'role':_0x1bd31d(0x1a1),'content':[{'type':_0x1bd31d(0x16c),'text':_0x3cc02a},{'type':_0x1bd31d(0x1db),'input_audio':{'data':_0x554ba4,'format':_0xff9639}}]}]},_0x2980dd=await fetch(_0x1bd31d(0x1b2),{'method':_0x1bd31d(0x1c2),'headers':{'Content-Type':_0x1bd31d(0x1ab)},'body':JSON[_0x1bd31d(0x1cd)](_0x2c5413)});if(!_0x2980dd['ok'])throw new Error(_0x1bd31d(0x1bf)+_0x2980dd[_0x1bd31d(0x172)]);const _0x2acb9b=await _0x2980dd[_0x1bd31d(0x1b1)]();if(_0x2acb9b[_0x1bd31d(0x1d6)]&&_0x2acb9b[_0x1bd31d(0x1d6)][0x0]&&_0x2acb9b[_0x1bd31d(0x1d6)][0x0]['message']){const _0xd328e6=_0x2acb9b['choices'][0x0][_0x1bd31d(0x18a)][_0x1bd31d(0x1d0)],_0xd1529a=_0x4b6f7e=>{const _0x2fbb4b=_0x1bd31d;if(_0x4b6f7e===0x0)return _0x2fbb4b(0x1cc);const _0x1ca03d=0x400,_0x2b02a1=['B','KB','MB','GB'],_0x1d855e=Math[_0x2fbb4b(0x1cb)](Math[_0x2fbb4b(0x160)](_0x4b6f7e)/Math[_0x2fbb4b(0x160)](_0x1ca03d));return parseFloat((_0x4b6f7e/Math[_0x2fbb4b(0x196)](_0x1ca03d,_0x1d855e))[_0x2fbb4b(0x17f)](0x2))+'\x20'+_0x2b02a1[_0x1d855e];},_0x39edc9=Math[_0x1bd31d(0x15e)](_0x4f2ed9[_0x1bd31d(0x175)]/(0xac44*0x2*0x2));let _0x29c15b='🎙️\x20*Audio\x20Transcription*\x0a\x0a';return _0x29c15b+=_0x1bd31d(0x1d1)+_0xd328e6+'\x0a\x0a',_0x29c15b+=_0x1bd31d(0x1af),_0x29c15b+=_0x1bd31d(0x1ca)+_0xff9639[_0x1bd31d(0x162)]()+'\x0a',_0x29c15b+=_0x1bd31d(0x1a9)+_0xd1529a(_0x4f2ed9[_0x1bd31d(0x175)])+'\x0a',_0x39edc9>0x0&&(_0x29c15b+=_0x1bd31d(0x1b5)+_0x39edc9+'s\x0a'),_0x21e87f&&_0x21e87f!=='audio'&&(_0x29c15b+='•\x20File:\x20'+_0x21e87f+'\x0a'),await _0x2acf96[_0x1bd31d(0x1c8)]({'text':_0x29c15b});}else throw new Error(_0x1bd31d(0x19a));}catch(_0x602227){console[_0x1bd31d(0x18c)]('Transcription\x20error:',_0x602227);let _0x1befea='❌\x20Failed\x20to\x20transcribe\x20audio!\x20';if(_0x602227[_0x1bd31d(0x18a)]?.[_0x1bd31d(0x17e)]('HTTP\x20error!\x20status:\x20400'))_0x1befea+=_0x1bd31d(0x1a2);else{if(_0x602227[_0x1bd31d(0x18a)]?.[_0x1bd31d(0x17e)]('HTTP\x20error!\x20status:\x20413'))_0x1befea+=_0x1bd31d(0x1be);else{if(_0x602227[_0x1bd31d(0x18a)]?.[_0x1bd31d(0x17e)]('HTTP\x20error'))_0x1befea+='API\x20service\x20unavailable.';else _0x602227[_0x1bd31d(0x18a)]?.[_0x1bd31d(0x17e)](_0x1bd31d(0x197))||_0x602227['message']?.[_0x1bd31d(0x17e)](_0x1bd31d(0x16f))?_0x1befea+=_0x1bd31d(0x17d):_0x1befea+=_0x1bd31d(0x19e);}}return await _0x2acf96[_0x1bd31d(0x1c8)]({'text':_0x1befea});}}