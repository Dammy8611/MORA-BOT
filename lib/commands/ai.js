const a0_0x1d6464=a0_0x3d73;(function(_0x1078f5,_0x2bb55a){const _0xe99bb=a0_0x3d73,_0x1d9faf=_0x1078f5();while(!![]){try{const _0x29db40=-parseInt(_0xe99bb(0x153))/0x1*(parseInt(_0xe99bb(0x131))/0x2)+-parseInt(_0xe99bb(0x10f))/0x3+-parseInt(_0xe99bb(0xf9))/0x4+-parseInt(_0xe99bb(0x112))/0x5*(parseInt(_0xe99bb(0x104))/0x6)+-parseInt(_0xe99bb(0x13f))/0x7*(parseInt(_0xe99bb(0x130))/0x8)+parseInt(_0xe99bb(0x122))/0x9*(-parseInt(_0xe99bb(0x12c))/0xa)+-parseInt(_0xe99bb(0x126))/0xb*(-parseInt(_0xe99bb(0xf2))/0xc);if(_0x29db40===_0x2bb55a)break;else _0x1d9faf['push'](_0x1d9faf['shift']());}catch(_0x15c521){_0x1d9faf['push'](_0x1d9faf['shift']());}}}(a0_0x9ced,0xf0f2e));const {GoogleGenerativeAI}=require(a0_0x1d6464(0x146)),{getCommandMap}=require(a0_0x1d6464(0x152)),{executeAiCommand}=require(a0_0x1d6464(0x135)),{StatusUpdater}=require(a0_0x1d6464(0xf4)),{loadMemory,saveMemory}=require('../memory.js'),lidToJid=require(a0_0x1d6464(0x12a)),normalizeMentions=require('../../utils/normalize.js'),logger={'info':(_0xd33a49,_0x1259b5)=>console[a0_0x1d6464(0x11c)](a0_0x1d6464(0x120)+_0x1259b5,_0xd33a49),'error':(_0x4bbd44,_0x38d243)=>console['error'](a0_0x1d6464(0x109)+_0x38d243,_0x4bbd44)},genAI=new GoogleGenerativeAI(a0_0x1d6464(0x154));function a0_0x9ced(){const _0x2f3229=['gemini-2.5-flash','join','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','getGenerativeModel','@google/generative-ai','The\x20prompt\x20for\x20the\x20AI.','Raw\x20lids:','commands','extendedTextMessage','AI\x20command\x20invoked','stringify','start','Command\x20returned\x20media.\x20Sending\x20directly.','name','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','Error\x20in\x20Remix\x20Layer','./index','163KCMDnt','AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo','AI\x20command\x20failed','mentionedJid','command','25839768bXHMuN','all','../../utils/statusUpdater.js','placeholder','Error\x20in\x20Gemini\x20Thinking\x20Layer','Running\x20command(s):\x20','length','4125476aPgrHM','Here\x20you\x20go\x20‚ú®','participant','message','type','Entering\x20Command\x20Execution\x20phase','I\x27m\x20a\x20bit\x20flustered\x20rn\x20üòµ‚Äçüí´','remoteJid','error','decision','Executing\x20command','1076898SmioiG','None','push','endsWith','filter','[ERROR]\x20','Remix\x20Layer\x20context','Thinking\x20Layer\x20finished','replace','key','direct','2526696ySORuO','info','values','25tmzKzF','match','generateContent','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','args','pushName','Thinking\x20Layer\x20received\x20prompt.','trim','Entering\x20Remix\x20Layer...','prompt','log','includes','done','meta','[INFO]\x20','sendMessage','3285mrXjBq','from','output','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do.','33GnGcVi','conversation','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x20Tell\x20this\x20to\x20your\x20next\x20layer\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x20because\x20you\x20are\x20the\x20brain\x20of\x20a\x20system\x20and\x20other\x20components\x20won\x27t\x20work\x20well\x20if\x20the\x20brain\x20provides\x20very\x20little\x20or\x20insufficient\x20information\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','../../utils/lidToJid.js','Entering\x20Thinking\x20Layer...','9630bGPPue','update','raw','usage','9458272DmrReC','14334IchJvl',',\x20JID/ID:\x20','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','text','../core/executeCommand','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','map','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20üòµ‚Äçüí´','Remix\x20Layer\x20finished','slice','Command\x20execution\x20finished','contextInfo','\x0a\x0aUser\x20Prompt:\x20\x22','7FMFBsh','response','description'];a0_0x9ced=function(){return _0x2f3229;};return a0_0x9ced();}module['exports']={'meta':{'name':'ai','description':a0_0x1d6464(0x144),'usage':'.ai\x20<prompt>','category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x1d6464(0x11b),'required':!![],'greedy':!![],'description':a0_0x1d6464(0x147)}]},'run':async({m:_0x11d962,sock:_0x1cfc26,args:_0x22b228,flags:_0x5aee0b,executeCommand:_0x3a90cc,metadata:_0xa41d61})=>{const _0x36e32c=a0_0x1d6464,_0x2c6087=_0x11d962[_0x36e32c(0x10d)][_0x36e32c(0x100)],_0x3cb82a=_0x11d962[_0x36e32c(0x10d)][_0x36e32c(0xfb)]||_0x2c6087,_0x110e36=_0x11d962[_0x36e32c(0x117)]||null;let _0xfefe56=[],_0x577acf=_0x22b228[_0x36e32c(0x11b)];if(_0x2c6087[_0x36e32c(0x107)]('@g.us')&&_0x11d962[_0x36e32c(0xfc)]?.[_0x36e32c(0x14a)]?.[_0x36e32c(0x13d)]?.[_0x36e32c(0x156)]){const _0x501d0c=_0x11d962[_0x36e32c(0xfc)][_0x36e32c(0x14a)][_0x36e32c(0x13d)][_0x36e32c(0x156)];console[_0x36e32c(0x11c)](_0x36e32c(0x148),_0x501d0c);const {normalizedText:_0x3aa21e,mentions:_0x421ab4}=await normalizeMentions(_0x577acf,_0x501d0c,_0xa41d61,lidToJid);_0x577acf=_0x3aa21e,_0xfefe56=_0x421ab4;}logger[_0x36e32c(0x110)]({'user':_0x11d962[_0x36e32c(0x117)],'prompt':_0x577acf},_0x36e32c(0x14b));const _0x466b8d=new StatusUpdater(_0x1cfc26,_0x2c6087);await _0x466b8d[_0x36e32c(0x14d)]();try{const _0x4eea47=await loadMemory(_0x2c6087,_0x3cb82a);logger[_0x36e32c(0x110)]({},_0x36e32c(0x12b)),await _0x466b8d[_0x36e32c(0x12d)]('ü§î\x20Thinking....');const _0x590644=await thinkingLayer(_0x577acf,_0x4eea47,_0x11d962,_0xa41d61);logger[_0x36e32c(0x110)](_0x590644,_0x36e32c(0x10b)),logger[_0x36e32c(0x110)]({'prompt':_0x577acf,'decision':_0x590644[_0x36e32c(0x102)],'commandsToRun':_0x590644['commands']},'AI\x20Thinking\x20Layer\x20Processed');let _0x59e72b=[];if(_0x590644[_0x36e32c(0x149)]&&_0x590644[_0x36e32c(0x149)][_0x36e32c(0xf8)]>0x0){logger[_0x36e32c(0x110)]({'commands':_0x590644['commands']},_0x36e32c(0xfe)),await _0x466b8d[_0x36e32c(0x12d)](_0x36e32c(0xf7)+_0x590644[_0x36e32c(0x149)][_0x36e32c(0x143)](',\x20')+'...');for(const _0x43dd57 of _0x590644[_0x36e32c(0x149)]){logger[_0x36e32c(0x110)]({'commandString':_0x43dd57},_0x36e32c(0x103));const _0x830dfa=_0x43dd57[_0x36e32c(0x119)]()['split'](/\s+/);_0x830dfa[0x0]=_0x830dfa[0x0]['slice'](0x1);const _0x1c438b=_0x830dfa[0x0],_0x4c592a=await executeAiCommand({'m':_0x11d962,'sock':_0x1cfc26,'tokens':['!'+_0x1c438b,..._0x830dfa[_0x36e32c(0x13b)](0x1)],'metadata':_0xa41d61});_0x4c592a&&_0x4c592a[_0x36e32c(0xfd)]!==_0x36e32c(0x134)&&(logger['info']({'command':_0x1c438b,'type':_0x4c592a[_0x36e32c(0xfd)]},_0x36e32c(0x14e)),await _0x1cfc26[_0x36e32c(0x121)](_0x11d962[_0x36e32c(0x10d)][_0x36e32c(0x100)],_0x4c592a[_0x36e32c(0x12e)])),_0x59e72b[_0x36e32c(0x106)]({'command':_0x1c438b,'type':_0x4c592a[_0x36e32c(0xfd)],'output':_0x4c592a[_0x36e32c(0xf5)]||_0x4c592a['text']}),logger[_0x36e32c(0x110)]({'command':_0x1c438b,'output':_0x4c592a},_0x36e32c(0x13c));}}else logger['info']({},'No\x20commands\x20to\x20execute.');logger['info']({},_0x36e32c(0x11a));const _0x2a0de0={'prompt':_0x577acf,'decision':_0x590644[_0x36e32c(0x102)],'commandOutputs':_0x59e72b};logger[_0x36e32c(0x110)]({'context':_0x2a0de0},_0x36e32c(0x10a));const _0x4a6a12=await remixLayer(_0x2a0de0,_0x11d962);logger[_0x36e32c(0x110)]({'finalResponse':_0x4a6a12},_0x36e32c(0x13a));const _0x452291=await extractJidsFromText(_0x4a6a12,_0xa41d61),_0x526405=Array[_0x36e32c(0x123)](new Set([..._0xfefe56,..._0x452291]));await saveMemory(_0x2c6087,_0x3cb82a,_0x577acf,_0x4a6a12,_0x110e36,_0x59e72b,_0x526405),await _0x466b8d[_0x36e32c(0x11e)]({'text':_0x4a6a12,'mentions':_0x526405});}catch(_0x50fb00){logger[_0x36e32c(0x101)](_0x50fb00,_0x36e32c(0x155)),await _0x466b8d[_0x36e32c(0x11e)](_0x36e32c(0x139));}}};function extractJidsFromText(_0xad040,_0x361074){const _0x4f30e6=a0_0x1d6464,_0x36fe8a=/@[0-9]+/g,_0x318016=/[0-9]+@s\.whatsapp\.net/g,_0x50c9a4=[..._0xad040[_0x4f30e6(0x113)](_0x36fe8a)||[],..._0xad040[_0x4f30e6(0x113)](_0x318016)||[]];return Promise[_0x4f30e6(0xf3)](_0x50c9a4[_0x4f30e6(0x137)](_0x29ef43=>lidToJid(_0x29ef43,_0x361074)));}function a0_0x3d73(_0x4a2c04,_0x17380f){const _0x9ced1b=a0_0x9ced();return a0_0x3d73=function(_0x3d7322,_0xe00cde){_0x3d7322=_0x3d7322-0xf2;let _0x58124a=_0x9ced1b[_0x3d7322];return _0x58124a;},a0_0x3d73(_0x4a2c04,_0x17380f);}async function thinkingLayer(_0x2c47f1,_0x19af13,_0x2ade04,_0x1e0f8f){const _0x4298bb=a0_0x1d6464;logger['info']({'prompt':_0x2c47f1},_0x4298bb(0x118));const _0x8605f0=genAI['getGenerativeModel']({'model':_0x4298bb(0x142)}),_0x4f10cc=getCommandMap(),_0x40558f=Array['from'](_0x4f10cc[_0x4298bb(0x111)]())[_0x4298bb(0x108)](_0x574e7d=>_0x574e7d['meta']['ai']!==![])['map'](_0x6fbff=>({'name':_0x6fbff['meta'][_0x4298bb(0x14f)],'description':_0x6fbff[_0x4298bb(0x11f)][_0x4298bb(0x141)],'usage':_0x6fbff[_0x4298bb(0x11f)][_0x4298bb(0x12f)],'direct':_0x6fbff[_0x4298bb(0x11f)][_0x4298bb(0x10e)]||![],'args':(_0x6fbff[_0x4298bb(0x11f)][_0x4298bb(0x116)]||[])[_0x4298bb(0x137)](_0x260c89=>_0x260c89[_0x4298bb(0x14f)]+'\x20('+_0x260c89[_0x4298bb(0x141)]+')')[_0x4298bb(0x143)](',\x20')})),_0x2b0577=_0x4298bb(0x129)+JSON[_0x4298bb(0x14c)](_0x19af13,null,0x2)+_0x4298bb(0x133)+JSON[_0x4298bb(0x14c)](_0x40558f,null,0x2)+_0x4298bb(0x136)+(_0x2ade04[_0x4298bb(0xfc)][_0x4298bb(0x14a)]?.[_0x4298bb(0x13d)]?.['quotedMessage']?.[_0x4298bb(0x127)]||_0x4298bb(0x105))+_0x4298bb(0x128)+_0x2ade04[_0x4298bb(0x117)]+_0x4298bb(0x132)+(_0x2ade04[_0x4298bb(0x10d)]['participant']||_0x2ade04[_0x4298bb(0x10d)][_0x4298bb(0x100)])+_0x4298bb(0x13e)+_0x2c47f1+'\x22\x0a';try{const _0x32f42a=await _0x8605f0[_0x4298bb(0x114)](_0x2b0577),_0x7614f7=await _0x32f42a[_0x4298bb(0x140)][_0x4298bb(0x134)](),_0xaaaf89=_0x7614f7[_0x4298bb(0x10c)](/```json/g,'')['replace'](/```/g,'')[_0x4298bb(0x119)]();if(!_0xaaaf89[_0x4298bb(0x11d)]('{'))return{'decision':_0x4298bb(0x125),'commands':[]};const _0x1a175a=JSON['parse'](_0xaaaf89);return{'decision':_0x1a175a[_0x4298bb(0x102)],'commands':_0x1a175a['commands']||[]};}catch(_0x2171d7){return logger[_0x4298bb(0x101)](_0x2171d7,_0x4298bb(0xf6)),{'decision':_0x4298bb(0x150),'commands':[]};}}async function remixLayer(_0x2af624,_0x23f213){const _0x198ae1=a0_0x1d6464;logger[_0x198ae1(0x110)]({'context':_0x2af624},'Remix\x20Layer\x20received\x20context.');const _0x4e096f=genAI[_0x198ae1(0x145)]({'model':_0x198ae1(0x142)}),_0x1ba7be=_0x2af624['commandOutputs'][_0x198ae1(0x137)](_0x3dad90=>'-\x20'+_0x3dad90[_0x198ae1(0x157)]+':\x20'+_0x3dad90[_0x198ae1(0x124)])[_0x198ae1(0x143)]('\x0a'),_0x346cf6='\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22'+_0x2af624[_0x198ae1(0x11b)]+_0x198ae1(0x115)+_0x2af624['decision']+_0x198ae1(0x138)+(_0x1ba7be||_0x198ae1(0x105))+'\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20'+_0x23f213['pushName']+_0x198ae1(0x132)+(_0x23f213['key'][_0x198ae1(0xfb)]||_0x23f213[_0x198ae1(0x10d)][_0x198ae1(0x100)])+'\x0a';try{const _0x27ecf7=await _0x4e096f[_0x198ae1(0x114)](_0x346cf6),_0x51cad7=_0x27ecf7[_0x198ae1(0x140)][_0x198ae1(0x134)]()?.[_0x198ae1(0x119)]();return _0x51cad7||_0x198ae1(0xfa);}catch(_0x600e8c){return logger[_0x198ae1(0x101)](_0x600e8c,_0x198ae1(0x151)),_0x198ae1(0xff);}}