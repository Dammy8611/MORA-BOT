const a0_0x5ef7d1=a0_0x1a41;(function(_0x54b42d,_0xb62a2e){const _0x55cf97=a0_0x1a41,_0x3b4aac=_0x54b42d();while(!![]){try{const _0x3b41c1=parseInt(_0x55cf97(0xf6))/0x1*(parseInt(_0x55cf97(0xed))/0x2)+-parseInt(_0x55cf97(0xc8))/0x3*(parseInt(_0x55cf97(0xe0))/0x4)+parseInt(_0x55cf97(0x113))/0x5*(-parseInt(_0x55cf97(0x11c))/0x6)+-parseInt(_0x55cf97(0xf4))/0x7*(-parseInt(_0x55cf97(0xf5))/0x8)+parseInt(_0x55cf97(0x125))/0x9*(-parseInt(_0x55cf97(0x101))/0xa)+parseInt(_0x55cf97(0x11b))/0xb+parseInt(_0x55cf97(0x122))/0xc;if(_0x3b41c1===_0xb62a2e)break;else _0x3b4aac['push'](_0x3b4aac['shift']());}catch(_0x53a1cd){_0x3b4aac['push'](_0x3b4aac['shift']());}}}(a0_0x293a,0x76bfb));function a0_0x1a41(_0x389a1b,_0x2f176c){const _0x293a20=a0_0x293a();return a0_0x1a41=function(_0x1a4184,_0x175b20){_0x1a4184=_0x1a4184-0xc7;let _0x10b4b5=_0x293a20[_0x1a4184];return _0x10b4b5;},a0_0x1a41(_0x389a1b,_0x2f176c);}const {GoogleGenerativeAI}=require(a0_0x5ef7d1(0xce)),{getCommandMap}=require(a0_0x5ef7d1(0x10e)),{executeAiCommand}=require('../core/executeCommand'),{StatusUpdater}=require('../../utils/statusUpdater.js'),{loadMemory,saveMemory}=require(a0_0x5ef7d1(0x108)),lidToJid=require(a0_0x5ef7d1(0xcf)),normalizeMentions=require(a0_0x5ef7d1(0x114)),logger={'info':(_0x460d14,_0x233929)=>console['log'](a0_0x5ef7d1(0x120)+_0x233929,_0x460d14),'error':(_0x3ff6b5,_0x5f26cd)=>console['error'](a0_0x5ef7d1(0x107)+_0x5f26cd,_0x3ff6b5)},genAI=new GoogleGenerativeAI('AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo');module[a0_0x5ef7d1(0xf8)]={'meta':{'name':'ai','description':a0_0x5ef7d1(0x117),'usage':'.ai\x20<prompt>','category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x5ef7d1(0xff),'required':!![],'greedy':!![],'description':a0_0x5ef7d1(0xcc)}]},'run':async({m:_0x32a188,sock:_0xba6b96,args:_0x1adcf6,flags:_0x275233,executeCommand:_0x41ba12,metadata:_0x79336f})=>{const _0x3c144c=a0_0x5ef7d1,_0x279452=_0x32a188['key'][_0x3c144c(0xd3)],_0x4391e8=_0x32a188['key'][_0x3c144c(0xd1)]||_0x279452,_0x6edeb3=_0x32a188[_0x3c144c(0x110)]||null;let _0x4992ef=[],_0x1666ea=_0x1adcf6['prompt'];if(_0x279452[_0x3c144c(0x100)]('@g.us')&&_0x32a188[_0x3c144c(0xf9)]?.[_0x3c144c(0xde)]?.[_0x3c144c(0xfb)]?.[_0x3c144c(0x11d)]){const _0x5c6109=_0x32a188[_0x3c144c(0xf9)][_0x3c144c(0xde)]['contextInfo'][_0x3c144c(0x11d)];console['log'](_0x3c144c(0x115),_0x5c6109);const {normalizedText:_0x244e29,mentions:_0x369831}=await normalizeMentions(_0x1666ea,_0x5c6109,_0x79336f,lidToJid);_0x1666ea=_0x244e29,_0x4992ef=_0x369831;}logger[_0x3c144c(0xe3)]({'user':_0x32a188['pushName'],'prompt':_0x1666ea},_0x3c144c(0xee));const _0xbf9222=new StatusUpdater(_0xba6b96,_0x279452);await _0xbf9222['start']();try{const _0x11eb44=await loadMemory(_0x279452,_0x4391e8);logger[_0x3c144c(0xe3)]({},_0x3c144c(0xd0)),await _0xbf9222[_0x3c144c(0x119)](_0x3c144c(0x106));const _0x427e1c=await thinkingLayer(_0x1666ea,_0x11eb44,_0x32a188,_0x79336f);logger[_0x3c144c(0xe3)](_0x427e1c,'Thinking\x20Layer\x20finished'),logger[_0x3c144c(0xe3)]({'prompt':_0x1666ea,'decision':_0x427e1c['decision'],'commandsToRun':_0x427e1c['commands']},'AI\x20Thinking\x20Layer\x20Processed');let _0x4276c4=[];if(_0x427e1c[_0x3c144c(0xd2)]&&_0x427e1c[_0x3c144c(0xd2)][_0x3c144c(0x10c)]>0x0){logger['info']({'commands':_0x427e1c['commands']},_0x3c144c(0xe8)),await _0xbf9222[_0x3c144c(0x119)](_0x3c144c(0x112)+_0x427e1c[_0x3c144c(0xd2)]['join'](',\x20')+'...');for(const _0x1b98a2 of _0x427e1c[_0x3c144c(0xd2)]){logger[_0x3c144c(0xe3)]({'commandString':_0x1b98a2},_0x3c144c(0xdc));const _0x5710b0=_0x1b98a2[_0x3c144c(0x121)]()['split'](/\s+/);_0x5710b0[0x0]=_0x5710b0[0x0][_0x3c144c(0xd9)](0x1);const _0x7d6e52=_0x5710b0[0x0],_0x505eac=await executeAiCommand({'m':_0x32a188,'sock':_0xba6b96,'tokens':['!'+_0x7d6e52,..._0x5710b0[_0x3c144c(0xd9)](0x1)],'metadata':_0x79336f});_0x505eac&&_0x505eac[_0x3c144c(0xec)]!==_0x3c144c(0xf3)&&(logger[_0x3c144c(0xe3)]({'command':_0x7d6e52,'type':_0x505eac[_0x3c144c(0xec)]},_0x3c144c(0xfd)),await _0xba6b96[_0x3c144c(0xfc)](_0x32a188['key'][_0x3c144c(0xd3)],_0x505eac['raw'])),_0x4276c4[_0x3c144c(0x10f)]({'command':_0x7d6e52,'type':_0x505eac[_0x3c144c(0xec)],'output':_0x505eac[_0x3c144c(0xfe)]||_0x505eac[_0x3c144c(0xf3)]}),logger[_0x3c144c(0xe3)]({'command':_0x7d6e52,'output':_0x505eac},_0x3c144c(0xea));}}else logger[_0x3c144c(0xe3)]({},'No\x20commands\x20to\x20execute.');logger['info']({},_0x3c144c(0xd7));const _0x2eec21={'prompt':_0x1666ea,'decision':_0x427e1c['decision'],'commandOutputs':_0x4276c4};logger[_0x3c144c(0xe3)]({'context':_0x2eec21},'Remix\x20Layer\x20context');const _0x39e518=await remixLayer(_0x2eec21,_0x32a188);logger['info']({'finalResponse':_0x39e518},'Remix\x20Layer\x20finished');const _0x17abd0=await extractJidsFromText(_0x39e518,_0x79336f),_0x4c144d=Array[_0x3c144c(0xe7)](new Set([..._0x4992ef,..._0x17abd0]));await saveMemory(_0x279452,_0x4391e8,_0x1666ea,_0x39e518,_0x6edeb3,_0x4276c4,_0x4c144d),await _0xbf9222['done']({'text':_0x39e518,'mentions':_0x4c144d});}catch(_0x3404ae){logger[_0x3c144c(0xf7)](_0x3404ae,_0x3c144c(0xe9)),await _0xbf9222[_0x3c144c(0xc9)]('Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20ðŸ˜µâ€ðŸ’«');}}};function extractJidsFromText(_0x565b66,_0x46500b){const _0x5a4e94=a0_0x5ef7d1,_0xdb7d01=/@[0-9]+/g,_0x51274a=/[0-9]+@s\.whatsapp\.net/g,_0x53dfcc=[..._0x565b66[_0x5a4e94(0xc7)](_0xdb7d01)||[],..._0x565b66[_0x5a4e94(0xc7)](_0x51274a)||[]];return Promise[_0x5a4e94(0xca)](_0x53dfcc[_0x5a4e94(0xe2)](_0x3ac5e1=>lidToJid(_0x3ac5e1,_0x46500b)));}function a0_0x293a(){const _0x52d06d=['2TKczuO','error','exports','message','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x20Tell\x20this\x20to\x20your\x20next\x20layer\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x20because\x20you\x20are\x20the\x20brain\x20of\x20a\x20system\x20and\x20other\x20components\x20won\x27t\x20work\x20well\x20if\x20the\x20brain\x20provides\x20very\x20little\x20or\x20insufficient\x20information\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','contextInfo','sendMessage','Command\x20returned\x20media.\x20Sending\x20directly.','placeholder','prompt','endsWith','730OqFrvy','I\x27m\x20a\x20bit\x20flustered\x20rn\x20ðŸ˜µâ€ðŸ’«','Thinking\x20Layer\x20received\x20prompt.','Remix\x20Layer\x20received\x20context.','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','ðŸ¤”\x20Thinking....','[ERROR]\x20','../memory.js','None','usage','gemini-2.5-flash','length','name','./index','push','pushName','join','Running\x20command(s):\x20','25TBrjaY','../../utils/normalize.js','Raw\x20lids:','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','update','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','4898751mBtVsc','1134714MaEeHN','mentionedJid','replace','Here\x20you\x20go\x20âœ¨','[INFO]\x20','trim','7716264qjmteS','Error\x20in\x20Gemini\x20Thinking\x20Layer','includes','113076pJnbAv','meta','match','738084ZjFQty','done','all','command','The\x20prompt\x20for\x20the\x20AI.','Error\x20in\x20Remix\x20Layer','@google/generative-ai','../../utils/lidToJid.js','Entering\x20Thinking\x20Layer...','participant','commands','remoteJid','conversation','generateContent','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do.','Entering\x20Remix\x20Layer...','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','slice','decision','filter','Executing\x20command','commandOutputs','extendedTextMessage',',\x20JID/ID:\x20','4clcUKD','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','map','info','stringify','\x0a\x0aUser\x20Prompt:\x20\x22','description','from','Entering\x20Command\x20Execution\x20phase','AI\x20command\x20failed','Command\x20execution\x20finished','getGenerativeModel','type','551158qCoUUj','AI\x20command\x20invoked','parse','direct','key','values','text','1001jBcwUA','53464mHJzzq'];a0_0x293a=function(){return _0x52d06d;};return a0_0x293a();}async function thinkingLayer(_0xf8e7e9,_0x5a2cd,_0x2db278,_0x558c43){const _0x3c5aa9=a0_0x5ef7d1;logger[_0x3c5aa9(0xe3)]({'prompt':_0xf8e7e9},_0x3c5aa9(0x103));const _0x3036d9=genAI[_0x3c5aa9(0xeb)]({'model':_0x3c5aa9(0x10b)}),_0x14954b=getCommandMap(),_0x5bd33d=Array[_0x3c5aa9(0xe7)](_0x14954b[_0x3c5aa9(0xf2)]())[_0x3c5aa9(0xdb)](_0x1958f9=>_0x1958f9[_0x3c5aa9(0x126)]['ai']!==![])['map'](_0x11942d=>({'name':_0x11942d['meta'][_0x3c5aa9(0x10d)],'description':_0x11942d['meta'][_0x3c5aa9(0xe6)],'usage':_0x11942d[_0x3c5aa9(0x126)][_0x3c5aa9(0x10a)],'direct':_0x11942d[_0x3c5aa9(0x126)][_0x3c5aa9(0xf0)]||![],'args':(_0x11942d[_0x3c5aa9(0x126)]['args']||[])[_0x3c5aa9(0xe2)](_0x7b162e=>_0x7b162e[_0x3c5aa9(0x10d)]+'\x20('+_0x7b162e[_0x3c5aa9(0xe6)]+')')[_0x3c5aa9(0x111)](',\x20')})),_0x16c171=_0x3c5aa9(0x118)+JSON['stringify'](_0x5a2cd,null,0x2)+_0x3c5aa9(0x105)+JSON[_0x3c5aa9(0xe4)](_0x5bd33d,null,0x2)+_0x3c5aa9(0xd8)+(_0x2db278[_0x3c5aa9(0xf9)][_0x3c5aa9(0xde)]?.[_0x3c5aa9(0xfb)]?.['quotedMessage']?.[_0x3c5aa9(0xd4)]||_0x3c5aa9(0x109))+_0x3c5aa9(0xfa)+_0x2db278[_0x3c5aa9(0x110)]+_0x3c5aa9(0xdf)+(_0x2db278[_0x3c5aa9(0xf1)]['participant']||_0x2db278[_0x3c5aa9(0xf1)][_0x3c5aa9(0xd3)])+_0x3c5aa9(0xe5)+_0xf8e7e9+'\x22\x0a';try{const _0x97dc8b=await _0x3036d9[_0x3c5aa9(0xd5)](_0x16c171),_0x3e04e0=await _0x97dc8b['response'][_0x3c5aa9(0xf3)](),_0x8ac30d=_0x3e04e0[_0x3c5aa9(0x11e)](/```json/g,'')[_0x3c5aa9(0x11e)](/```/g,'')[_0x3c5aa9(0x121)]();if(!_0x8ac30d[_0x3c5aa9(0x124)]('{'))return{'decision':_0x3c5aa9(0xd6),'commands':[]};const _0xca311d=JSON[_0x3c5aa9(0xef)](_0x8ac30d);return{'decision':_0xca311d[_0x3c5aa9(0xda)],'commands':_0xca311d['commands']||[]};}catch(_0x571de8){return logger[_0x3c5aa9(0xf7)](_0x571de8,_0x3c5aa9(0x123)),{'decision':_0x3c5aa9(0x11a),'commands':[]};}}async function remixLayer(_0x3b3ca0,_0x245cc6){const _0x35e66d=a0_0x5ef7d1;logger[_0x35e66d(0xe3)]({'context':_0x3b3ca0},_0x35e66d(0x104));const _0x4686e1=genAI[_0x35e66d(0xeb)]({'model':_0x35e66d(0x10b)}),_0x2e6e9b=_0x3b3ca0[_0x35e66d(0xdd)][_0x35e66d(0xe2)](_0x51adae=>'-\x20'+_0x51adae[_0x35e66d(0xcb)]+':\x20'+_0x51adae['output'])['join']('\x0a'),_0x5c6846=_0x35e66d(0x116)+_0x3b3ca0[_0x35e66d(0xff)]+_0x35e66d(0xe1)+_0x3b3ca0['decision']+'\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a'+(_0x2e6e9b||_0x35e66d(0x109))+'\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20'+_0x245cc6['pushName']+_0x35e66d(0xdf)+(_0x245cc6[_0x35e66d(0xf1)][_0x35e66d(0xd1)]||_0x245cc6[_0x35e66d(0xf1)][_0x35e66d(0xd3)])+'\x0a';try{const _0x200110=await _0x4686e1[_0x35e66d(0xd5)](_0x5c6846),_0x139f03=_0x200110['response'][_0x35e66d(0xf3)]()?.['trim']();return _0x139f03||_0x35e66d(0x11f);}catch(_0x731c43){return logger[_0x35e66d(0xf7)](_0x731c43,_0x35e66d(0xcd)),_0x35e66d(0x102);}}