const a0_0x936b6f=a0_0x47bf;function a0_0x47bf(_0x559ecf,_0xe9659b){const _0x3ef8ba=a0_0x3ef8();return a0_0x47bf=function(_0x47bfce,_0x30cc52){_0x47bfce=_0x47bfce-0x18a;let _0x416929=_0x3ef8ba[_0x47bfce];return _0x416929;},a0_0x47bf(_0x559ecf,_0xe9659b);}(function(_0x180f1e,_0x49c30e){const _0x5bf30a=a0_0x47bf,_0xe7cebc=_0x180f1e();while(!![]){try{const _0x2f0de8=-parseInt(_0x5bf30a(0x18a))/0x1+-parseInt(_0x5bf30a(0x1c7))/0x2*(-parseInt(_0x5bf30a(0x1af))/0x3)+parseInt(_0x5bf30a(0x1e1))/0x4*(-parseInt(_0x5bf30a(0x1da))/0x5)+parseInt(_0x5bf30a(0x1b6))/0x6*(parseInt(_0x5bf30a(0x1cc))/0x7)+parseInt(_0x5bf30a(0x1cb))/0x8+parseInt(_0x5bf30a(0x1b5))/0x9*(parseInt(_0x5bf30a(0x19c))/0xa)+-parseInt(_0x5bf30a(0x197))/0xb;if(_0x2f0de8===_0x49c30e)break;else _0xe7cebc['push'](_0xe7cebc['shift']());}catch(_0x3b61d8){_0xe7cebc['push'](_0xe7cebc['shift']());}}}(a0_0x3ef8,0x389e1));const {GoogleGenerativeAI}=require('@google/generative-ai'),{getCommandMap}=require('./index'),{executeAiCommand}=require(a0_0x936b6f(0x1ad)),{StatusUpdater}=require(a0_0x936b6f(0x1d9)),logger={'info':(_0x480f52,_0x2235a0)=>console[a0_0x936b6f(0x1c3)](a0_0x936b6f(0x1ab)+_0x2235a0,_0x480f52),'error':(_0x5dd14b,_0x5668db)=>console[a0_0x936b6f(0x1cd)](a0_0x936b6f(0x18e)+_0x5668db,_0x5dd14b)},genAI=new GoogleGenerativeAI(a0_0x936b6f(0x1a5));module['exports']={'meta':{'name':'ai','description':a0_0x936b6f(0x1a7),'usage':a0_0x936b6f(0x1e4),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x936b6f(0x1d6),'required':!![],'greedy':!![],'description':a0_0x936b6f(0x1e0)}]},'run':async({m:_0x57c7c9,sock:_0x511841,args:_0x34df03,flags:_0x1ff176,executeCommand:_0xfba9b})=>{const _0x28497b=a0_0x936b6f,_0x35e26f=_0x57c7c9[_0x28497b(0x19a)][_0x28497b(0x1e2)],_0x513351=_0x57c7c9['key']['participant']||_0x35e26f,_0x1ec788=_0x34df03['prompt'];logger[_0x28497b(0x1d7)]({'user':_0x57c7c9['pushName'],'prompt':_0x1ec788},_0x28497b(0x1ce));const _0x46106c=new StatusUpdater(_0x511841,_0x35e26f);await _0x46106c[_0x28497b(0x1de)]();try{logger[_0x28497b(0x1d7)]({},_0x28497b(0x190)),await _0x46106c[_0x28497b(0x196)](_0x28497b(0x1df));const _0x44b3a0=await thinkingLayer(_0x1ec788);logger[_0x28497b(0x1d7)](_0x44b3a0,_0x28497b(0x1a1)),logger['info']({'prompt':_0x1ec788,'decision':_0x44b3a0['decision'],'commandsToRun':_0x44b3a0[_0x28497b(0x194)]},_0x28497b(0x1cf));let _0x25d0c1=[];if(_0x44b3a0[_0x28497b(0x194)]&&_0x44b3a0[_0x28497b(0x194)][_0x28497b(0x1bf)]>0x0){logger[_0x28497b(0x1d7)]({'commands':_0x44b3a0['commands']},_0x28497b(0x191)),await _0x46106c['update'](_0x28497b(0x1c1)+_0x44b3a0[_0x28497b(0x194)][_0x28497b(0x1b9)](',\x20')+_0x28497b(0x19e));for(const _0x21dbcb of _0x44b3a0[_0x28497b(0x194)]){logger['info']({'commandString':_0x21dbcb},_0x28497b(0x18d));const _0xa6fa39=_0x21dbcb[_0x28497b(0x18f)]()['split'](/\s+/);_0xa6fa39[0x0]=_0xa6fa39[0x0][_0x28497b(0x18b)](0x1);const _0x9342ca=_0xa6fa39[0x0],_0xaf9748=await executeAiCommand({'m':_0x57c7c9,'sock':_0x511841,'tokens':['!'+_0x9342ca,..._0xa6fa39[_0x28497b(0x18b)](0x1)]});if(_0xaf9748&&!_0xaf9748[_0x28497b(0x1ae)]){logger[_0x28497b(0x1d7)]({'command':_0x9342ca,'content':_0xaf9748},_0x28497b(0x1d1)),await _0x46106c[_0x28497b(0x1db)]('done'),await _0x511841[_0x28497b(0x1c9)](_0x57c7c9[_0x28497b(0x19a)][_0x28497b(0x1e2)],_0xaf9748),_0x25d0c1[_0x28497b(0x1d4)]({'command':_0x9342ca,'output':_0x28497b(0x1dc)+(_0xaf9748[_0x28497b(0x1d3)]?'audio':_0x28497b(0x1a3))+']','isDirect':!![]});continue;}const _0x2f6303=_0xaf9748?_0xaf9748[_0x28497b(0x1ae)]:_0x28497b(0x1b7);_0x25d0c1[_0x28497b(0x1d4)]({'command':_0x9342ca,'output':_0x2f6303}),logger['info']({'command':_0x9342ca,'output':_0x2f6303},_0x28497b(0x19f));}}else logger[_0x28497b(0x1d7)]({},'No\x20commands\x20to\x20execute.');if(_0x25d0c1[_0x28497b(0x1bf)]>0x0&&_0x25d0c1[_0x28497b(0x193)](_0x40e8cb=>_0x40e8cb[_0x28497b(0x1c8)])){logger[_0x28497b(0x1d7)]({},_0x28497b(0x198));return;}logger[_0x28497b(0x1d7)]({},'Entering\x20Remix\x20Layer...');const _0x5f05af={'prompt':_0x1ec788,'decision':_0x44b3a0[_0x28497b(0x19d)],'commandOutputs':_0x25d0c1};logger['info']({'context':_0x5f05af},'Remix\x20Layer\x20context');const _0x81af01=await remixLayer(_0x5f05af);logger[_0x28497b(0x1d7)]({'finalResponse':_0x81af01},_0x28497b(0x1ac)),await _0x46106c[_0x28497b(0x1db)](_0x81af01);}catch(_0xd7175c){logger[_0x28497b(0x1cd)](_0xd7175c,'AI\x20command\x20failed'),await _0x46106c['done'](_0x28497b(0x1b0));}}};function a0_0x3ef8(){const _0x33c5b9=['Received\x20final\x20response\x20from\x20Gemini.','2680968zwZGZx','1605275aeDotU','error','AI\x20command\x20invoked','AI\x20Thinking\x20Layer\x20Processed','Returning\x20from\x20Thinking\x20Layer','Command\x20returned\x20a\x20file.\x20Sending\x20directly.','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','audio','push','Error\x20in\x20Gemini\x20Remix\x20Layer','prompt','info','values','../../utils/statusUpdater.js','10qAtTWg','done','[Sent\x20a\x20file:\x20','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','start','🤔\x20Thinking....','The\x20prompt\x20for\x20the\x20AI.','556572YwUeDI','remoteJid','usage','.ai\x20<prompt>','409403GeABKi','slice','Received\x20response\x20from\x20Gemini','Executing\x20command','[ERROR]\x20','trim','Entering\x20Thinking\x20Layer...','Entering\x20Command\x20Execution\x20phase','Generated\x20callable\x20command\x20list\x20for\x20AI','every','commands','filter','update','1017049WJSyEe','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','Parsed\x20JSON\x20response','key','commandOutputs','110RiDhCA','decision','...','Command\x20execution\x20finished','command','Thinking\x20Layer\x20finished','generateContent','unknown','getGenerativeModel','AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','map','None','[INFO]\x20','Remix\x20Layer\x20finished','../core/executeCommand','text','27RoPWBv','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20😵‍💫','Sending\x20system\x20prompt\x20to\x20Gemini','replace','All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','135819XZsrzT','12JEGNYI','No\x20textual\x20output.','Error\x20in\x20Gemini\x20Thinking\x20Layer','join','response','name','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Don\x27t\x20add\x20prefix\x20with\x20command\x20e.g\x20\x27.weather\x27\x20you\x20shuld\x20just\x20run\x20\x27weather\x27\x0a\x0aUser\x20Prompt:\x20\x22','from','direct','length','I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.','Running\x20command(s):\x20','gemini-2.5-pro','log','description','meta','args','11618IduOEZ','isDirect','sendMessage'];a0_0x3ef8=function(){return _0x33c5b9;};return a0_0x3ef8();}async function thinkingLayer(_0x4f477a){const _0x3298bd=a0_0x936b6f;logger[_0x3298bd(0x1d7)]({'prompt':_0x4f477a},'Thinking\x20Layer\x20received\x20prompt.');const _0x306d06=genAI[_0x3298bd(0x1a4)]({'model':_0x3298bd(0x1c2)}),_0x327676=getCommandMap(),_0x46371f=Array[_0x3298bd(0x1bd)](_0x327676[_0x3298bd(0x1d8)]())['filter'](_0x49a6e2=>_0x49a6e2[_0x3298bd(0x1c5)]['ai']!==![])[_0x3298bd(0x1a9)](_0x191b9a=>({'name':_0x191b9a['meta']['name'],'description':_0x191b9a['meta'][_0x3298bd(0x1c4)],'usage':_0x191b9a[_0x3298bd(0x1c5)][_0x3298bd(0x1e3)],'direct':_0x191b9a[_0x3298bd(0x1c5)][_0x3298bd(0x1be)]||![],'args':(_0x191b9a[_0x3298bd(0x1c5)][_0x3298bd(0x1c6)]||[])['map'](_0x18f6f1=>_0x18f6f1[_0x3298bd(0x1bb)]+'\x20('+_0x18f6f1['description']+')')['join'](',\x20')}));logger[_0x3298bd(0x1d7)]({'count':_0x46371f['length']},_0x3298bd(0x192));const _0x990a82=_0x3298bd(0x1a6)+JSON['stringify'](_0x46371f,null,0x2)+_0x3298bd(0x1bc)+_0x4f477a+'\x22\x0a';logger[_0x3298bd(0x1d7)](_0x3298bd(0x1b1));try{const _0x214b62=await _0x306d06[_0x3298bd(0x1a2)](_0x990a82),_0x4ab3dd=await _0x214b62[_0x3298bd(0x1ba)][_0x3298bd(0x1ae)]();logger['info']({'responseText':_0x4ab3dd},_0x3298bd(0x18c));const _0x122f82=_0x4ab3dd[_0x3298bd(0x1b2)](/```json/g,'')[_0x3298bd(0x1b2)](/```/g,'')[_0x3298bd(0x18f)]();logger[_0x3298bd(0x1d7)]({'cleanedText':_0x122f82},'Cleaned\x20Gemini\x20response');const _0xf4811e=JSON['parse'](_0x122f82);logger['info']({'jsonResponse':_0xf4811e},_0x3298bd(0x199));const _0x365fb2={'decision':_0xf4811e['decision'],'commands':_0xf4811e[_0x3298bd(0x194)]||[]};return logger[_0x3298bd(0x1d7)]({'thinkingResult':_0x365fb2},_0x3298bd(0x1d0)),_0x365fb2;}catch(_0x2d0eda){return logger[_0x3298bd(0x1cd)](_0x2d0eda,_0x3298bd(0x1b8)),{'decision':'There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','commands':[]};}}async function remixLayer(_0x5d074f){const _0x41956f=a0_0x936b6f;logger[_0x41956f(0x1d7)]({'context':_0x5d074f},'Remix\x20Layer\x20received\x20context.');const _0x3a8e70=genAI[_0x41956f(0x1a4)]({'model':_0x41956f(0x1c2)}),_0x5a4f30=_0x5d074f[_0x41956f(0x19b)][_0x41956f(0x195)](_0x1f71b5=>!_0x1f71b5[_0x41956f(0x1c8)]);if(_0x5a4f30[_0x41956f(0x1bf)]===0x0&&_0x5d074f[_0x41956f(0x19b)]['length']>0x0)return logger[_0x41956f(0x1d7)]({},_0x41956f(0x1b3)),'Gotcha,\x20all\x20commands\x20handled.\x20✨';const _0x4fd873=_0x41956f(0x1a8)+_0x5d074f[_0x41956f(0x1d6)]+_0x41956f(0x1d2)+_0x5d074f[_0x41956f(0x19d)]+_0x41956f(0x1b4)+(_0x5a4f30[_0x41956f(0x1a9)](_0x4d91a7=>'-\x20'+_0x4d91a7[_0x41956f(0x1a0)]+':\x20'+_0x4d91a7['output'])[_0x41956f(0x1b9)]('\x0a')||_0x41956f(0x1aa))+'\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a';logger['info'](_0x41956f(0x1dd));try{const _0x45d8ea=await _0x3a8e70['generateContent'](_0x4fd873),_0x6fa9a5=await _0x45d8ea['response'],_0x3f6b03=_0x6fa9a5['text']();return logger['info']({'response':_0x3f6b03},_0x41956f(0x1ca)),_0x3f6b03;}catch(_0x2079ae){return logger['error'](_0x2079ae,_0x41956f(0x1d5)),_0x41956f(0x1c0);}}