const a0_0x47c282=a0_0x3fbf;(function(_0xc4ef7c,_0x2426ad){const _0x548db6=a0_0x3fbf,_0x4cb808=_0xc4ef7c();while(!![]){try{const _0x50da6e=-parseInt(_0x548db6(0x1b6))/0x1*(parseInt(_0x548db6(0x1db))/0x2)+-parseInt(_0x548db6(0x1c1))/0x3+parseInt(_0x548db6(0x1ed))/0x4+parseInt(_0x548db6(0x1ba))/0x5*(parseInt(_0x548db6(0x1c3))/0x6)+parseInt(_0x548db6(0x1da))/0x7+parseInt(_0x548db6(0x1fc))/0x8+-parseInt(_0x548db6(0x1eb))/0x9;if(_0x50da6e===_0x2426ad)break;else _0x4cb808['push'](_0x4cb808['shift']());}catch(_0x3a7bf3){_0x4cb808['push'](_0x4cb808['shift']());}}}(a0_0x10ed,0x9c8e0));const {GoogleGenerativeAI}=require(a0_0x47c282(0x1aa)),{getCommandMap}=require(a0_0x47c282(0x1b9)),{executeAiCommand}=require(a0_0x47c282(0x1d8)),{StatusUpdater}=require(a0_0x47c282(0x1cb)),{loadMemory,saveMemory}=require(a0_0x47c282(0x1b4)),lidToJid=require(a0_0x47c282(0x1f2)),normalizeMentions=require(a0_0x47c282(0x1b7)),logger={'info':(_0x4f979c,_0x3186f7)=>console['log']('[INFO]\x20'+_0x3186f7,_0x4f979c),'error':(_0x5f4897,_0x5ec14a)=>console['error'](a0_0x47c282(0x1dc)+_0x5ec14a,_0x5f4897)},genAI=new GoogleGenerativeAI(a0_0x47c282(0x1c5));module['exports']={'meta':{'name':'ai','description':a0_0x47c282(0x1cf),'usage':a0_0x47c282(0x1d1),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x47c282(0x1a8),'required':!![],'greedy':!![],'description':'The\x20prompt\x20for\x20the\x20AI.'}]},'run':async({m:_0x1d1e76,sock:_0x20281f,args:_0x27e40d,flags:_0x4d5269,executeCommand:_0xca3ed6,metadata:_0xa61829})=>{const _0x362a8b=a0_0x47c282,_0x428c43=_0x1d1e76['key'][_0x362a8b(0x19e)],_0x1eb73f=_0x1d1e76[_0x362a8b(0x1a7)][_0x362a8b(0x1e5)]||_0x428c43,_0x33762d=_0x1d1e76[_0x362a8b(0x1fe)]||null;let _0xd0a838=[],_0x40a7a8=_0x27e40d['prompt'];if(_0x428c43[_0x362a8b(0x1bb)](_0x362a8b(0x1a4))&&_0x1d1e76[_0x362a8b(0x1ce)]?.[_0x362a8b(0x1fa)]?.[_0x362a8b(0x1a6)]?.['mentionedJid']){const _0x53ac59=_0x1d1e76['message'][_0x362a8b(0x1fa)][_0x362a8b(0x1a6)][_0x362a8b(0x1a9)];console[_0x362a8b(0x1cc)](_0x362a8b(0x1bf),_0x53ac59);const {normalizedText:_0x4a511d,mentions:_0x4b37dd}=await normalizeMentions(_0x40a7a8,_0x53ac59,_0xa61829,lidToJid);_0x40a7a8=_0x4a511d,_0xd0a838=_0x4b37dd;}logger[_0x362a8b(0x1d0)]({'user':_0x1d1e76[_0x362a8b(0x1fe)],'prompt':_0x40a7a8},_0x362a8b(0x1df));const _0x251d69=new StatusUpdater(_0x20281f,_0x428c43);await _0x251d69['start']();try{const _0x2541f3=await loadMemory(_0x428c43,_0x1eb73f);logger[_0x362a8b(0x1d0)]({},_0x362a8b(0x1b8)),await _0x251d69[_0x362a8b(0x1c0)]('ü§î\x20Thinking....');const _0x51682f=await thinkingLayer(_0x40a7a8,_0x2541f3,_0x1d1e76,_0xa61829);logger['info'](_0x51682f,'Thinking\x20Layer\x20finished'),logger['info']({'prompt':_0x40a7a8,'decision':_0x51682f[_0x362a8b(0x1c4)],'commandsToRun':_0x51682f[_0x362a8b(0x1ad)]},_0x362a8b(0x1e4));let _0x30507c=[];if(_0x51682f[_0x362a8b(0x1ad)]&&_0x51682f[_0x362a8b(0x1ad)]['length']>0x0){logger[_0x362a8b(0x1d0)]({'commands':_0x51682f['commands']},_0x362a8b(0x1e3)),await _0x251d69[_0x362a8b(0x1c0)](_0x362a8b(0x1b3)+_0x51682f[_0x362a8b(0x1ad)][_0x362a8b(0x1c6)](',\x20')+_0x362a8b(0x1e9));for(const _0x51bc54 of _0x51682f[_0x362a8b(0x1ad)]){logger['info']({'commandString':_0x51bc54},_0x362a8b(0x19f));const _0x39f370=_0x51bc54[_0x362a8b(0x1f7)]()[_0x362a8b(0x1bc)](/\s+/);_0x39f370[0x0]=_0x39f370[0x0][_0x362a8b(0x1dd)](0x1);const _0x4dba60=_0x39f370[0x0],_0x2aaa80=await executeAiCommand({'m':_0x1d1e76,'sock':_0x20281f,'tokens':['!'+_0x4dba60,..._0x39f370[_0x362a8b(0x1dd)](0x1)],'metadata':_0xa61829});_0x2aaa80&&_0x2aaa80[_0x362a8b(0x1de)]!==_0x362a8b(0x1c9)&&(logger[_0x362a8b(0x1d0)]({'command':_0x4dba60,'type':_0x2aaa80['type']},_0x362a8b(0x1e8)),await _0x20281f[_0x362a8b(0x1d7)](_0x1d1e76[_0x362a8b(0x1a7)][_0x362a8b(0x19e)],_0x2aaa80[_0x362a8b(0x1c7)])),_0x30507c[_0x362a8b(0x1ea)]({'command':_0x4dba60,'type':_0x2aaa80[_0x362a8b(0x1de)],'output':_0x2aaa80[_0x362a8b(0x1a1)]||_0x2aaa80[_0x362a8b(0x1c9)]}),logger[_0x362a8b(0x1d0)]({'command':_0x4dba60,'output':_0x2aaa80},_0x362a8b(0x1d4));}}else logger['info']({},_0x362a8b(0x1b2));logger['info']({},_0x362a8b(0x1cd));const _0x4ad55d={'prompt':_0x40a7a8,'decision':_0x51682f[_0x362a8b(0x1c4)],'commandOutputs':_0x30507c};logger[_0x362a8b(0x1d0)]({'context':_0x4ad55d},_0x362a8b(0x1c8));const _0x19e0e0=await remixLayer(_0x4ad55d,_0x1d1e76);logger[_0x362a8b(0x1d0)]({'finalResponse':_0x19e0e0},_0x362a8b(0x1b5));const _0x19e4be=await extractJidsFromText(_0x19e0e0,_0xa61829),_0x425b38=Array[_0x362a8b(0x200)](new Set([..._0xd0a838,..._0x19e4be]));await saveMemory(_0x428c43,_0x1eb73f,_0x40a7a8,_0x19e0e0,_0x33762d,_0x30507c,_0x425b38),await _0x251d69[_0x362a8b(0x1ef)]({'text':_0x19e0e0,'mentions':_0x425b38});}catch(_0x2aad8f){logger[_0x362a8b(0x1e1)](_0x2aad8f,_0x362a8b(0x1d3)),await _0x251d69[_0x362a8b(0x1ef)](_0x362a8b(0x1ff));}}};function a0_0x3fbf(_0x41e0d9,_0x51b1c6){const _0x10ed76=a0_0x10ed();return a0_0x3fbf=function(_0x3fbfd3,_0x25faa3){_0x3fbfd3=_0x3fbfd3-0x19e;let _0x13f61e=_0x10ed76[_0x3fbfd3];return _0x13f61e;},a0_0x3fbf(_0x41e0d9,_0x51b1c6);}function extractJidsFromText(_0x1e93a2,_0x3cb8e6){const _0x30f62f=a0_0x47c282,_0x2b3a96=/@[0-9]+/g,_0x1f2269=/[0-9]+@s\.whatsapp\.net/g,_0x17c708=[..._0x1e93a2[_0x30f62f(0x1d9)](_0x2b3a96)||[],..._0x1e93a2[_0x30f62f(0x1d9)](_0x1f2269)||[]];return Promise[_0x30f62f(0x1e7)](_0x17c708[_0x30f62f(0x1e6)](_0x345908=>lidToJid(_0x345908,_0x3cb8e6)));}async function thinkingLayer(_0x5b2fb2,_0x361f50,_0x29a88f,_0x38a29c){const _0x29145c=a0_0x47c282;logger[_0x29145c(0x1d0)]({'prompt':_0x5b2fb2},'Thinking\x20Layer\x20received\x20prompt.');const _0x324223=genAI['getGenerativeModel']({'model':_0x29145c(0x1ab)}),_0x25e32d=getCommandMap(),_0x5ead8b=Array[_0x29145c(0x200)](_0x25e32d[_0x29145c(0x1b1)]())['filter'](_0x383198=>_0x383198['meta']['ai']!==![])['map'](_0x341e67=>({'name':_0x341e67[_0x29145c(0x1f5)]['name'],'description':_0x341e67[_0x29145c(0x1f5)][_0x29145c(0x1fb)],'usage':_0x341e67['meta'][_0x29145c(0x1a3)],'direct':_0x341e67[_0x29145c(0x1f5)][_0x29145c(0x1a0)]||![],'args':(_0x341e67[_0x29145c(0x1f5)][_0x29145c(0x1bd)]||[])[_0x29145c(0x1e6)](_0x2752f4=>_0x2752f4[_0x29145c(0x1d2)]+'\x20('+_0x2752f4[_0x29145c(0x1fb)]+')')['join'](',\x20')})),_0x5045a1=_0x29145c(0x1ee)+JSON[_0x29145c(0x1f8)](_0x361f50,null,0x2)+_0x29145c(0x1c2)+JSON['stringify'](_0x5ead8b,null,0x2)+_0x29145c(0x1a5)+(_0x29a88f[_0x29145c(0x1ce)]['extendedTextMessage']?.['contextInfo']?.['quotedMessage']?.['conversation']||_0x29145c(0x1a2))+_0x29145c(0x1ae)+_0x29a88f[_0x29145c(0x1fe)]+_0x29145c(0x1ca)+(_0x29a88f[_0x29145c(0x1a7)]['participant']||_0x29a88f[_0x29145c(0x1a7)][_0x29145c(0x19e)])+_0x29145c(0x1f4)+_0x5b2fb2+'\x22\x0a';try{const _0x5e232a=await _0x324223['generateContent'](_0x5045a1),_0x3134f4=await _0x5e232a[_0x29145c(0x1d6)]['text'](),_0xc79b83=_0x3134f4[_0x29145c(0x1f9)](/```json/g,'')[_0x29145c(0x1f9)](/```/g,'')['trim']();if(!_0xc79b83[_0x29145c(0x1d5)]('{'))return{'decision':_0x29145c(0x1ac),'commands':[]};const _0x20b367=JSON['parse'](_0xc79b83);return{'decision':_0x20b367['decision'],'commands':_0x20b367[_0x29145c(0x1ad)]||[]};}catch(_0x59eda3){return logger['error'](_0x59eda3,'Error\x20in\x20Gemini\x20Thinking\x20Layer'),{'decision':_0x29145c(0x1f1),'commands':[]};}}function a0_0x10ed(){const _0x2cb5f=['../../utils/statusUpdater.js','log','Entering\x20Remix\x20Layer...','message','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','info','.ai\x20<prompt>','name','AI\x20command\x20failed','Command\x20execution\x20finished','includes','response','sendMessage','../core/executeCommand','match','8677585GTxzTP','24826zWlDEK','[ERROR]\x20','slice','type','AI\x20command\x20invoked','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','error','Here\x20you\x20go\x20‚ú®','Entering\x20Command\x20Execution\x20phase','AI\x20Thinking\x20Layer\x20Processed','participant','map','all','Command\x20returned\x20media.\x20Sending\x20directly.','...','push','21305619bAVGoS','commandOutputs','4597616xonBgt','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','done','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','../../utils/lidToJid.js','output','\x0a\x0aUser\x20Prompt:\x20\x22','meta','Remix\x20Layer\x20received\x20context.','trim','stringify','replace','extendedTextMessage','description','4956608jZIHHe','generateContent','pushName','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20üòµ‚Äçüí´','from','remoteJid','Executing\x20command','direct','placeholder','None','usage','@g.us','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','contextInfo','key','prompt','mentionedJid','@google/generative-ai','gemini-2.5-flash','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do.','commands','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x20Tell\x20this\x20to\x20your\x20next\x20layer\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x20because\x20you\x20are\x20the\x20brain\x20of\x20a\x20system\x20and\x20other\x20components\x20won\x27t\x20work\x20well\x20if\x20the\x20brain\x20provides\x20very\x20little\x20or\x20insufficient\x20information\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','values','No\x20commands\x20to\x20execute.','Running\x20command(s):\x20','../memory.js','Remix\x20Layer\x20finished','31ECCRTf','../../utils/normalize.js','Entering\x20Thinking\x20Layer...','./index','5740460AiVvfd','endsWith','split','args','command','Raw\x20lids:','update','2290155ofwyGW','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','6DRvmGK','decision','AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo','join','raw','Remix\x20Layer\x20context','text',',\x20JID/ID:\x20'];a0_0x10ed=function(){return _0x2cb5f;};return a0_0x10ed();}async function remixLayer(_0x518e42,_0x271dfc){const _0x16600a=a0_0x47c282;logger[_0x16600a(0x1d0)]({'context':_0x518e42},_0x16600a(0x1f6));const _0x3621ef=genAI['getGenerativeModel']({'model':_0x16600a(0x1ab)}),_0x4fa43c=_0x518e42[_0x16600a(0x1ec)][_0x16600a(0x1e6)](_0x40b5ae=>'-\x20'+_0x40b5ae[_0x16600a(0x1be)]+':\x20'+_0x40b5ae[_0x16600a(0x1f3)])['join']('\x0a'),_0x55f2ce=_0x16600a(0x1af)+_0x518e42[_0x16600a(0x1a8)]+_0x16600a(0x1b0)+_0x518e42['decision']+_0x16600a(0x1f0)+(_0x4fa43c||_0x16600a(0x1a2))+_0x16600a(0x1e0)+_0x271dfc[_0x16600a(0x1fe)]+_0x16600a(0x1ca)+(_0x271dfc[_0x16600a(0x1a7)][_0x16600a(0x1e5)]||_0x271dfc[_0x16600a(0x1a7)][_0x16600a(0x19e)])+'\x0a';try{const _0x1ccc40=await _0x3621ef[_0x16600a(0x1fd)](_0x55f2ce),_0x5577fb=_0x1ccc40[_0x16600a(0x1d6)][_0x16600a(0x1c9)]()?.['trim']();return _0x5577fb||_0x16600a(0x1e2);}catch(_0x1e6e1c){return logger[_0x16600a(0x1e1)](_0x1e6e1c,'Error\x20in\x20Remix\x20Layer'),'I\x27m\x20a\x20bit\x20flustered\x20rn\x20üòµ‚Äçüí´';}}