const a0_0xdab340=a0_0xcf75;function a0_0x42e7(){const _0x1f2b5b=['decision','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly\x0a\x0aUser\x20Prompt:\x20\x22','unknown','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','../memory.js','Remix\x20Layer\x20received\x20context.','gemini-2.5-pro','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','[ERROR]\x20','sendMessage','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','11doJyIf','start','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','usage','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','pushName','10fTAKqC','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.','Executing\x20command','../../utils/statusUpdater.js','participant','29220mVdWLC','../core/executeCommand','replace','AI\x20command\x20failed','isDirect','99290teLKrE','527532qQNpky','Generated\x20callable\x20command\x20list\x20for\x20AI','getGenerativeModel','info','Command\x20execution\x20finished','Remix\x20Layer\x20context','meta','ü§î\x20Thinking....','No\x20textual\x20output.','text','AI\x20command\x20invoked','Returning\x20from\x20Thinking\x20Layer','Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20ü§Ø','done','Cleaned\x20Gemini\x20response','map','output','No\x20commands\x20to\x20execute.','key','Parsed\x20JSON\x20response','description','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20üòµ‚Äçüí´','from','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','join','generateContent','Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','log','Entering\x20Command\x20Execution\x20phase','name','commands','3171970QFdFOi','length','split','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','update','39BEhMFU','Remix\x20layer\x20returned\x20empty\x20text','Thinking\x20Layer\x20received\x20prompt.','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','includes','16qNiiNv','Thinking\x20Layer\x20finished','4637961iinxvc','commandOutputs','direct','prompt','./index','args','Sending\x20system\x20prompt\x20to\x20Gemini','[Sent\x20a\x20file:\x20','parse','filter','stringify','I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.','exports','.ai\x20<prompt>','remoteJid','@google/generative-ai','4146667cOhguc','push','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a','audio','trim','error','1034539UtmUuA','slice','Error\x20in\x20Gemini\x20Thinking\x20Layer','values'];a0_0x42e7=function(){return _0x1f2b5b;};return a0_0x42e7();}(function(_0x561c9b,_0x494a1b){const _0x50dd32=a0_0xcf75,_0xfb9d33=_0x561c9b();while(!![]){try{const _0x172fdf=parseInt(_0x50dd32(0x195))/0x1+parseInt(_0x50dd32(0x1b5))/0x2*(-parseInt(_0x50dd32(0x1da))/0x3)+parseInt(_0x50dd32(0x1b6))/0x4+parseInt(_0x50dd32(0x1aa))/0x5*(parseInt(_0x50dd32(0x1b0))/0x6)+-parseInt(_0x50dd32(0x18f))/0x7+parseInt(_0x50dd32(0x1df))/0x8*(parseInt(_0x50dd32(0x1e1))/0x9)+-parseInt(_0x50dd32(0x1d5))/0xa*(parseInt(_0x50dd32(0x1a4))/0xb);if(_0x172fdf===_0x494a1b)break;else _0xfb9d33['push'](_0xfb9d33['shift']());}catch(_0x245693){_0xfb9d33['push'](_0xfb9d33['shift']());}}}(a0_0x42e7,0x9f251));const {GoogleGenerativeAI}=require(a0_0xdab340(0x18e)),{getCommandMap}=require(a0_0xdab340(0x183)),{executeAiCommand}=require(a0_0xdab340(0x1b1)),{StatusUpdater}=require(a0_0xdab340(0x1ae)),{loadMemory,saveMemory}=require(a0_0xdab340(0x19d)),logger={'info':(_0x14eaf3,_0x41c356)=>console[a0_0xdab340(0x1d1)]('[INFO]\x20'+_0x41c356,_0x14eaf3),'error':(_0x571277,_0x5eaf45)=>console['error'](a0_0xdab340(0x1a1)+_0x5eaf45,_0x571277)},genAI=new GoogleGenerativeAI('AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI');function a0_0xcf75(_0x33a17e,_0x13a4c0){const _0x42e7a9=a0_0x42e7();return a0_0xcf75=function(_0xcf752,_0x564700){_0xcf752=_0xcf752-0x183;let _0x636153=_0x42e7a9[_0xcf752];return _0x636153;},a0_0xcf75(_0x33a17e,_0x13a4c0);}module[a0_0xdab340(0x18b)]={'meta':{'name':'ai','description':a0_0xdab340(0x19c),'usage':a0_0xdab340(0x18c),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0xdab340(0x1e4),'required':!![],'greedy':!![],'description':'The\x20prompt\x20for\x20the\x20AI.'}]},'run':async({m:_0x2d8761,sock:_0x2021a4,args:_0x355f95,flags:_0x1acce9,executeCommand:_0xded582})=>{const _0xb50963=a0_0xdab340,_0x13d7be=_0x2d8761[_0xb50963(0x1c8)][_0xb50963(0x18d)],_0x42b3df=_0x2d8761[_0xb50963(0x1c8)][_0xb50963(0x1af)]||_0x13d7be,_0xa23c5f=_0x2d8761[_0xb50963(0x1a9)]||null,_0x2d1d30=_0x355f95['prompt'];logger['info']({'user':_0x2d8761[_0xb50963(0x1a9)],'prompt':_0x2d1d30},_0xb50963(0x1c0));const _0x1cb59a=new StatusUpdater(_0x2021a4,_0x13d7be);await _0x1cb59a[_0xb50963(0x1a5)]();try{const _0x44b968=await loadMemory(_0x13d7be,_0x42b3df);logger[_0xb50963(0x1b9)]({},'Entering\x20Thinking\x20Layer...'),await _0x1cb59a['update'](_0xb50963(0x1bd));const _0x46289c=await thinkingLayer(_0x2d1d30,_0x44b968);logger['info'](_0x46289c,_0xb50963(0x1e0)),logger[_0xb50963(0x1b9)]({'prompt':_0x2d1d30,'decision':_0x46289c[_0xb50963(0x199)],'commandsToRun':_0x46289c['commands']},'AI\x20Thinking\x20Layer\x20Processed');let _0x1dbcbc=[];if(_0x46289c['commands']&&_0x46289c[_0xb50963(0x1d4)][_0xb50963(0x1d6)]>0x0){logger[_0xb50963(0x1b9)]({'commands':_0x46289c[_0xb50963(0x1d4)]},_0xb50963(0x1d2)),await _0x1cb59a[_0xb50963(0x1d9)]('Running\x20command(s):\x20'+_0x46289c[_0xb50963(0x1d4)]['join'](',\x20')+'...');for(const _0x39875f of _0x46289c[_0xb50963(0x1d4)]){logger[_0xb50963(0x1b9)]({'commandString':_0x39875f},_0xb50963(0x1ad));const _0x268bc1=_0x39875f[_0xb50963(0x193)]()[_0xb50963(0x1d7)](/\s+/);_0x268bc1[0x0]=_0x268bc1[0x0][_0xb50963(0x196)](0x1);const _0x174162=_0x268bc1[0x0],_0x5d6630=await executeAiCommand({'m':_0x2d8761,'sock':_0x2021a4,'tokens':['!'+_0x174162,..._0x268bc1[_0xb50963(0x196)](0x1)]});if(_0x5d6630&&!_0x5d6630[_0xb50963(0x1bf)]){logger[_0xb50963(0x1b9)]({'command':_0x174162,'content':_0x5d6630},'Command\x20returned\x20a\x20file.\x20Sending\x20directly.'),await _0x1cb59a[_0xb50963(0x1c3)](_0xb50963(0x1c3)),await _0x2021a4[_0xb50963(0x1a2)](_0x2d8761[_0xb50963(0x1c8)][_0xb50963(0x18d)],_0x5d6630),_0x1dbcbc[_0xb50963(0x190)]({'command':_0x174162,'output':_0xb50963(0x186)+(_0x5d6630[_0xb50963(0x192)]?_0xb50963(0x192):_0xb50963(0x19b))+']','isDirect':!![]});continue;}const _0x136184=_0x5d6630?_0x5d6630[_0xb50963(0x1bf)]:_0xb50963(0x1be);_0x1dbcbc[_0xb50963(0x190)]({'command':_0x174162,'output':_0x136184}),logger[_0xb50963(0x1b9)]({'command':_0x174162,'output':_0x136184},_0xb50963(0x1ba));}}else logger['info']({},_0xb50963(0x1c7));if(_0x1dbcbc[_0xb50963(0x1d6)]>0x0&&_0x1dbcbc['every'](_0x51a817=>_0x51a817[_0xb50963(0x1b4)])){logger[_0xb50963(0x1b9)]({},_0xb50963(0x1d8));return;}logger[_0xb50963(0x1b9)]({},'Entering\x20Remix\x20Layer...');const _0x3e9b88={'prompt':_0x2d1d30,'decision':_0x46289c['decision'],'commandOutputs':_0x1dbcbc};logger[_0xb50963(0x1b9)]({'context':_0x3e9b88},_0xb50963(0x1bb));const _0x3295fc=await remixLayer(_0x3e9b88);logger[_0xb50963(0x1b9)]({'finalResponse':_0x3295fc},'Remix\x20Layer\x20finished'),await saveMemory(_0x13d7be,_0x42b3df,_0x2d1d30,_0x3295fc,_0xa23c5f,_0x1dbcbc),await _0x1cb59a[_0xb50963(0x1c3)](_0x3295fc);}catch(_0x31b9a9){logger['error'](_0x31b9a9,_0xb50963(0x1b3)),await _0x1cb59a[_0xb50963(0x1c3)](_0xb50963(0x1cb));}}};async function thinkingLayer(_0x100e20,_0xb13bd9){const _0x2b6186=a0_0xdab340;logger[_0x2b6186(0x1b9)]({'prompt':_0x100e20},_0x2b6186(0x1dc));const _0x187020=genAI['getGenerativeModel']({'model':'gemini-2.5-pro'}),_0x3c3494=getCommandMap(),_0x426041=Array[_0x2b6186(0x1cc)](_0x3c3494[_0x2b6186(0x198)]())['filter'](_0x2314a5=>_0x2314a5[_0x2b6186(0x1bc)]['ai']!==![])[_0x2b6186(0x1c5)](_0x2e706e=>({'name':_0x2e706e[_0x2b6186(0x1bc)][_0x2b6186(0x1d3)],'description':_0x2e706e['meta'][_0x2b6186(0x1ca)],'usage':_0x2e706e['meta'][_0x2b6186(0x1a7)],'direct':_0x2e706e[_0x2b6186(0x1bc)][_0x2b6186(0x1e3)]||![],'args':(_0x2e706e[_0x2b6186(0x1bc)][_0x2b6186(0x184)]||[])[_0x2b6186(0x1c5)](_0x339100=>_0x339100[_0x2b6186(0x1d3)]+'\x20('+_0x339100[_0x2b6186(0x1ca)]+')')[_0x2b6186(0x1ce)](',\x20')}));logger['info']({'count':_0x426041[_0x2b6186(0x1d6)]},_0x2b6186(0x1b7));const _0x19771e=_0x2b6186(0x1a3)+JSON[_0x2b6186(0x189)](_0xb13bd9,null,0x2)+_0x2b6186(0x1ab)+JSON[_0x2b6186(0x189)](_0x426041,null,0x2)+_0x2b6186(0x19a)+_0x100e20+'\x22\x0a';logger[_0x2b6186(0x1b9)](_0x2b6186(0x185));try{const _0x24c674=await _0x187020[_0x2b6186(0x1cf)](_0x19771e),_0x3a7ba3=await _0x24c674['response'][_0x2b6186(0x1bf)]();logger[_0x2b6186(0x1b9)]({'responseText':_0x3a7ba3},'Received\x20response\x20from\x20Gemini');const _0x55927c=_0x3a7ba3[_0x2b6186(0x1b2)](/```json/g,'')['replace'](/```/g,'')[_0x2b6186(0x193)]();logger['info']({'cleanedText':_0x55927c},_0x2b6186(0x1c4));if(!_0x55927c||!_0x55927c[_0x2b6186(0x1de)]('{')||!_0x55927c[_0x2b6186(0x1de)]('}'))return logger[_0x2b6186(0x194)]({'cleanedText':_0x55927c},_0x2b6186(0x1d0)),{'decision':_0x2b6186(0x1cd),'commands':[]};const _0x1de595=JSON[_0x2b6186(0x187)](_0x55927c);logger[_0x2b6186(0x1b9)]({'jsonResponse':_0x1de595},_0x2b6186(0x1c9));const _0x1f2043={'decision':_0x1de595['decision'],'commands':_0x1de595[_0x2b6186(0x1d4)]||[]};return logger[_0x2b6186(0x1b9)]({'thinkingResult':_0x1f2043},_0x2b6186(0x1c1)),_0x1f2043;}catch(_0x21957a){return logger[_0x2b6186(0x194)](_0x21957a,_0x2b6186(0x197)),{'decision':_0x2b6186(0x1a6),'commands':[]};}}async function remixLayer(_0x5ebb34){const _0x31b570=a0_0xdab340;logger[_0x31b570(0x1b9)]({'context':_0x5ebb34},_0x31b570(0x19e));const _0x199f41=genAI[_0x31b570(0x1b8)]({'model':_0x31b570(0x19f)}),_0x1e8ec4=_0x5ebb34['commandOutputs'][_0x31b570(0x188)](_0x32cd0c=>!_0x32cd0c[_0x31b570(0x1b4)]);if(_0x1e8ec4[_0x31b570(0x1d6)]===0x0&&_0x5ebb34[_0x31b570(0x1e2)][_0x31b570(0x1d6)]>0x0)return logger[_0x31b570(0x1b9)]({},_0x31b570(0x1ac)),'Gotcha,\x20all\x20commands\x20handled.\x20‚ú®';const _0x9e58ac='\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22'+_0x5ebb34[_0x31b570(0x1e4)]+_0x31b570(0x1a8)+_0x5ebb34['decision']+_0x31b570(0x1a0)+(_0x1e8ec4[_0x31b570(0x1c5)](_0x29ddd5=>'-\x20'+_0x29ddd5['command']+':\x20'+_0x29ddd5[_0x31b570(0x1c6)])[_0x31b570(0x1ce)]('\x0a')||'None')+_0x31b570(0x191);logger[_0x31b570(0x1b9)](_0x31b570(0x1dd));try{const _0x4809f8=await _0x199f41[_0x31b570(0x1cf)](_0x9e58ac),_0x10172e=await _0x4809f8['response'],_0x244523=_0x10172e['text']()?.[_0x31b570(0x193)]();if(!_0x244523)return logger[_0x31b570(0x194)]({},_0x31b570(0x1db)),_0x31b570(0x1c2);return logger[_0x31b570(0x1b9)]({'response':_0x244523},'Received\x20final\x20response\x20from\x20Gemini.'),_0x244523;}catch(_0xa037d6){return logger['error'](_0xa037d6,'Error\x20in\x20Gemini\x20Remix\x20Layer'),_0x31b570(0x18a);}}