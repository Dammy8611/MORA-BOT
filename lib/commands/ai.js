const a0_0xc78bf0=a0_0x2762;(function(_0x47debd,_0x388bfa){const _0x6d5e5f=a0_0x2762,_0x12d54f=_0x47debd();while(!![]){try{const _0xd28197=parseInt(_0x6d5e5f(0x16a))/0x1+-parseInt(_0x6d5e5f(0x16f))/0x2+parseInt(_0x6d5e5f(0x16c))/0x3+-parseInt(_0x6d5e5f(0x169))/0x4+parseInt(_0x6d5e5f(0x15f))/0x5*(parseInt(_0x6d5e5f(0x146))/0x6)+-parseInt(_0x6d5e5f(0x121))/0x7+parseInt(_0x6d5e5f(0x13c))/0x8;if(_0xd28197===_0x388bfa)break;else _0x12d54f['push'](_0x12d54f['shift']());}catch(_0x2749fd){_0x12d54f['push'](_0x12d54f['shift']());}}}(a0_0x291b,0x92891));function a0_0x2762(_0x17f430,_0x50387a){const _0x291bcd=a0_0x291b();return a0_0x2762=function(_0x276232,_0x119e4e){_0x276232=_0x276232-0x11d;let _0x47bc0a=_0x291bcd[_0x276232];return _0x47bc0a;},a0_0x2762(_0x17f430,_0x50387a);}function a0_0x291b(){const _0x2d7157=['../memory.js','Entering\x20Remix\x20Layer...','Received\x20response\x20from\x20Gemini','split','update','4793572LyCsdZ','.ai\x20<prompt>','...','Returning\x20from\x20Thinking\x20Layer','ðŸ¤”\x20Thinking....','args','gemini-2.5-pro','every','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly\x0a\x0aUser\x20Prompt:\x20\x22','parse','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20ðŸ˜µâ€ðŸ’«','slice','commands','Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','description','text','stringify','The\x20prompt\x20for\x20the\x20AI.','[ERROR]\x20','exports','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','AI\x20Thinking\x20Layer\x20Processed','Remix\x20layer\x20returned\x20empty\x20text','./index','name','Executing\x20command','key','3779272uMgaIA','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','Remix\x20Layer\x20finished','Error\x20in\x20Gemini\x20Thinking\x20Layer','done','Entering\x20Command\x20Execution\x20phase','Running\x20command(s):\x20','No\x20textual\x20output.','message','generateContent','30CdQgxL','output','replace','Remix\x20Layer\x20received\x20context.','../core/executeCommand','error','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','AI\x20command\x20failed','join','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','Generated\x20callable\x20command\x20list\x20for\x20AI','None','map','conversation','command','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','pushName','Command\x20execution\x20finished','push','quotedMessage','usage','[INFO]\x20','length','prompt','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','1178700NbwXkE','getGenerativeModel','isDirect','trim','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','Thinking\x20Layer\x20finished','info','../../utils/statusUpdater.js','unknown','remoteJid','2115484hOSTWi','918645rQSkyP','response','243330gREJaU','extendedTextMessage','No\x20commands\x20to\x20execute.','1673976QjgaEB','Gotcha,\x20all\x20commands\x20handled.\x20âœ¨','Sending\x20system\x20prompt\x20to\x20Gemini','log','decision','filter','@google/generative-ai','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a','direct','Error\x20in\x20Gemini\x20Remix\x20Layer','commandOutputs','Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20ðŸ¤¯','meta','AI\x20command\x20invoked','from'];a0_0x291b=function(){return _0x2d7157;};return a0_0x291b();}const {GoogleGenerativeAI}=require(a0_0xc78bf0(0x175)),{getCommandMap}=require(a0_0xc78bf0(0x138)),{executeAiCommand}=require(a0_0xc78bf0(0x14a)),{StatusUpdater}=require(a0_0xc78bf0(0x166)),{loadMemory,saveMemory}=require(a0_0xc78bf0(0x17e)),logger={'info':(_0x5544c4,_0xd61634)=>console[a0_0xc78bf0(0x172)](a0_0xc78bf0(0x15b)+_0xd61634,_0x5544c4),'error':(_0x22c6d8,_0x13fa59)=>console[a0_0xc78bf0(0x14b)](a0_0xc78bf0(0x133)+_0x13fa59,_0x22c6d8)},genAI=new GoogleGenerativeAI('AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI');module[a0_0xc78bf0(0x134)]={'meta':{'name':'ai','description':a0_0xc78bf0(0x13d),'usage':a0_0xc78bf0(0x122),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0xc78bf0(0x15d),'required':!![],'greedy':!![],'description':a0_0xc78bf0(0x132)}]},'run':async({m:_0x2ff60f,sock:_0xa55708,args:_0x5b64d0,flags:_0x2e6d24,executeCommand:_0x5db18b,metadata:_0x4882bb})=>{const _0x33043b=a0_0xc78bf0,_0x46113e=_0x2ff60f[_0x33043b(0x13b)][_0x33043b(0x168)],_0x5eb5dd=_0x2ff60f['key']['participant']||_0x46113e,_0x2c11a1=_0x2ff60f[_0x33043b(0x156)]||null,_0xa7d6e=_0x5b64d0['prompt'];logger['info']({'user':_0x2ff60f[_0x33043b(0x156)],'prompt':_0xa7d6e},_0x33043b(0x17c));const _0x3f9599=new StatusUpdater(_0xa55708,_0x46113e);await _0x3f9599['start']();try{const _0x43f050=await loadMemory(_0x46113e,_0x5eb5dd);logger['info']({},'Entering\x20Thinking\x20Layer...'),await _0x3f9599['update'](_0x33043b(0x125));const _0x582bf3=await thinkingLayer(_0xa7d6e,_0x43f050,_0x2ff60f,_0x4882bb);logger[_0x33043b(0x165)](_0x582bf3,_0x33043b(0x164)),logger['info']({'prompt':_0xa7d6e,'decision':_0x582bf3['decision'],'commandsToRun':_0x582bf3[_0x33043b(0x12d)]},_0x33043b(0x136));let _0x244cc4=[];if(_0x582bf3[_0x33043b(0x12d)]&&_0x582bf3[_0x33043b(0x12d)][_0x33043b(0x15c)]>0x0){logger['info']({'commands':_0x582bf3['commands']},_0x33043b(0x141)),await _0x3f9599[_0x33043b(0x120)](_0x33043b(0x142)+_0x582bf3[_0x33043b(0x12d)][_0x33043b(0x14e)](',\x20')+_0x33043b(0x123));for(const _0x48fe14 of _0x582bf3[_0x33043b(0x12d)]){logger[_0x33043b(0x165)]({'commandString':_0x48fe14},_0x33043b(0x13a));const _0x671da4=_0x48fe14[_0x33043b(0x162)]()[_0x33043b(0x11f)](/\s+/);_0x671da4[0x0]=_0x671da4[0x0]['slice'](0x1);const _0x2d9c1f=_0x671da4[0x0],_0x398e68=await executeAiCommand({'m':_0x2ff60f,'sock':_0xa55708,'tokens':['!'+_0x2d9c1f,..._0x671da4[_0x33043b(0x12c)](0x1)],'metadata':_0x4882bb});if(_0x398e68&&!_0x398e68[_0x33043b(0x130)]){logger[_0x33043b(0x165)]({'command':_0x2d9c1f,'content':_0x398e68},'Command\x20returned\x20a\x20file.\x20Sending\x20directly.'),await _0x3f9599[_0x33043b(0x140)](_0x33043b(0x140)),await _0xa55708['sendMessage'](_0x2ff60f[_0x33043b(0x13b)][_0x33043b(0x168)],_0x398e68),_0x244cc4[_0x33043b(0x158)]({'command':_0x2d9c1f,'output':'[Sent\x20a\x20file:\x20'+(_0x398e68['audio']?'audio':_0x33043b(0x167))+']','isDirect':!![]});continue;}const _0x18c03c=_0x398e68?_0x398e68['text']:_0x33043b(0x143);_0x244cc4[_0x33043b(0x158)]({'command':_0x2d9c1f,'output':_0x18c03c}),logger[_0x33043b(0x165)]({'command':_0x2d9c1f,'output':_0x18c03c},_0x33043b(0x157));}}else logger[_0x33043b(0x165)]({},_0x33043b(0x16e));if(_0x244cc4[_0x33043b(0x15c)]>0x0&&_0x244cc4[_0x33043b(0x128)](_0x2966aa=>_0x2966aa[_0x33043b(0x161)])){logger[_0x33043b(0x165)]({},'All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.');return;}logger['info']({},_0x33043b(0x11d));const _0x5004e1={'prompt':_0xa7d6e,'decision':_0x582bf3[_0x33043b(0x173)],'commandOutputs':_0x244cc4};logger['info']({'context':_0x5004e1},'Remix\x20Layer\x20context');const _0x2abfed=await remixLayer(_0x5004e1);logger[_0x33043b(0x165)]({'finalResponse':_0x2abfed},_0x33043b(0x13e)),await saveMemory(_0x46113e,_0x5eb5dd,_0xa7d6e,_0x2abfed,_0x2c11a1,_0x244cc4),await _0x3f9599['done'](_0x2abfed);}catch(_0x35aaa4){logger['error'](_0x35aaa4,_0x33043b(0x14d)),await _0x3f9599[_0x33043b(0x140)](_0x33043b(0x12b));}}};async function thinkingLayer(_0x13272b,_0x2066c9,_0x6dd036,_0x44d16d){const _0x62694e=a0_0xc78bf0;logger[_0x62694e(0x165)]({'prompt':_0x13272b},'Thinking\x20Layer\x20received\x20prompt.');const _0x356fee=genAI[_0x62694e(0x160)]({'model':'gemini-2.5-pro'}),_0xc0c73=getCommandMap(),_0x33e63c=Array[_0x62694e(0x17d)](_0xc0c73['values']())[_0x62694e(0x174)](_0x24de3c=>_0x24de3c[_0x62694e(0x17b)]['ai']!==![])[_0x62694e(0x152)](_0x392bf7=>({'name':_0x392bf7[_0x62694e(0x17b)][_0x62694e(0x139)],'description':_0x392bf7['meta'][_0x62694e(0x12f)],'usage':_0x392bf7[_0x62694e(0x17b)][_0x62694e(0x15a)],'direct':_0x392bf7['meta'][_0x62694e(0x177)]||![],'args':(_0x392bf7[_0x62694e(0x17b)][_0x62694e(0x126)]||[])[_0x62694e(0x152)](_0x4c91f5=>_0x4c91f5['name']+'\x20('+_0x4c91f5[_0x62694e(0x12f)]+')')['join'](',\x20')}));logger[_0x62694e(0x165)]({'count':_0x33e63c[_0x62694e(0x15c)]},_0x62694e(0x150));const _0x558806=_0x62694e(0x135)+JSON[_0x62694e(0x131)](_0x2066c9,null,0x2)+_0x62694e(0x14c)+JSON[_0x62694e(0x131)](_0x33e63c,null,0x2)+_0x62694e(0x163)+(_0x6dd036[_0x62694e(0x144)][_0x62694e(0x16d)]?.['contextInfo']?.[_0x62694e(0x159)]?.[_0x62694e(0x153)]||_0x62694e(0x151))+_0x62694e(0x129)+_0x13272b+'\x22\x0a';logger['info'](_0x62694e(0x171));try{const _0x539fe8=await _0x356fee[_0x62694e(0x145)](_0x558806),_0x510e7b=await _0x539fe8[_0x62694e(0x16b)][_0x62694e(0x130)]();logger[_0x62694e(0x165)]({'responseText':_0x510e7b},_0x62694e(0x11e));const _0x3a27fa=_0x510e7b[_0x62694e(0x148)](/```json/g,'')[_0x62694e(0x148)](/```/g,'')[_0x62694e(0x162)]();logger[_0x62694e(0x165)]({'cleanedText':_0x3a27fa},'Cleaned\x20Gemini\x20response');if(!_0x3a27fa||!_0x3a27fa['includes']('{')||!_0x3a27fa['includes']('}'))return logger[_0x62694e(0x14b)]({'cleanedText':_0x3a27fa},_0x62694e(0x12e)),{'decision':'I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','commands':[]};const _0x55e9c7=JSON[_0x62694e(0x12a)](_0x3a27fa);logger[_0x62694e(0x165)]({'jsonResponse':_0x55e9c7},'Parsed\x20JSON\x20response');const _0x357030={'decision':_0x55e9c7[_0x62694e(0x173)],'commands':_0x55e9c7[_0x62694e(0x12d)]||[]};return logger[_0x62694e(0x165)]({'thinkingResult':_0x357030},_0x62694e(0x124)),_0x357030;}catch(_0x2ec557){return logger[_0x62694e(0x14b)](_0x2ec557,_0x62694e(0x13f)),{'decision':_0x62694e(0x14f),'commands':[]};}}async function remixLayer(_0x24ed7a){const _0x255afb=a0_0xc78bf0;logger[_0x255afb(0x165)]({'context':_0x24ed7a},_0x255afb(0x149));const _0x1be662=genAI['getGenerativeModel']({'model':_0x255afb(0x127)}),_0x36ee0a=_0x24ed7a[_0x255afb(0x179)][_0x255afb(0x174)](_0x5c67c8=>!_0x5c67c8[_0x255afb(0x161)]);if(_0x36ee0a[_0x255afb(0x15c)]===0x0&&_0x24ed7a[_0x255afb(0x179)][_0x255afb(0x15c)]>0x0)return logger[_0x255afb(0x165)]({},'All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.'),_0x255afb(0x170);const _0x1c2a83='\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22'+_0x24ed7a['prompt']+_0x255afb(0x15e)+_0x24ed7a[_0x255afb(0x173)]+'\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a'+(_0x36ee0a[_0x255afb(0x152)](_0x168545=>'-\x20'+_0x168545[_0x255afb(0x154)]+':\x20'+_0x168545[_0x255afb(0x147)])['join']('\x0a')||_0x255afb(0x151))+_0x255afb(0x176);logger[_0x255afb(0x165)](_0x255afb(0x155));try{const _0xa1d564=await _0x1be662[_0x255afb(0x145)](_0x1c2a83),_0x248096=await _0xa1d564[_0x255afb(0x16b)],_0x3b80db=_0x248096[_0x255afb(0x130)]()?.[_0x255afb(0x162)]();if(!_0x3b80db)return logger[_0x255afb(0x14b)]({},_0x255afb(0x137)),_0x255afb(0x17a);return logger[_0x255afb(0x165)]({'response':_0x3b80db},'Received\x20final\x20response\x20from\x20Gemini.'),_0x3b80db;}catch(_0x4ae6cf){return logger[_0x255afb(0x14b)](_0x4ae6cf,_0x255afb(0x178)),'I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.';}}