const a0_0x4b6a63=a0_0x490d;(function(_0x34c063,_0x3a62f5){const _0x16c9be=a0_0x490d,_0x2f0d55=_0x34c063();while(!![]){try{const _0x279d8b=parseInt(_0x16c9be(0x7b))/0x1+parseInt(_0x16c9be(0x9b))/0x2*(-parseInt(_0x16c9be(0xc9))/0x3)+-parseInt(_0x16c9be(0xa4))/0x4+parseInt(_0x16c9be(0xab))/0x5+-parseInt(_0x16c9be(0xa9))/0x6*(-parseInt(_0x16c9be(0x72))/0x7)+parseInt(_0x16c9be(0x68))/0x8*(parseInt(_0x16c9be(0xb1))/0x9)+parseInt(_0x16c9be(0x6f))/0xa*(-parseInt(_0x16c9be(0xd0))/0xb);if(_0x279d8b===_0x3a62f5)break;else _0x2f0d55['push'](_0x2f0d55['shift']());}catch(_0x2a4171){_0x2f0d55['push'](_0x2f0d55['shift']());}}}(a0_0x288b,0xd2dbd));function a0_0x490d(_0x200768,_0x51cd98){const _0x288bb4=a0_0x288b();return a0_0x490d=function(_0x490d29,_0x537ecc){_0x490d29=_0x490d29-0x67;let _0x3b2253=_0x288bb4[_0x490d29];return _0x3b2253;},a0_0x490d(_0x200768,_0x51cd98);}const {GoogleGenerativeAI}=require(a0_0x4b6a63(0xbf)),{getCommandMap}=require('./index'),{executeAiCommand}=require(a0_0x4b6a63(0xa6)),{StatusUpdater}=require(a0_0x4b6a63(0x81)),{loadMemory,saveMemory}=require(a0_0x4b6a63(0xa1)),logger={'info':(_0x788bee,_0xd1cd6)=>console['log']('[INFO]\x20'+_0xd1cd6,_0x788bee),'error':(_0x14d17,_0x37522b)=>console['error'](a0_0x4b6a63(0x7c)+_0x37522b,_0x14d17)},genAI=new GoogleGenerativeAI(a0_0x4b6a63(0x76));function a0_0x288b(){const _0x3c6d8f=['direct','stringify','Command\x20execution\x20finished','error','generateContent','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','done','from','Error\x20in\x20Gemini\x20Remix\x20Layer','meta','slice','parse','decision','@google/generative-ai','info','text','audio','exports','AI\x20command\x20invoked','\x0a\x0aUser\x20Prompt:\x20\x22','replace','unknown','Remix\x20layer\x20returned\x20empty\x20text','5553VbnDUH','sendMessage','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20üòµ‚Äçüí´','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','quotedMessage','Generated\x20callable\x20command\x20list\x20for\x20AI','11HOKydH','The\x20prompt\x20for\x20the\x20AI.','136kByCgQ','Error\x20in\x20Gemini\x20Thinking\x20Layer','Entering\x20Command\x20Execution\x20phase',',\x20JID/ID:\x20','pushName','output','Received\x20response\x20from\x20Gemini','36078970gWyKfL','prompt','Parsed\x20JSON\x20response','1621893YoBdkC','No\x20textual\x20output.','map','Entering\x20Remix\x20Layer...','AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo','contextInfo','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','1691693xuiQmq','[ERROR]\x20','extendedTextMessage','participant','isDirect','key','../../utils/statusUpdater.js','includes','commandOutputs','response','update','Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','name','...','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','Running\x20command(s):\x20','Remix\x20Layer\x20received\x20context.','join','split','description','push','Gotcha,\x20all\x20commands\x20handled.\x20‚ú®','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','values','length','message','Received\x20final\x20response\x20from\x20Gemini.','AI\x20Thinking\x20Layer\x20Processed','conversation','No\x20commands\x20to\x20execute.','command','78fKBxGt','None','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','Cleaned\x20Gemini\x20response','remoteJid','../memory.js','every','args','292816nOyKRq','gemini-2.5-flash','../core/executeCommand','ü§î\x20Thinking....','trim','30GaLJOp','.ai\x20<prompt>','903225TeKSTt','Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20ü§Ø','usage','commands','[Sent\x20a\x20file:\x20','getGenerativeModel','839718jMGbkC'];a0_0x288b=function(){return _0x3c6d8f;};return a0_0x288b();}module[a0_0x4b6a63(0xc3)]={'meta':{'name':'ai','description':'A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','usage':a0_0x4b6a63(0xaa),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x4b6a63(0x70),'required':!![],'greedy':!![],'description':a0_0x4b6a63(0x67)}]},'run':async({m:_0x2f8ff7,sock:_0x48acf5,args:_0x441a3f,flags:_0x18cc16,executeCommand:_0x52ce10,metadata:_0x3f4ba7})=>{const _0xf757bf=a0_0x4b6a63,_0x5563ac=_0x2f8ff7[_0xf757bf(0x80)][_0xf757bf(0xa0)],_0x1a276d=_0x2f8ff7[_0xf757bf(0x80)]['participant']||_0x5563ac,_0x419b50=_0x2f8ff7[_0xf757bf(0x6c)]||null,_0x481f4a=_0x441a3f['prompt'];logger[_0xf757bf(0xc0)]({'user':_0x2f8ff7['pushName'],'prompt':_0x481f4a},_0xf757bf(0xc4));const _0xaf8123=new StatusUpdater(_0x48acf5,_0x5563ac);await _0xaf8123['start']();try{const _0x32b8c5=await loadMemory(_0x5563ac,_0x1a276d);logger[_0xf757bf(0xc0)]({},'Entering\x20Thinking\x20Layer...'),await _0xaf8123[_0xf757bf(0x85)](_0xf757bf(0xa7));const _0x33bc31=await thinkingLayer(_0x481f4a,_0x32b8c5,_0x2f8ff7,_0x3f4ba7);logger['info'](_0x33bc31,'Thinking\x20Layer\x20finished'),logger['info']({'prompt':_0x481f4a,'decision':_0x33bc31[_0xf757bf(0xbe)],'commandsToRun':_0x33bc31[_0xf757bf(0xae)]},_0xf757bf(0x97));let _0x4b6332=[];if(_0x33bc31[_0xf757bf(0xae)]&&_0x33bc31[_0xf757bf(0xae)][_0xf757bf(0x94)]>0x0){logger[_0xf757bf(0xc0)]({'commands':_0x33bc31['commands']},_0xf757bf(0x6a)),await _0xaf8123[_0xf757bf(0x85)](_0xf757bf(0x8a)+_0x33bc31[_0xf757bf(0xae)]['join'](',\x20')+_0xf757bf(0x88));for(const _0x1139c0 of _0x33bc31[_0xf757bf(0xae)]){logger[_0xf757bf(0xc0)]({'commandString':_0x1139c0},'Executing\x20command');const _0x21b51e=_0x1139c0[_0xf757bf(0xa8)]()[_0xf757bf(0x8d)](/\s+/);_0x21b51e[0x0]=_0x21b51e[0x0][_0xf757bf(0xbc)](0x1);const _0x1549f3=_0x21b51e[0x0],_0x327fd8=await executeAiCommand({'m':_0x2f8ff7,'sock':_0x48acf5,'tokens':['!'+_0x1549f3,..._0x21b51e[_0xf757bf(0xbc)](0x1)],'metadata':_0x3f4ba7});if(_0x327fd8&&!_0x327fd8[_0xf757bf(0xc1)]){logger[_0xf757bf(0xc0)]({'command':_0x1549f3,'content':_0x327fd8},'Command\x20returned\x20a\x20file.\x20Sending\x20directly.'),await _0xaf8123[_0xf757bf(0xb8)](_0xf757bf(0xb8)),await _0x48acf5[_0xf757bf(0xca)](_0x2f8ff7[_0xf757bf(0x80)]['remoteJid'],_0x327fd8),_0x4b6332[_0xf757bf(0x8f)]({'command':_0x1549f3,'output':_0xf757bf(0xaf)+(_0x327fd8[_0xf757bf(0xc2)]?_0xf757bf(0xc2):_0xf757bf(0xc7))+']','isDirect':!![]});continue;}const _0x23f318=_0x327fd8?_0x327fd8['text']:_0xf757bf(0x73);_0x4b6332[_0xf757bf(0x8f)]({'command':_0x1549f3,'output':_0x23f318}),logger[_0xf757bf(0xc0)]({'command':_0x1549f3,'output':_0x23f318},_0xf757bf(0xb4));}}else logger[_0xf757bf(0xc0)]({},_0xf757bf(0x99));if(_0x4b6332[_0xf757bf(0x94)]>0x0&&_0x4b6332[_0xf757bf(0xa2)](_0x1eb9b4=>_0x1eb9b4[_0xf757bf(0x7f)])){logger['info']({},_0xf757bf(0xcb));return;}logger[_0xf757bf(0xc0)]({},_0xf757bf(0x75));const _0x57057d={'prompt':_0x481f4a,'decision':_0x33bc31[_0xf757bf(0xbe)],'commandOutputs':_0x4b6332};logger[_0xf757bf(0xc0)]({'context':_0x57057d},'Remix\x20Layer\x20context');const _0x44f632=await remixLayer(_0x57057d,_0x2f8ff7);logger[_0xf757bf(0xc0)]({'finalResponse':_0x44f632},'Remix\x20Layer\x20finished'),await saveMemory(_0x5563ac,_0x1a276d,_0x481f4a,_0x44f632,_0x419b50,_0x4b6332),await _0xaf8123[_0xf757bf(0xb8)](_0x44f632);}catch(_0x774635){logger[_0xf757bf(0xb5)](_0x774635,'AI\x20command\x20failed'),await _0xaf8123[_0xf757bf(0xb8)](_0xf757bf(0xcc));}}};async function thinkingLayer(_0x3d1797,_0x2f5513,_0x252076,_0x5b551c){const _0x5a04b2=a0_0x4b6a63;logger[_0x5a04b2(0xc0)]({'prompt':_0x3d1797},'Thinking\x20Layer\x20received\x20prompt.');const _0x40779b=genAI[_0x5a04b2(0xb0)]({'model':_0x5a04b2(0xa5)}),_0x120b46=getCommandMap(),_0x5e237b=Array[_0x5a04b2(0xb9)](_0x120b46[_0x5a04b2(0x93)]())['filter'](_0xa82c49=>_0xa82c49[_0x5a04b2(0xbb)]['ai']!==![])[_0x5a04b2(0x74)](_0x43f976=>({'name':_0x43f976[_0x5a04b2(0xbb)][_0x5a04b2(0x87)],'description':_0x43f976['meta'][_0x5a04b2(0x8e)],'usage':_0x43f976[_0x5a04b2(0xbb)][_0x5a04b2(0xad)],'direct':_0x43f976['meta'][_0x5a04b2(0xb2)]||![],'args':(_0x43f976[_0x5a04b2(0xbb)][_0x5a04b2(0xa3)]||[])[_0x5a04b2(0x74)](_0x574c5a=>_0x574c5a[_0x5a04b2(0x87)]+'\x20('+_0x574c5a[_0x5a04b2(0x8e)]+')')['join'](',\x20')}));logger[_0x5a04b2(0xc0)]({'count':_0x5e237b[_0x5a04b2(0x94)]},_0x5a04b2(0xcf));const _0x5ba064=_0x5a04b2(0x9e)+JSON[_0x5a04b2(0xb3)](_0x2f5513,null,0x2)+_0x5a04b2(0x92)+JSON[_0x5a04b2(0xb3)](_0x5e237b,null,0x2)+'\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a'+(_0x252076[_0x5a04b2(0x95)][_0x5a04b2(0x7d)]?.[_0x5a04b2(0x77)]?.[_0x5a04b2(0xce)]?.[_0x5a04b2(0x98)]||_0x5a04b2(0x9c))+_0x5a04b2(0x9d)+_0x252076[_0x5a04b2(0x6c)]+_0x5a04b2(0x6b)+(_0x252076[_0x5a04b2(0x80)]['participant']||_0x252076[_0x5a04b2(0x80)][_0x5a04b2(0xa0)])+_0x5a04b2(0xc5)+_0x3d1797+'\x22\x0a';logger[_0x5a04b2(0xc0)]('Sending\x20system\x20prompt\x20to\x20Gemini');try{const _0x409732=await _0x40779b[_0x5a04b2(0xb6)](_0x5ba064),_0x3ff76c=await _0x409732['response']['text']();logger[_0x5a04b2(0xc0)]({'responseText':_0x3ff76c},_0x5a04b2(0x6e));const _0x530754=_0x3ff76c[_0x5a04b2(0xc6)](/```json/g,'')[_0x5a04b2(0xc6)](/```/g,'')[_0x5a04b2(0xa8)]();logger[_0x5a04b2(0xc0)]({'cleanedText':_0x530754},_0x5a04b2(0x9f));if(!_0x530754||!_0x530754[_0x5a04b2(0x82)]('{')||!_0x530754[_0x5a04b2(0x82)]('}'))return logger[_0x5a04b2(0xb5)]({'cleanedText':_0x530754},_0x5a04b2(0x86)),{'decision':_0x5a04b2(0x79),'commands':[]};const _0x4a9c91=JSON[_0x5a04b2(0xbd)](_0x530754);logger[_0x5a04b2(0xc0)]({'jsonResponse':_0x4a9c91},_0x5a04b2(0x71));const _0xbb4f80={'decision':_0x4a9c91['decision'],'commands':_0x4a9c91[_0x5a04b2(0xae)]||[]};return logger[_0x5a04b2(0xc0)]({'thinkingResult':_0xbb4f80},'Returning\x20from\x20Thinking\x20Layer'),_0xbb4f80;}catch(_0xe31d02){return logger[_0x5a04b2(0xb5)](_0xe31d02,_0x5a04b2(0x69)),{'decision':_0x5a04b2(0xb7),'commands':[]};}}async function remixLayer(_0x38fc82,_0x5983ae){const _0x225252=a0_0x4b6a63;logger[_0x225252(0xc0)]({'context':_0x38fc82},_0x225252(0x8b));const _0x4618c7=genAI[_0x225252(0xb0)]({'model':_0x225252(0xa5)}),_0x45eb9d=_0x38fc82[_0x225252(0x83)]['filter'](_0x450477=>!_0x450477[_0x225252(0x7f)]);if(_0x45eb9d[_0x225252(0x94)]===0x0&&_0x38fc82['commandOutputs'][_0x225252(0x94)]>0x0)return logger['info']({},'All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.'),_0x225252(0x90);const _0x3bf0ec=_0x225252(0x91)+_0x38fc82[_0x225252(0x70)]+_0x225252(0x7a)+_0x38fc82[_0x225252(0xbe)]+_0x225252(0x89)+(_0x45eb9d['map'](_0x47442b=>'-\x20'+_0x47442b[_0x225252(0x9a)]+':\x20'+_0x47442b[_0x225252(0x6d)])[_0x225252(0x8c)]('\x0a')||_0x225252(0x9c))+_0x225252(0xcd)+_0x5983ae[_0x225252(0x6c)]+_0x225252(0x6b)+(_0x5983ae[_0x225252(0x80)][_0x225252(0x7e)]||_0x5983ae[_0x225252(0x80)][_0x225252(0xa0)])+'\x0a';logger[_0x225252(0xc0)](_0x225252(0x78));try{const _0x2f6025=await _0x4618c7[_0x225252(0xb6)](_0x3bf0ec),_0x28b666=await _0x2f6025[_0x225252(0x84)],_0x49c0aa=_0x28b666[_0x225252(0xc1)]()?.['trim']();if(!_0x49c0aa)return logger[_0x225252(0xb5)]({},_0x225252(0xc8)),_0x225252(0xac);return logger[_0x225252(0xc0)]({'response':_0x49c0aa},_0x225252(0x96)),_0x49c0aa;}catch(_0x187acb){return logger['error'](_0x187acb,_0x225252(0xba)),'I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.';}}