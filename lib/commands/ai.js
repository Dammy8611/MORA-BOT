const a0_0x5a100=a0_0x4a7a;(function(_0x2adf95,_0xe07e6e){const _0x2e47b5=a0_0x4a7a,_0x5e390d=_0x2adf95();while(!![]){try{const _0x3093c9=parseInt(_0x2e47b5(0x1db))/0x1*(-parseInt(_0x2e47b5(0x1c0))/0x2)+parseInt(_0x2e47b5(0x1a0))/0x3*(parseInt(_0x2e47b5(0x1af))/0x4)+parseInt(_0x2e47b5(0x196))/0x5*(-parseInt(_0x2e47b5(0x189))/0x6)+parseInt(_0x2e47b5(0x19b))/0x7*(parseInt(_0x2e47b5(0x1a2))/0x8)+parseInt(_0x2e47b5(0x1d0))/0x9*(parseInt(_0x2e47b5(0x1e4))/0xa)+parseInt(_0x2e47b5(0x1d7))/0xb*(parseInt(_0x2e47b5(0x192))/0xc)+-parseInt(_0x2e47b5(0x18a))/0xd;if(_0x3093c9===_0xe07e6e)break;else _0x5e390d['push'](_0x5e390d['shift']());}catch(_0x49660c){_0x5e390d['push'](_0x5e390d['shift']());}}}(a0_0x56c3,0x66e04));const {GoogleGenerativeAI}=require(a0_0x5a100(0x1bc)),{getCommandMap}=require(a0_0x5a100(0x1cb)),{executeAiCommand}=require(a0_0x5a100(0x19f)),{StatusUpdater}=require(a0_0x5a100(0x195)),{loadMemory,saveMemory}=require(a0_0x5a100(0x1c6)),lidToJid=require(a0_0x5a100(0x1b1)),normalizeMentions=require(a0_0x5a100(0x1e3)),logger={'info':(_0x280431,_0x8185d1)=>console[a0_0x5a100(0x1c1)]('[INFO]\x20'+_0x8185d1,_0x280431),'error':(_0x16de55,_0x209084)=>console[a0_0x5a100(0x1c5)](a0_0x5a100(0x1d8)+_0x209084,_0x16de55)},genAI=new GoogleGenerativeAI(a0_0x5a100(0x1b3));module[a0_0x5a100(0x1a9)]={'meta':{'name':'ai','description':a0_0x5a100(0x1aa),'usage':a0_0x5a100(0x183),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':'prompt','required':!![],'greedy':!![],'description':a0_0x5a100(0x1d6)}]},'run':async({m:_0xbee324,sock:_0x4624df,args:_0x159833,flags:_0x4bd2ab,executeCommand:_0x491e51,metadata:_0x2ed22c})=>{const _0x4a3f31=a0_0x5a100,_0x3e57d0=_0xbee324[_0x4a3f31(0x1a8)]['remoteJid'],_0x5c6e40=_0xbee324[_0x4a3f31(0x1a8)]['participant']||_0x3e57d0,_0x3d5bb9=_0xbee324['pushName']||null;let _0x97103c=[],_0x3db618=_0x159833[_0x4a3f31(0x184)];if(_0x3e57d0[_0x4a3f31(0x197)]('@g.us')&&_0xbee324[_0x4a3f31(0x18d)]?.[_0x4a3f31(0x19c)]?.[_0x4a3f31(0x1d9)]?.[_0x4a3f31(0x1d1)]){const _0x5cb3e1=_0xbee324[_0x4a3f31(0x18d)][_0x4a3f31(0x19c)][_0x4a3f31(0x1d9)][_0x4a3f31(0x1d1)];console[_0x4a3f31(0x1c1)](_0x4a3f31(0x1e0),_0x5cb3e1);const {normalizedText:_0x36f010,mentions:_0x20eef7}=await normalizeMentions(_0x3db618,_0x5cb3e1,_0x2ed22c,lidToJid);_0x3db618=_0x36f010,_0x97103c=_0x20eef7;}logger['info']({'user':_0xbee324[_0x4a3f31(0x1ab)],'prompt':_0x3db618},_0x4a3f31(0x1c7));const _0x4254ab=new StatusUpdater(_0x4624df,_0x3e57d0);await _0x4254ab['start']();try{const _0x39371b=await loadMemory(_0x3e57d0,_0x5c6e40);logger[_0x4a3f31(0x1c3)]({},'Entering\x20Thinking\x20Layer...'),await _0x4254ab[_0x4a3f31(0x19a)](_0x4a3f31(0x1cf));const _0x6c8537=await thinkingLayer(_0x3db618,_0x39371b,_0xbee324,_0x2ed22c);logger[_0x4a3f31(0x1c3)](_0x6c8537,_0x4a3f31(0x1a7)),logger['info']({'prompt':_0x3db618,'decision':_0x6c8537[_0x4a3f31(0x186)],'commandsToRun':_0x6c8537[_0x4a3f31(0x1b9)]},_0x4a3f31(0x193));let _0x1961fe=[];if(_0x6c8537[_0x4a3f31(0x1b9)]&&_0x6c8537[_0x4a3f31(0x1b9)][_0x4a3f31(0x187)]>0x0){logger[_0x4a3f31(0x1c3)]({'commands':_0x6c8537[_0x4a3f31(0x1b9)]},_0x4a3f31(0x18f)),await _0x4254ab[_0x4a3f31(0x19a)](_0x4a3f31(0x1a3)+_0x6c8537[_0x4a3f31(0x1b9)][_0x4a3f31(0x191)](',\x20')+_0x4a3f31(0x1b4));for(const _0x523d7b of _0x6c8537['commands']){logger[_0x4a3f31(0x1c3)]({'commandString':_0x523d7b},_0x4a3f31(0x1a4));const _0xd433db=_0x523d7b[_0x4a3f31(0x1dc)]()[_0x4a3f31(0x1c8)](/\s+/);_0xd433db[0x0]=_0xd433db[0x0][_0x4a3f31(0x199)](0x1);const _0x1d6018=_0xd433db[0x0],_0x224b70=await executeAiCommand({'m':_0xbee324,'sock':_0x4624df,'tokens':['!'+_0x1d6018,..._0xd433db[_0x4a3f31(0x199)](0x1)],'metadata':_0x2ed22c});_0x224b70&&_0x224b70[_0x4a3f31(0x1de)]!==_0x4a3f31(0x1d5)&&(logger[_0x4a3f31(0x1c3)]({'command':_0x1d6018,'type':_0x224b70['type']},_0x4a3f31(0x1ca)),await _0x4624df[_0x4a3f31(0x1da)](_0xbee324['key'][_0x4a3f31(0x1b6)],_0x224b70[_0x4a3f31(0x1b5)])),_0x1961fe[_0x4a3f31(0x182)]({'command':_0x1d6018,'type':_0x224b70['type'],'output':_0x224b70['placeholder']||_0x224b70[_0x4a3f31(0x1d5)]}),logger[_0x4a3f31(0x1c3)]({'command':_0x1d6018,'output':_0x224b70},'Command\x20execution\x20finished');}}else logger[_0x4a3f31(0x1c3)]({},'No\x20commands\x20to\x20execute.');logger['info']({},_0x4a3f31(0x1ae));const _0x763929={'prompt':_0x3db618,'decision':_0x6c8537[_0x4a3f31(0x186)],'commandOutputs':_0x1961fe};logger[_0x4a3f31(0x1c3)]({'context':_0x763929},_0x4a3f31(0x1ad));const _0x1d8efb=await remixLayer(_0x763929,_0xbee324);logger['info']({'finalResponse':_0x1d8efb},_0x4a3f31(0x188));const _0x1721c6=await extractJidsFromText(_0x1d8efb,_0x2ed22c),_0x1f1108=Array[_0x4a3f31(0x1a6)](new Set([..._0x97103c,..._0x1721c6]));await saveMemory(_0x3e57d0,_0x5c6e40,_0x3db618,_0x1d8efb,_0x3d5bb9,_0x1961fe,_0x1f1108),await _0x4254ab[_0x4a3f31(0x1bf)]({'text':_0x1d8efb,'mentions':_0x1f1108});}catch(_0x12e3d7){logger[_0x4a3f31(0x1c5)](_0x12e3d7,_0x4a3f31(0x1a5)),await _0x4254ab[_0x4a3f31(0x1bf)](_0x4a3f31(0x198));}}};function extractJidsFromText(_0x386c24,_0x2e4ae8){const _0x4138a5=a0_0x5a100,_0x483a22=/@[0-9]+/g,_0x4290fd=/[0-9]+@s\.whatsapp\.net/g,_0xb4cfd7=[..._0x386c24[_0x4138a5(0x1bd)](_0x483a22)||[],..._0x386c24[_0x4138a5(0x1bd)](_0x4290fd)||[]];return Promise['all'](_0xb4cfd7[_0x4138a5(0x1a1)](_0x4781ff=>lidToJid(_0x4781ff,_0x2e4ae8)));}async function thinkingLayer(_0x196315,_0x39d64c,_0x54151f,_0x516bbc){const _0x132a10=a0_0x5a100;logger[_0x132a10(0x1c3)]({'prompt':_0x196315},_0x132a10(0x1be));const _0x368935=genAI[_0x132a10(0x194)]({'model':_0x132a10(0x1c4)}),_0x183ef6=getCommandMap(),_0x410d9d=Array[_0x132a10(0x1a6)](_0x183ef6['values']())[_0x132a10(0x1df)](_0x97e866=>_0x97e866[_0x132a10(0x190)]['ai']!==![])[_0x132a10(0x1a1)](_0x26cbe8=>({'name':_0x26cbe8[_0x132a10(0x190)][_0x132a10(0x18c)],'description':_0x26cbe8[_0x132a10(0x190)][_0x132a10(0x18e)],'usage':_0x26cbe8[_0x132a10(0x190)][_0x132a10(0x1e1)],'direct':_0x26cbe8[_0x132a10(0x190)][_0x132a10(0x1ba)]||![],'args':(_0x26cbe8[_0x132a10(0x190)][_0x132a10(0x1b7)]||[])['map'](_0x1d04ed=>_0x1d04ed['name']+'\x20('+_0x1d04ed[_0x132a10(0x18e)]+')')[_0x132a10(0x191)](',\x20')})),_0x15015b='\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a'+JSON[_0x132a10(0x1e2)](_0x39d64c,null,0x2)+_0x132a10(0x1d2)+JSON['stringify'](_0x410d9d,null,0x2)+'\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a'+(_0x54151f['message'][_0x132a10(0x19c)]?.[_0x132a10(0x1d9)]?.['quotedMessage']?.[_0x132a10(0x1cd)]||'None')+_0x132a10(0x1ac)+_0x54151f['pushName']+_0x132a10(0x1dd)+(_0x54151f[_0x132a10(0x1a8)][_0x132a10(0x185)]||_0x54151f[_0x132a10(0x1a8)]['remoteJid'])+_0x132a10(0x1ce)+_0x196315+'\x22\x0a';try{const _0x1d2333=await _0x368935[_0x132a10(0x1b8)](_0x15015b),_0x52dc92=await _0x1d2333['response'][_0x132a10(0x1d5)](),_0x4a14a3=_0x52dc92[_0x132a10(0x1cc)](/```json/g,'')['replace'](/```/g,'')[_0x132a10(0x1dc)]();if(!_0x4a14a3['includes']('{'))return{'decision':_0x132a10(0x18b),'commands':[]};const _0x109229=JSON[_0x132a10(0x1d3)](_0x4a14a3);return{'decision':_0x109229['decision'],'commands':_0x109229['commands']||[]};}catch(_0x3f2955){return logger[_0x132a10(0x1c5)](_0x3f2955,_0x132a10(0x1b0)),{'decision':'There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','commands':[]};}}function a0_0x4a7a(_0x2b4245,_0x4795d9){const _0x56c318=a0_0x56c3();return a0_0x4a7a=function(_0x4a7aa3,_0x234206){_0x4a7aa3=_0x4a7aa3-0x182;let _0x5a177e=_0x56c318[_0x4a7aa3];return _0x5a177e;},a0_0x4a7a(_0x2b4245,_0x4795d9);}async function remixLayer(_0x2e2aa9,_0x187334){const _0x2c1dbb=a0_0x5a100;logger[_0x2c1dbb(0x1c3)]({'context':_0x2e2aa9},'Remix\x20Layer\x20received\x20context.');const _0x27e04d=genAI[_0x2c1dbb(0x194)]({'model':'gemini-2.5-flash'}),_0x681288=_0x2e2aa9[_0x2c1dbb(0x1b2)][_0x2c1dbb(0x1a1)](_0x41f89f=>'-\x20'+_0x41f89f['command']+':\x20'+_0x41f89f['output'])[_0x2c1dbb(0x191)]('\x0a'),_0x8f055d='\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22'+_0x2e2aa9[_0x2c1dbb(0x184)]+_0x2c1dbb(0x19e)+_0x2e2aa9[_0x2c1dbb(0x186)]+_0x2c1dbb(0x19d)+(_0x681288||_0x2c1dbb(0x1c9))+'\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20'+_0x187334[_0x2c1dbb(0x1ab)]+',\x20JID/ID:\x20'+(_0x187334['key'][_0x2c1dbb(0x185)]||_0x187334[_0x2c1dbb(0x1a8)][_0x2c1dbb(0x1b6)])+'\x0a';try{const _0x10ab1f=await _0x27e04d['generateContent'](_0x8f055d),_0x58b460=_0x10ab1f[_0x2c1dbb(0x1d4)][_0x2c1dbb(0x1d5)]()?.['trim']();return _0x58b460||_0x2c1dbb(0x1bb);}catch(_0x1aa036){return logger[_0x2c1dbb(0x1c5)](_0x1aa036,'Error\x20in\x20Remix\x20Layer'),_0x2c1dbb(0x1c2);}}function a0_0x56c3(){const _0x4239a4=['usage','stringify','../../utils/normalize.js','2360KUHSgD','push','.ai\x20<prompt>','prompt','participant','decision','length','Remix\x20Layer\x20finished','1292394GMKZsx','8557328UMKbEO','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do.','name','message','description','Entering\x20Command\x20Execution\x20phase','meta','join','1743684YjBokO','AI\x20Thinking\x20Layer\x20Processed','getGenerativeModel','../../utils/statusUpdater.js','5qAHRkL','endsWith','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20üòµ‚Äçüí´','slice','update','5299HWamcx','extendedTextMessage','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','../core/executeCommand','15qAFwiL','map','4760NQryCU','Running\x20command(s):\x20','Executing\x20command','AI\x20command\x20failed','from','Thinking\x20Layer\x20finished','key','exports','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','pushName','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x20Tell\x20this\x20to\x20your\x20next\x20layer\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x20because\x20you\x20are\x20the\x20brain\x20of\x20a\x20system\x20and\x20other\x20components\x20won\x27t\x20work\x20well\x20if\x20the\x20brain\x20provides\x20very\x20little\x20or\x20insufficient\x20information\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','Remix\x20Layer\x20context','Entering\x20Remix\x20Layer...','536108ZUbPcV','Error\x20in\x20Gemini\x20Thinking\x20Layer','../../utils/lidToJid.js','commandOutputs','AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo','...','raw','remoteJid','args','generateContent','commands','direct','Here\x20you\x20go\x20‚ú®','@google/generative-ai','match','Thinking\x20Layer\x20received\x20prompt.','done','104578kQqnGs','log','I\x27m\x20a\x20bit\x20flustered\x20rn\x20üòµ‚Äçüí´','info','gemini-2.5-flash','error','../memory.js','AI\x20command\x20invoked','split','None','Command\x20returned\x20media.\x20Sending\x20directly.','./index','replace','conversation','\x0a\x0aUser\x20Prompt:\x20\x22','ü§î\x20Thinking....','13518ceHULe','mentionedJid','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','parse','response','text','The\x20prompt\x20for\x20the\x20AI.','22pSRhUo','[ERROR]\x20','contextInfo','sendMessage','9VWuHQt','trim',',\x20JID/ID:\x20','type','filter','Raw\x20lids:'];a0_0x56c3=function(){return _0x4239a4;};return a0_0x56c3();}