const a0_0x4fdcd6=a0_0x3117;(function(_0x325472,_0x1a2c18){const _0x1d4db4=a0_0x3117,_0xd90330=_0x325472();while(!![]){try{const _0xaef7f6=parseInt(_0x1d4db4(0x1d3))/0x1+parseInt(_0x1d4db4(0x230))/0x2*(parseInt(_0x1d4db4(0x1f7))/0x3)+-parseInt(_0x1d4db4(0x1e5))/0x4*(-parseInt(_0x1d4db4(0x223))/0x5)+parseInt(_0x1d4db4(0x20d))/0x6+-parseInt(_0x1d4db4(0x1d7))/0x7+-parseInt(_0x1d4db4(0x1c9))/0x8*(-parseInt(_0x1d4db4(0x22c))/0x9)+parseInt(_0x1d4db4(0x220))/0xa*(-parseInt(_0x1d4db4(0x21a))/0xb);if(_0xaef7f6===_0x1a2c18)break;else _0xd90330['push'](_0xd90330['shift']());}catch(_0x14f5b9){_0xd90330['push'](_0xd90330['shift']());}}}(a0_0x2ded,0x27b96));const {GoogleGenerativeAI}=require(a0_0x4fdcd6(0x22a)),{getCommandMap}=require(a0_0x4fdcd6(0x20b)),{executeAiCommand}=require(a0_0x4fdcd6(0x219)),{StatusUpdater}=require(a0_0x4fdcd6(0x213)),{loadMemory,saveMemory}=require('../memory.js'),logger={'info':(_0x1894f2,_0x2a5c70)=>console[a0_0x4fdcd6(0x214)]('[INFO]\x20'+_0x2a5c70,_0x1894f2),'error':(_0xc13060,_0x19f51e)=>console[a0_0x4fdcd6(0x21f)](a0_0x4fdcd6(0x229)+_0x19f51e,_0xc13060)},genAI=new GoogleGenerativeAI(a0_0x4fdcd6(0x1ff));module['exports']={'meta':{'name':'ai','description':a0_0x4fdcd6(0x1fe),'usage':a0_0x4fdcd6(0x20e),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x4fdcd6(0x1eb),'required':!![],'greedy':!![],'description':a0_0x4fdcd6(0x201)}]},'run':async({m:_0x3296c2,sock:_0x5b1dc7,args:_0x22a460,flags:_0x2dadbd,executeCommand:_0x4fc47c,metadata:_0x16fc4f})=>{const _0x385d51=a0_0x4fdcd6,_0x3cf4dd=_0x3296c2[_0x385d51(0x217)]['remoteJid'],_0x4d8b29=_0x3296c2['key'][_0x385d51(0x1f2)]||_0x3cf4dd,_0x8f6baa=_0x3296c2['pushName']||null,_0x2eda02=_0x22a460[_0x385d51(0x1eb)];logger[_0x385d51(0x205)]({'user':_0x3296c2['pushName'],'prompt':_0x2eda02},_0x385d51(0x22e));const _0x57153e=new StatusUpdater(_0x5b1dc7,_0x3cf4dd);await _0x57153e[_0x385d51(0x1c6)]();try{const _0x2651bb=await loadMemory(_0x3cf4dd,_0x4d8b29);logger[_0x385d51(0x205)]({},_0x385d51(0x21b)),await _0x57153e[_0x385d51(0x1cc)](_0x385d51(0x1d8));const _0x4bd04d=await thinkingLayer(_0x2eda02,_0x2651bb,_0x3296c2,_0x16fc4f);logger[_0x385d51(0x205)](_0x4bd04d,_0x385d51(0x1f0)),logger['info']({'prompt':_0x2eda02,'decision':_0x4bd04d[_0x385d51(0x216)],'commandsToRun':_0x4bd04d['commands']},_0x385d51(0x1d6));let _0x59c268=[];if(_0x4bd04d[_0x385d51(0x1e4)]&&_0x4bd04d[_0x385d51(0x1e4)][_0x385d51(0x206)]>0x0){logger[_0x385d51(0x205)]({'commands':_0x4bd04d['commands']},_0x385d51(0x1ca)),await _0x57153e[_0x385d51(0x1cc)](_0x385d51(0x209)+_0x4bd04d[_0x385d51(0x1e4)][_0x385d51(0x22d)](',\x20')+_0x385d51(0x1f8));for(const _0x3d4e13 of _0x4bd04d['commands']){logger[_0x385d51(0x205)]({'commandString':_0x3d4e13},'Executing\x20command');const _0xa5803d=_0x3d4e13[_0x385d51(0x1e7)]()['split'](/\s+/);_0xa5803d[0x0]=_0xa5803d[0x0][_0x385d51(0x1c8)](0x1);const _0x3dce2c=_0xa5803d[0x0],_0x1b2906=await executeAiCommand({'m':_0x3296c2,'sock':_0x5b1dc7,'tokens':['!'+_0x3dce2c,..._0xa5803d[_0x385d51(0x1c8)](0x1)],'metadata':_0x16fc4f});if(_0x1b2906&&!_0x1b2906[_0x385d51(0x20a)]){logger[_0x385d51(0x205)]({'command':_0x3dce2c,'content':_0x1b2906},_0x385d51(0x1dd)),await _0x57153e['done'](_0x385d51(0x224)),await _0x5b1dc7[_0x385d51(0x227)](_0x3296c2[_0x385d51(0x217)][_0x385d51(0x1da)],_0x1b2906),_0x59c268[_0x385d51(0x22f)]({'command':_0x3dce2c,'output':'[Sent\x20a\x20file:\x20'+(_0x1b2906[_0x385d51(0x1d5)]?_0x385d51(0x1d5):'unknown')+']','isDirect':!![]});continue;}const _0x20c749=_0x1b2906?_0x1b2906[_0x385d51(0x20a)]:_0x385d51(0x21d);_0x59c268['push']({'command':_0x3dce2c,'output':_0x20c749}),logger['info']({'command':_0x3dce2c,'output':_0x20c749},_0x385d51(0x212));}}else logger[_0x385d51(0x205)]({},_0x385d51(0x1c7));if(_0x59c268['length']>0x0&&_0x59c268[_0x385d51(0x221)](_0x495561=>_0x495561[_0x385d51(0x1d0)])){logger['info']({},_0x385d51(0x1e8));return;}logger[_0x385d51(0x205)]({},_0x385d51(0x215));const _0x35c46d={'prompt':_0x2eda02,'decision':_0x4bd04d[_0x385d51(0x216)],'commandOutputs':_0x59c268};logger['info']({'context':_0x35c46d},_0x385d51(0x1e2));const _0xd639a8=await remixLayer(_0x35c46d);logger['info']({'finalResponse':_0xd639a8},_0x385d51(0x222)),await saveMemory(_0x3cf4dd,_0x4d8b29,_0x2eda02,_0xd639a8,_0x8f6baa,_0x59c268),await _0x57153e[_0x385d51(0x224)](_0xd639a8);}catch(_0x885d9){logger['error'](_0x885d9,_0x385d51(0x1ce)),await _0x57153e[_0x385d51(0x224)](_0x385d51(0x1f3));}}};function a0_0x3117(_0x599e69,_0x474da2){const _0x2ded60=a0_0x2ded();return a0_0x3117=function(_0x3117d6,_0x4f95ed){_0x3117d6=_0x3117d6-0x1c6;let _0x2f5a7d=_0x2ded60[_0x3117d6];return _0x2f5a7d;},a0_0x3117(_0x599e69,_0x474da2);}function a0_0x2ded(){const _0x2124c7=['response','Running\x20command(s):\x20','text','./index','map','1235016GivwEh','.ai\x20<prompt>','None','quotedMessage','contextInfo','Command\x20execution\x20finished','../../utils/statusUpdater.js','log','Entering\x20Remix\x20Layer...','decision','key','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','../core/executeCommand','11XjdsNx','Entering\x20Thinking\x20Layer...','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','No\x20textual\x20output.','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly\x0a\x0aUser\x20Prompt:\x20\x22','error','7096010fpbrUQ','every','Remix\x20Layer\x20finished','35hxEoqA','done','filter','output','sendMessage','meta','[ERROR]\x20','@google/generative-ai','command','100008oufoBM','join','AI\x20command\x20invoked','push','2GOElOK','getGenerativeModel','start','No\x20commands\x20to\x20execute.','slice','232FkOiTZ','Entering\x20Command\x20Execution\x20phase','from','update','Remix\x20layer\x20returned\x20empty\x20text','AI\x20command\x20failed','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','isDirect','extendedTextMessage','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','17190FRJDsX','parse','audio','AI\x20Thinking\x20Layer\x20Processed','447797zfCkDU','ðŸ¤”\x20Thinking....','Generated\x20callable\x20command\x20list\x20for\x20AI','remoteJid','description','stringify','Command\x20returned\x20a\x20file.\x20Sending\x20directly.','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','usage','replace','name','Remix\x20Layer\x20context','gemini-2.5-pro','commands','113036LCxgVC','Remix\x20Layer\x20received\x20context.','trim','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','Gotcha,\x20all\x20commands\x20handled.\x20âœ¨','prompt','commandOutputs','Sending\x20system\x20prompt\x20to\x20Gemini','I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a','Thinking\x20Layer\x20finished','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','participant','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20ðŸ˜µâ€ðŸ’«','Received\x20final\x20response\x20from\x20Gemini.','args','message','579585bpFmnv','...','Error\x20in\x20Gemini\x20Thinking\x20Layer','direct','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','Cleaned\x20Gemini\x20response','conversation','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','The\x20prompt\x20for\x20the\x20AI.','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','generateContent','Received\x20response\x20from\x20Gemini','info','length','values'];a0_0x2ded=function(){return _0x2124c7;};return a0_0x2ded();}async function thinkingLayer(_0x40cb74,_0x303862,_0xe0a2ba,_0x24aaca){const _0x50db44=a0_0x4fdcd6;logger['info']({'prompt':_0x40cb74},'Thinking\x20Layer\x20received\x20prompt.');const _0x25dfe9=genAI[_0x50db44(0x231)]({'model':_0x50db44(0x1e3)}),_0x26086c=getCommandMap(),_0x25601b=Array[_0x50db44(0x1cb)](_0x26086c[_0x50db44(0x207)]())['filter'](_0x3176ef=>_0x3176ef[_0x50db44(0x228)]['ai']!==![])[_0x50db44(0x20c)](_0x191541=>({'name':_0x191541[_0x50db44(0x228)][_0x50db44(0x1e1)],'description':_0x191541[_0x50db44(0x228)][_0x50db44(0x1db)],'usage':_0x191541[_0x50db44(0x228)][_0x50db44(0x1df)],'direct':_0x191541[_0x50db44(0x228)][_0x50db44(0x1fa)]||![],'args':(_0x191541[_0x50db44(0x228)][_0x50db44(0x1f5)]||[])[_0x50db44(0x20c)](_0x1ac4de=>_0x1ac4de['name']+'\x20('+_0x1ac4de['description']+')')[_0x50db44(0x22d)](',\x20')}));logger[_0x50db44(0x205)]({'count':_0x25601b[_0x50db44(0x206)]},_0x50db44(0x1d9));const _0x3eef47=_0x50db44(0x200)+JSON[_0x50db44(0x1dc)](_0x303862,null,0x2)+_0x50db44(0x1de)+JSON[_0x50db44(0x1dc)](_0x25601b,null,0x2)+_0x50db44(0x202)+(_0xe0a2ba[_0x50db44(0x1f6)][_0x50db44(0x1d1)]?.[_0x50db44(0x211)]?.[_0x50db44(0x210)]?.[_0x50db44(0x1fd)]||'None')+_0x50db44(0x21e)+_0x40cb74+'\x22\x0a';logger[_0x50db44(0x205)](_0x50db44(0x1ed));try{const _0x2eac82=await _0x25dfe9['generateContent'](_0x3eef47),_0x475be7=await _0x2eac82[_0x50db44(0x208)][_0x50db44(0x20a)]();logger[_0x50db44(0x205)]({'responseText':_0x475be7},_0x50db44(0x204));const _0x16641d=_0x475be7[_0x50db44(0x1e0)](/```json/g,'')[_0x50db44(0x1e0)](/```/g,'')[_0x50db44(0x1e7)]();logger[_0x50db44(0x205)]({'cleanedText':_0x16641d},_0x50db44(0x1fc));if(!_0x16641d||!_0x16641d['includes']('{')||!_0x16641d['includes']('}'))return logger['error']({'cleanedText':_0x16641d},_0x50db44(0x1e9)),{'decision':_0x50db44(0x1f1),'commands':[]};const _0x34333f=JSON[_0x50db44(0x1d4)](_0x16641d);logger[_0x50db44(0x205)]({'jsonResponse':_0x34333f},'Parsed\x20JSON\x20response');const _0x45381c={'decision':_0x34333f[_0x50db44(0x216)],'commands':_0x34333f['commands']||[]};return logger[_0x50db44(0x205)]({'thinkingResult':_0x45381c},'Returning\x20from\x20Thinking\x20Layer'),_0x45381c;}catch(_0x5b0bf9){return logger['error'](_0x5b0bf9,_0x50db44(0x1f9)),{'decision':_0x50db44(0x1d2),'commands':[]};}}async function remixLayer(_0x50db36){const _0x4b275e=a0_0x4fdcd6;logger[_0x4b275e(0x205)]({'context':_0x50db36},_0x4b275e(0x1e6));const _0x1b44a2=genAI['getGenerativeModel']({'model':_0x4b275e(0x1e3)}),_0x5921e3=_0x50db36['commandOutputs'][_0x4b275e(0x225)](_0x3cbe13=>!_0x3cbe13[_0x4b275e(0x1d0)]);if(_0x5921e3[_0x4b275e(0x206)]===0x0&&_0x50db36[_0x4b275e(0x1ec)]['length']>0x0)return logger[_0x4b275e(0x205)]({},'All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.'),_0x4b275e(0x1ea);const _0x4093dc=_0x4b275e(0x1fb)+_0x50db36[_0x4b275e(0x1eb)]+_0x4b275e(0x218)+_0x50db36[_0x4b275e(0x216)]+_0x4b275e(0x21c)+(_0x5921e3['map'](_0x568ddf=>'-\x20'+_0x568ddf[_0x4b275e(0x22b)]+':\x20'+_0x568ddf[_0x4b275e(0x226)])['join']('\x0a')||_0x4b275e(0x20f))+_0x4b275e(0x1ef);logger['info'](_0x4b275e(0x1cf));try{const _0x10be16=await _0x1b44a2[_0x4b275e(0x203)](_0x4093dc),_0x3c4aa8=await _0x10be16[_0x4b275e(0x208)],_0x32c84b=_0x3c4aa8[_0x4b275e(0x20a)]()?.[_0x4b275e(0x1e7)]();if(!_0x32c84b)return logger[_0x4b275e(0x21f)]({},_0x4b275e(0x1cd)),'Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20ðŸ¤¯';return logger[_0x4b275e(0x205)]({'response':_0x32c84b},_0x4b275e(0x1f4)),_0x32c84b;}catch(_0x1cfb70){return logger[_0x4b275e(0x21f)](_0x1cfb70,'Error\x20in\x20Gemini\x20Remix\x20Layer'),_0x4b275e(0x1ee);}}