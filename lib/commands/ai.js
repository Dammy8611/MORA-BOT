const a0_0x3e4baa=a0_0x516c;function a0_0x5b6e(){const _0x1448ae=['Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','Command\x20execution\x20finished','...','Entering\x20Command\x20Execution\x20phase','includes','../core/executeCommand','split','8QhzwfJ','Entering\x20Remix\x20Layer...','6903995tUAzwX','Received\x20response\x20from\x20Gemini','length','4JoIyeY','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a','map','sendMessage','filter','Command\x20returned\x20a\x20file.\x20Sending\x20directly.','participant','output','None','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','Remix\x20layer\x20returned\x20empty\x20text','AI\x20command\x20invoked','unknown','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','🤔\x20Thinking....','stringify','Parsed\x20JSON\x20response','values','update','1056047clNOUp','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','audio','.ai\x20<prompt>','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20😵‍💫','commandOutputs','meta','Gotcha,\x20all\x20commands\x20handled.\x20✨','trim','message','[Sent\x20a\x20file:\x20','Returning\x20from\x20Thinking\x20Layer','../../utils/statusUpdater.js','exports','Thinking\x20Layer\x20received\x20prompt.','decision','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','done','from','prompt','[INFO]\x20','Entering\x20Thinking\x20Layer...','97011JZAUTj','commands','[ERROR]\x20','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.','Running\x20command(s):\x20','error','Remix\x20Layer\x20received\x20context.','contextInfo','join','remoteJid','6idxwka','AI\x20command\x20failed','getGenerativeModel','key','description','3250780XxuedG','slice','direct','AI\x20Thinking\x20Layer\x20Processed','push','replace','info','Error\x20in\x20Gemini\x20Remix\x20Layer','text','I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.','usage','Executing\x20command','13107070fJKVDr','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','conversation','Sending\x20system\x20prompt\x20to\x20Gemini','log','isDirect','Remix\x20Layer\x20context','Received\x20final\x20response\x20from\x20Gemini.','3286230eAQwbj','Generated\x20callable\x20command\x20list\x20for\x20AI','name','No\x20textual\x20output.','../memory.js','8759610CFUPfm','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','No\x20commands\x20to\x20execute.','AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI','pushName','response','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly\x0a\x0aUser\x20Prompt:\x20\x22','generateContent','gemini-2.5-pro','Error\x20in\x20Gemini\x20Thinking\x20Layer'];a0_0x5b6e=function(){return _0x1448ae;};return a0_0x5b6e();}function a0_0x516c(_0xd6abc6,_0x37fea6){const _0x5b6e23=a0_0x5b6e();return a0_0x516c=function(_0x516c3d,_0x441360){_0x516c3d=_0x516c3d-0x1a0;let _0x37ba80=_0x5b6e23[_0x516c3d];return _0x37ba80;},a0_0x516c(_0xd6abc6,_0x37fea6);}(function(_0x32840a,_0x3eb130){const _0x16e3ed=a0_0x516c,_0x44ad5c=_0x32840a();while(!![]){try{const _0x1ad8dd=-parseInt(_0x16e3ed(0x1bf))/0x1+-parseInt(_0x16e3ed(0x1ac))/0x2*(parseInt(_0x16e3ed(0x1d5))/0x3)+-parseInt(_0x16e3ed(0x1e5))/0x4+-parseInt(_0x16e3ed(0x1f9))/0x5*(parseInt(_0x16e3ed(0x1e0))/0x6)+parseInt(_0x16e3ed(0x1a9))/0x7+parseInt(_0x16e3ed(0x1a7))/0x8*(parseInt(_0x16e3ed(0x1fe))/0x9)+parseInt(_0x16e3ed(0x1f1))/0xa;if(_0x1ad8dd===_0x3eb130)break;else _0x44ad5c['push'](_0x44ad5c['shift']());}catch(_0x16b060){_0x44ad5c['push'](_0x44ad5c['shift']());}}}(a0_0x5b6e,0xa5ec4));const {GoogleGenerativeAI}=require('@google/generative-ai'),{getCommandMap}=require('./index'),{executeAiCommand}=require(a0_0x3e4baa(0x1a5)),{StatusUpdater}=require(a0_0x3e4baa(0x1cb)),{loadMemory,saveMemory}=require(a0_0x3e4baa(0x1fd)),logger={'info':(_0x39d4e4,_0x13f576)=>console[a0_0x3e4baa(0x1f5)](a0_0x3e4baa(0x1d3)+_0x13f576,_0x39d4e4),'error':(_0x4b0fe6,_0x48501e)=>console[a0_0x3e4baa(0x1db)](a0_0x3e4baa(0x1d7)+_0x48501e,_0x4b0fe6)},genAI=new GoogleGenerativeAI(a0_0x3e4baa(0x201));module[a0_0x3e4baa(0x1cc)]={'meta':{'name':'ai','description':'A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','usage':a0_0x3e4baa(0x1c2),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x3e4baa(0x1d2),'required':!![],'greedy':!![],'description':'The\x20prompt\x20for\x20the\x20AI.'}]},'run':async({m:_0x347daf,sock:_0x3fbbbc,args:_0x3614af,flags:_0x1ced6e,executeCommand:_0x20a093,metadata:_0x460204})=>{const _0x32ddde=a0_0x3e4baa,_0x3062a9=_0x347daf[_0x32ddde(0x1e3)][_0x32ddde(0x1df)],_0x20e006=_0x347daf[_0x32ddde(0x1e3)][_0x32ddde(0x1b2)]||_0x3062a9,_0x2829da=_0x347daf[_0x32ddde(0x202)]||null,_0x280008=_0x3614af[_0x32ddde(0x1d2)];logger[_0x32ddde(0x1eb)]({'user':_0x347daf[_0x32ddde(0x202)],'prompt':_0x280008},_0x32ddde(0x1b7));const _0x311e88=new StatusUpdater(_0x3fbbbc,_0x3062a9);await _0x311e88['start']();try{const _0x1bda91=await loadMemory(_0x3062a9,_0x20e006);logger['info']({},_0x32ddde(0x1d4)),await _0x311e88[_0x32ddde(0x1be)](_0x32ddde(0x1ba));const _0x3fd221=await thinkingLayer(_0x280008,_0x1bda91,_0x347daf,_0x460204);logger['info'](_0x3fd221,'Thinking\x20Layer\x20finished'),logger[_0x32ddde(0x1eb)]({'prompt':_0x280008,'decision':_0x3fd221[_0x32ddde(0x1ce)],'commandsToRun':_0x3fd221[_0x32ddde(0x1d6)]},_0x32ddde(0x1e8));let _0x374eff=[];if(_0x3fd221['commands']&&_0x3fd221['commands']['length']>0x0){logger['info']({'commands':_0x3fd221[_0x32ddde(0x1d6)]},_0x32ddde(0x1a3)),await _0x311e88[_0x32ddde(0x1be)](_0x32ddde(0x1da)+_0x3fd221[_0x32ddde(0x1d6)][_0x32ddde(0x1de)](',\x20')+_0x32ddde(0x1a2));for(const _0x63827b of _0x3fd221[_0x32ddde(0x1d6)]){logger[_0x32ddde(0x1eb)]({'commandString':_0x63827b},_0x32ddde(0x1f0));const _0x410a53=_0x63827b[_0x32ddde(0x1c7)]()[_0x32ddde(0x1a6)](/\s+/);_0x410a53[0x0]=_0x410a53[0x0][_0x32ddde(0x1e6)](0x1);const _0x5b8360=_0x410a53[0x0],_0x2089f0=await executeAiCommand({'m':_0x347daf,'sock':_0x3fbbbc,'tokens':['!'+_0x5b8360,..._0x410a53[_0x32ddde(0x1e6)](0x1)],'metadata':_0x460204});if(_0x2089f0&&!_0x2089f0['text']){logger[_0x32ddde(0x1eb)]({'command':_0x5b8360,'content':_0x2089f0},_0x32ddde(0x1b1)),await _0x311e88[_0x32ddde(0x1d0)](_0x32ddde(0x1d0)),await _0x3fbbbc[_0x32ddde(0x1af)](_0x347daf[_0x32ddde(0x1e3)][_0x32ddde(0x1df)],_0x2089f0),_0x374eff['push']({'command':_0x5b8360,'output':_0x32ddde(0x1c9)+(_0x2089f0['audio']?_0x32ddde(0x1c1):_0x32ddde(0x1b8))+']','isDirect':!![]});continue;}const _0x3a39d1=_0x2089f0?_0x2089f0[_0x32ddde(0x1ed)]:_0x32ddde(0x1fc);_0x374eff[_0x32ddde(0x1e9)]({'command':_0x5b8360,'output':_0x3a39d1}),logger['info']({'command':_0x5b8360,'output':_0x3a39d1},_0x32ddde(0x1a1));}}else logger[_0x32ddde(0x1eb)]({},_0x32ddde(0x200));if(_0x374eff[_0x32ddde(0x1ab)]>0x0&&_0x374eff['every'](_0x2b5fcb=>_0x2b5fcb['isDirect'])){logger[_0x32ddde(0x1eb)]({},_0x32ddde(0x1b9));return;}logger[_0x32ddde(0x1eb)]({},_0x32ddde(0x1a8));const _0x3bebd5={'prompt':_0x280008,'decision':_0x3fd221[_0x32ddde(0x1ce)],'commandOutputs':_0x374eff};logger[_0x32ddde(0x1eb)]({'context':_0x3bebd5},_0x32ddde(0x1f7));const _0x1c35be=await remixLayer(_0x3bebd5);logger['info']({'finalResponse':_0x1c35be},'Remix\x20Layer\x20finished'),await saveMemory(_0x3062a9,_0x20e006,_0x280008,_0x1c35be,_0x2829da,_0x374eff),await _0x311e88['done'](_0x1c35be);}catch(_0x54d9d1){logger[_0x32ddde(0x1db)](_0x54d9d1,_0x32ddde(0x1e1)),await _0x311e88[_0x32ddde(0x1d0)](_0x32ddde(0x1c3));}}};async function thinkingLayer(_0x254951,_0xc87a7f,_0x2e46e3,_0x3bd4de){const _0x1bc81b=a0_0x3e4baa;logger[_0x1bc81b(0x1eb)]({'prompt':_0x254951},_0x1bc81b(0x1cd));const _0x55f0a4=genAI['getGenerativeModel']({'model':_0x1bc81b(0x206)}),_0x383a2c=getCommandMap(),_0x503c46=Array[_0x1bc81b(0x1d1)](_0x383a2c[_0x1bc81b(0x1bd)]())[_0x1bc81b(0x1b0)](_0xb2ccd3=>_0xb2ccd3['meta']['ai']!==![])[_0x1bc81b(0x1ae)](_0x29231f=>({'name':_0x29231f[_0x1bc81b(0x1c5)][_0x1bc81b(0x1fb)],'description':_0x29231f[_0x1bc81b(0x1c5)][_0x1bc81b(0x1e4)],'usage':_0x29231f[_0x1bc81b(0x1c5)][_0x1bc81b(0x1ef)],'direct':_0x29231f['meta'][_0x1bc81b(0x1e7)]||![],'args':(_0x29231f[_0x1bc81b(0x1c5)]['args']||[])['map'](_0xed41ce=>_0xed41ce['name']+'\x20('+_0xed41ce['description']+')')['join'](',\x20')}));logger[_0x1bc81b(0x1eb)]({'count':_0x503c46[_0x1bc81b(0x1ab)]},_0x1bc81b(0x1fa));const _0xaee3b=_0x1bc81b(0x1f2)+JSON['stringify'](_0xc87a7f,null,0x2)+'\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a'+JSON[_0x1bc81b(0x1bb)](_0x503c46,null,0x2)+'\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a'+(_0x2e46e3[_0x1bc81b(0x1c8)]['extendedTextMessage']?.[_0x1bc81b(0x1dd)]?.['quotedMessage']?.[_0x1bc81b(0x1f3)]||_0x1bc81b(0x1b4))+_0x1bc81b(0x204)+_0x254951+'\x22\x0a';logger['info'](_0x1bc81b(0x1f4));try{const _0x578762=await _0x55f0a4[_0x1bc81b(0x205)](_0xaee3b),_0x5dc3aa=await _0x578762[_0x1bc81b(0x203)][_0x1bc81b(0x1ed)]();logger[_0x1bc81b(0x1eb)]({'responseText':_0x5dc3aa},_0x1bc81b(0x1aa));const _0x315535=_0x5dc3aa['replace'](/```json/g,'')[_0x1bc81b(0x1ea)](/```/g,'')[_0x1bc81b(0x1c7)]();logger[_0x1bc81b(0x1eb)]({'cleanedText':_0x315535},'Cleaned\x20Gemini\x20response');if(!_0x315535||!_0x315535[_0x1bc81b(0x1a4)]('{')||!_0x315535['includes']('}'))return logger['error']({'cleanedText':_0x315535},_0x1bc81b(0x1a0)),{'decision':_0x1bc81b(0x1ff),'commands':[]};const _0x1b5175=JSON['parse'](_0x315535);logger[_0x1bc81b(0x1eb)]({'jsonResponse':_0x1b5175},_0x1bc81b(0x1bc));const _0x2f5102={'decision':_0x1b5175[_0x1bc81b(0x1ce)],'commands':_0x1b5175[_0x1bc81b(0x1d6)]||[]};return logger['info']({'thinkingResult':_0x2f5102},_0x1bc81b(0x1ca)),_0x2f5102;}catch(_0xcf84f0){return logger['error'](_0xcf84f0,_0x1bc81b(0x207)),{'decision':_0x1bc81b(0x1c0),'commands':[]};}}async function remixLayer(_0xd14466){const _0x59d7b4=a0_0x3e4baa;logger[_0x59d7b4(0x1eb)]({'context':_0xd14466},_0x59d7b4(0x1dc));const _0x36518f=genAI[_0x59d7b4(0x1e2)]({'model':_0x59d7b4(0x206)}),_0x6a4da8=_0xd14466[_0x59d7b4(0x1c4)]['filter'](_0x1ba2ec=>!_0x1ba2ec[_0x59d7b4(0x1f6)]);if(_0x6a4da8[_0x59d7b4(0x1ab)]===0x0&&_0xd14466[_0x59d7b4(0x1c4)]['length']>0x0)return logger[_0x59d7b4(0x1eb)]({},_0x59d7b4(0x1d9)),_0x59d7b4(0x1c6);const _0xf65b3c=_0x59d7b4(0x1d8)+_0xd14466[_0x59d7b4(0x1d2)]+_0x59d7b4(0x1cf)+_0xd14466[_0x59d7b4(0x1ce)]+'\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a'+(_0x6a4da8['map'](_0x371989=>'-\x20'+_0x371989['command']+':\x20'+_0x371989[_0x59d7b4(0x1b3)])['join']('\x0a')||_0x59d7b4(0x1b4))+_0x59d7b4(0x1ad);logger['info'](_0x59d7b4(0x1b5));try{const _0x50cd99=await _0x36518f[_0x59d7b4(0x205)](_0xf65b3c),_0x1229cd=await _0x50cd99['response'],_0x49ef6a=_0x1229cd[_0x59d7b4(0x1ed)]()?.[_0x59d7b4(0x1c7)]();if(!_0x49ef6a)return logger[_0x59d7b4(0x1db)]({},_0x59d7b4(0x1b6)),'Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20🤯';return logger[_0x59d7b4(0x1eb)]({'response':_0x49ef6a},_0x59d7b4(0x1f8)),_0x49ef6a;}catch(_0x338fb9){return logger[_0x59d7b4(0x1db)](_0x338fb9,_0x59d7b4(0x1ec)),_0x59d7b4(0x1ee);}}