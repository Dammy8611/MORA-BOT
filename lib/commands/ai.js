function a0_0x9e42(_0x4b51db,_0x563084){const _0x55179d=a0_0x5517();return a0_0x9e42=function(_0x9e4247,_0x4b7b3f){_0x9e4247=_0x9e4247-0xf4;let _0x11b970=_0x55179d[_0x9e4247];return _0x11b970;},a0_0x9e42(_0x4b51db,_0x563084);}const a0_0x2f54bc=a0_0x9e42;(function(_0x2590cb,_0x521f98){const _0x5414b1=a0_0x9e42,_0x3a140f=_0x2590cb();while(!![]){try{const _0x58a0d0=parseInt(_0x5414b1(0x152))/0x1+parseInt(_0x5414b1(0x14a))/0x2+parseInt(_0x5414b1(0x142))/0x3+-parseInt(_0x5414b1(0x10b))/0x4*(parseInt(_0x5414b1(0x14f))/0x5)+-parseInt(_0x5414b1(0x144))/0x6*(parseInt(_0x5414b1(0x11c))/0x7)+parseInt(_0x5414b1(0x106))/0x8*(parseInt(_0x5414b1(0x111))/0x9)+parseInt(_0x5414b1(0x108))/0xa*(-parseInt(_0x5414b1(0x138))/0xb);if(_0x58a0d0===_0x521f98)break;else _0x3a140f['push'](_0x3a140f['shift']());}catch(_0x2431ed){_0x3a140f['push'](_0x3a140f['shift']());}}}(a0_0x5517,0x87b52));const {GoogleGenerativeAI}=require(a0_0x2f54bc(0x148)),{getCommandMap}=require(a0_0x2f54bc(0x137)),{executeAiCommand}=require(a0_0x2f54bc(0xf4)),{StatusUpdater}=require(a0_0x2f54bc(0x107)),{loadMemory,saveMemory}=require('../memory.js'),lidToJid=require(a0_0x2f54bc(0x135)),normalizeMentions=require('../../utils/normalize.js'),logger={'info':(_0x893096,_0x2fc144)=>console[a0_0x2f54bc(0x109)](a0_0x2f54bc(0x13a)+_0x2fc144,_0x893096),'error':(_0x4ca887,_0x26570b)=>console['error'](a0_0x2f54bc(0x132)+_0x26570b,_0x4ca887)},genAI=new GoogleGenerativeAI('AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo');function a0_0x5517(){const _0x1abb16=['direct','\x0a\x0aUser\x20Prompt:\x20\x22','update','key','commands','Error\x20in\x20Gemini\x20Thinking\x20Layer','prompt','Command\x20returned\x20media.\x20Sending\x20directly.','AI\x20command\x20invoked','exports','633112DNLmgI','../../utils/statusUpdater.js','10lAcUjI','log','filter','20sXSOXM','quotedMessage','replace','all','Raw\x20lids:','extendedTextMessage','27bCkFkk','AI\x20Thinking\x20Layer\x20Processed','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','participant','stringify','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','raw','generateContent','slice','split','type','119ktmeSC','getGenerativeModel','Remix\x20Layer\x20finished','output','trim','Thinking\x20Layer\x20received\x20prompt.','message','info','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x20Tell\x20this\x20to\x20your\x20next\x20layer\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x20because\x20you\x20are\x20the\x20brain\x20of\x20a\x20system\x20and\x20other\x20components\x20won\x27t\x20work\x20well\x20if\x20the\x20brain\x20provides\x20very\x20little\x20or\x20insufficient\x20information\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','Executing\x20command','None','No\x20commands\x20to\x20execute.','Command\x20execution\x20finished','remoteJid','length','🤔\x20Thinking....','Thinking\x20Layer\x20finished','@g.us','decision','join','parse','endsWith','[ERROR]\x20','Entering\x20Remix\x20Layer...','contextInfo','../../utils/lidToJid.js','command','./index','6558827qWZOvs','Entering\x20Command\x20Execution\x20phase','[INFO]\x20','error','...','sendMessage','push','.ai\x20<prompt>','map','description','1813161aZElgW','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','9462PjlRJv','meta','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20😵‍💫','done','@google/generative-ai','conversation','1375544JTboww','includes','values','response','pushName','978415LbOSGE','from','mentionedJid','627763oDqDpK','../core/executeCommand','match','gemini-2.5-flash','AI\x20command\x20failed','Entering\x20Thinking\x20Layer...','usage','name','text'];a0_0x5517=function(){return _0x1abb16;};return a0_0x5517();}module[a0_0x2f54bc(0x105)]={'meta':{'name':'ai','description':a0_0x2f54bc(0x143),'usage':a0_0x2f54bc(0x13f),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0x2f54bc(0x102),'required':!![],'greedy':!![],'description':'The\x20prompt\x20for\x20the\x20AI.'}]},'run':async({m:_0xc1946c,sock:_0x1e2077,args:_0x17806d,flags:_0x1dd57d,executeCommand:_0x44a373,metadata:_0x16435e})=>{const _0x5eed16=a0_0x2f54bc,_0x27a790=_0xc1946c[_0x5eed16(0xff)][_0x5eed16(0x129)],_0xe102a0=_0xc1946c[_0x5eed16(0xff)][_0x5eed16(0x114)]||_0x27a790,_0x1c8339=_0xc1946c[_0x5eed16(0x14e)]||null;let _0x5e61d5=[],_0x13e60d=_0x17806d[_0x5eed16(0x102)];if(_0x27a790[_0x5eed16(0x131)](_0x5eed16(0x12d))&&_0xc1946c['message']?.[_0x5eed16(0x110)]?.['contextInfo']?.['mentionedJid']){const _0x4e0003=_0xc1946c[_0x5eed16(0x122)][_0x5eed16(0x110)][_0x5eed16(0x134)][_0x5eed16(0x151)];console[_0x5eed16(0x109)](_0x5eed16(0x10f),_0x4e0003);const {normalizedText:_0x5b57d3,mentions:_0x3dc197}=await normalizeMentions(_0x13e60d,_0x4e0003,_0x16435e,lidToJid);_0x13e60d=_0x5b57d3,_0x5e61d5=_0x3dc197;}logger[_0x5eed16(0x123)]({'user':_0xc1946c['pushName'],'prompt':_0x13e60d},_0x5eed16(0x104));const _0x1d670f=new StatusUpdater(_0x1e2077,_0x27a790);await _0x1d670f['start']();try{const _0x11a3a9=await loadMemory(_0x27a790,_0xe102a0);logger[_0x5eed16(0x123)]({},_0x5eed16(0xf8)),await _0x1d670f['update'](_0x5eed16(0x12b));const _0x301bd5=await thinkingLayer(_0x13e60d,_0x11a3a9,_0xc1946c,_0x16435e);logger[_0x5eed16(0x123)](_0x301bd5,_0x5eed16(0x12c)),logger['info']({'prompt':_0x13e60d,'decision':_0x301bd5['decision'],'commandsToRun':_0x301bd5[_0x5eed16(0x100)]},_0x5eed16(0x112));let _0x12295c=[];if(_0x301bd5['commands']&&_0x301bd5[_0x5eed16(0x100)][_0x5eed16(0x12a)]>0x0){logger[_0x5eed16(0x123)]({'commands':_0x301bd5['commands']},_0x5eed16(0x139)),await _0x1d670f[_0x5eed16(0xfe)]('Running\x20command(s):\x20'+_0x301bd5[_0x5eed16(0x100)]['join'](',\x20')+_0x5eed16(0x13c));for(const _0x2be384 of _0x301bd5[_0x5eed16(0x100)]){logger[_0x5eed16(0x123)]({'commandString':_0x2be384},_0x5eed16(0x125));const _0x29b15a=_0x2be384['trim']()[_0x5eed16(0x11a)](/\s+/);_0x29b15a[0x0]=_0x29b15a[0x0][_0x5eed16(0x119)](0x1);const _0x44ab2e=_0x29b15a[0x0],_0xbf8ec=await executeAiCommand({'m':_0xc1946c,'sock':_0x1e2077,'tokens':['!'+_0x44ab2e,..._0x29b15a[_0x5eed16(0x119)](0x1)],'metadata':_0x16435e});_0xbf8ec&&_0xbf8ec['type']!=='text'&&(logger[_0x5eed16(0x123)]({'command':_0x44ab2e,'type':_0xbf8ec['type']},_0x5eed16(0x103)),await _0x1e2077[_0x5eed16(0x13d)](_0xc1946c[_0x5eed16(0xff)]['remoteJid'],_0xbf8ec[_0x5eed16(0x117)])),_0x12295c[_0x5eed16(0x13e)]({'command':_0x44ab2e,'type':_0xbf8ec[_0x5eed16(0x11b)],'output':_0xbf8ec['placeholder']||_0xbf8ec[_0x5eed16(0xfb)]}),logger['info']({'command':_0x44ab2e,'output':_0xbf8ec},_0x5eed16(0x128));}}else logger['info']({},_0x5eed16(0x127));logger[_0x5eed16(0x123)]({},_0x5eed16(0x133));const _0x1013de={'prompt':_0x13e60d,'decision':_0x301bd5[_0x5eed16(0x12e)],'commandOutputs':_0x12295c};logger[_0x5eed16(0x123)]({'context':_0x1013de},'Remix\x20Layer\x20context');const _0x13c890=await remixLayer(_0x1013de,_0xc1946c);logger[_0x5eed16(0x123)]({'finalResponse':_0x13c890},_0x5eed16(0x11e));const _0x2b9a25=await extractJidsFromText(_0x13c890,_0x16435e),_0x2d4bd7=Array[_0x5eed16(0x150)](new Set([..._0x5e61d5,..._0x2b9a25]));await saveMemory(_0x27a790,_0xe102a0,_0x13e60d,_0x13c890,_0x1c8339,_0x12295c,_0x2d4bd7),await _0x1d670f[_0x5eed16(0x147)]({'text':_0x13c890,'mentions':_0x2d4bd7});}catch(_0x25891f){logger[_0x5eed16(0x13b)](_0x25891f,_0x5eed16(0xf7)),await _0x1d670f[_0x5eed16(0x147)](_0x5eed16(0x146));}}};function extractJidsFromText(_0x11f59d,_0x3d850b){const _0x3eff75=a0_0x2f54bc,_0x104bcc=/@[0-9]+/g,_0x4996ba=/[0-9]+@s\.whatsapp\.net/g,_0x557057=[..._0x11f59d[_0x3eff75(0xf5)](_0x104bcc)||[],..._0x11f59d['match'](_0x4996ba)||[]];return Promise[_0x3eff75(0x10e)](_0x557057[_0x3eff75(0x140)](_0x143626=>lidToJid(_0x143626,_0x3d850b)));}async function thinkingLayer(_0x4c6b95,_0xafe625,_0x404f36,_0x419e0e){const _0x539cc0=a0_0x2f54bc;logger[_0x539cc0(0x123)]({'prompt':_0x4c6b95},_0x539cc0(0x121));const _0x1e87cf=genAI[_0x539cc0(0x11d)]({'model':_0x539cc0(0xf6)}),_0x306a20=getCommandMap(),_0x1239eb=Array['from'](_0x306a20[_0x539cc0(0x14c)]())[_0x539cc0(0x10a)](_0x4e88a7=>_0x4e88a7[_0x539cc0(0x145)]['ai']!==![])['map'](_0x209068=>({'name':_0x209068['meta'][_0x539cc0(0xfa)],'description':_0x209068[_0x539cc0(0x145)][_0x539cc0(0x141)],'usage':_0x209068[_0x539cc0(0x145)][_0x539cc0(0xf9)],'direct':_0x209068[_0x539cc0(0x145)][_0x539cc0(0xfc)]||![],'args':(_0x209068['meta']['args']||[])['map'](_0x222569=>_0x222569['name']+'\x20('+_0x222569['description']+')')[_0x539cc0(0x12f)](',\x20')})),_0x12d0d1='\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a'+JSON['stringify'](_0xafe625,null,0x2)+'\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a'+JSON[_0x539cc0(0x115)](_0x1239eb,null,0x2)+_0x539cc0(0x116)+(_0x404f36[_0x539cc0(0x122)][_0x539cc0(0x110)]?.[_0x539cc0(0x134)]?.[_0x539cc0(0x10c)]?.[_0x539cc0(0x149)]||_0x539cc0(0x126))+_0x539cc0(0x124)+_0x404f36[_0x539cc0(0x14e)]+',\x20JID/ID:\x20'+(_0x404f36[_0x539cc0(0xff)]['participant']||_0x404f36[_0x539cc0(0xff)][_0x539cc0(0x129)])+_0x539cc0(0xfd)+_0x4c6b95+'\x22\x0a';try{const _0x1d9164=await _0x1e87cf[_0x539cc0(0x118)](_0x12d0d1),_0x2cd0ba=await _0x1d9164[_0x539cc0(0x14d)][_0x539cc0(0xfb)](),_0x1c7728=_0x2cd0ba[_0x539cc0(0x10d)](/```json/g,'')[_0x539cc0(0x10d)](/```/g,'')[_0x539cc0(0x120)]();if(!_0x1c7728[_0x539cc0(0x14b)]('{'))return{'decision':'I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do.','commands':[]};const _0x42a103=JSON[_0x539cc0(0x130)](_0x1c7728);return{'decision':_0x42a103['decision'],'commands':_0x42a103[_0x539cc0(0x100)]||[]};}catch(_0x5a0bdb){return logger[_0x539cc0(0x13b)](_0x5a0bdb,_0x539cc0(0x101)),{'decision':'There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','commands':[]};}}async function remixLayer(_0xf6296b,_0x47e1e){const _0x127b51=a0_0x2f54bc;logger[_0x127b51(0x123)]({'context':_0xf6296b},'Remix\x20Layer\x20received\x20context.');const _0x483220=genAI['getGenerativeModel']({'model':_0x127b51(0xf6)}),_0x4ac196=_0xf6296b['commandOutputs'][_0x127b51(0x140)](_0x12accf=>'-\x20'+_0x12accf[_0x127b51(0x136)]+':\x20'+_0x12accf[_0x127b51(0x11f)])[_0x127b51(0x12f)]('\x0a'),_0x194740='\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22'+_0xf6296b[_0x127b51(0x102)]+'\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22'+_0xf6296b[_0x127b51(0x12e)]+'\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a'+(_0x4ac196||_0x127b51(0x126))+_0x127b51(0x113)+_0x47e1e[_0x127b51(0x14e)]+',\x20JID/ID:\x20'+(_0x47e1e[_0x127b51(0xff)]['participant']||_0x47e1e['key']['remoteJid'])+'\x0a';try{const _0x597445=await _0x483220[_0x127b51(0x118)](_0x194740),_0x4b2124=_0x597445[_0x127b51(0x14d)][_0x127b51(0xfb)]()?.['trim']();return _0x4b2124||'Here\x20you\x20go\x20✨';}catch(_0x223a2b){return logger[_0x127b51(0x13b)](_0x223a2b,'Error\x20in\x20Remix\x20Layer'),'I\x27m\x20a\x20bit\x20flustered\x20rn\x20😵‍💫';}}