const a0_0xee6362=a0_0x1615;function a0_0x11d9(){const _0x33c270=['Gotcha,\x20all\x20commands\x20handled.\x20‚ú®','229408wIgMvf','output','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','args','18930vMFQIy','ü§î\x20Thinking....','pushName','21UcOSFi','text','remoteJid','isDirect','1782FqiNeI','Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','None','every','Executing\x20command','audio','sendMessage','slice','description','1038528jRjLjG','response','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','AI\x20Thinking\x20Layer\x20Processed','gemini-2.5-pro','done','length','./index','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','2mAOthu','Returning\x20from\x20Thinking\x20Layer','prompt','start','Received\x20final\x20response\x20from\x20Gemini.','decision','filter','map','name','The\x20prompt\x20for\x20the\x20AI.','../../utils/statusUpdater.js','AI\x20command\x20invoked','trim','push','228869IdbTnC','command','Thinking\x20Layer\x20received\x20prompt.','Remix\x20Layer\x20finished','AI\x20command\x20failed','../memory.js','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','Entering\x20Remix\x20Layer...','key','info','912966RHCFnB','Remix\x20layer\x20returned\x20empty\x20text','replace','537355ixgQfu','Sending\x20system\x20prompt\x20to\x20Gemini','[Sent\x20a\x20file:\x20','Remix\x20Layer\x20received\x20context.','Running\x20command(s):\x20','AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','exports','values','includes','join','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a','Error\x20in\x20Gemini\x20Thinking\x20Layer','Entering\x20Command\x20Execution\x20phase','All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.','update','commands','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20üòµ‚Äçüí´','meta','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly\x0a\x0aUser\x20Prompt:\x20\x22','...','154880SwHTnf','commandOutputs','direct','error','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','parse','stringify','usage','unknown','Command\x20returned\x20a\x20file.\x20Sending\x20directly.','Cleaned\x20Gemini\x20response','log','getGenerativeModel','.ai\x20<prompt>'];a0_0x11d9=function(){return _0x33c270;};return a0_0x11d9();}(function(_0x38e9cc,_0x498465){const _0x282964=a0_0x1615,_0x13e756=_0x38e9cc();while(!![]){try{const _0x306da8=-parseInt(_0x282964(0xcd))/0x1*(parseInt(_0x282964(0xbf))/0x2)+parseInt(_0x282964(0xb5))/0x3+parseInt(_0x282964(0xf1))/0x4+-parseInt(_0x282964(0xda))/0x5+-parseInt(_0x282964(0xd7))/0x6+parseInt(_0x282964(0xa8))/0x7*(-parseInt(_0x282964(0xa1))/0x8)+parseInt(_0x282964(0xac))/0x9*(parseInt(_0x282964(0xa5))/0xa);if(_0x306da8===_0x498465)break;else _0x13e756['push'](_0x13e756['shift']());}catch(_0x391cb0){_0x13e756['push'](_0x13e756['shift']());}}}(a0_0x11d9,0x2d35d));function a0_0x1615(_0x2e1bc5,_0x335b3c){const _0x11d972=a0_0x11d9();return a0_0x1615=function(_0x161520,_0x5d9b07){_0x161520=_0x161520-0x96;let _0x885c61=_0x11d972[_0x161520];return _0x885c61;},a0_0x1615(_0x2e1bc5,_0x335b3c);}const {GoogleGenerativeAI}=require('@google/generative-ai'),{getCommandMap}=require(a0_0xee6362(0xbc)),{executeAiCommand}=require('../core/executeCommand'),{StatusUpdater}=require(a0_0xee6362(0xc9)),{loadMemory,saveMemory}=require(a0_0xee6362(0xd2)),logger={'info':(_0x3b4a14,_0x595caa)=>console[a0_0xee6362(0x9d)]('[INFO]\x20'+_0x595caa,_0x3b4a14),'error':(_0x2a4db0,_0x565387)=>console[a0_0xee6362(0xf4)]('[ERROR]\x20'+_0x565387,_0x2a4db0)},genAI=new GoogleGenerativeAI(a0_0xee6362(0xdf));module[a0_0xee6362(0xe1)]={'meta':{'name':'ai','description':a0_0xee6362(0xbd),'usage':a0_0xee6362(0x9f),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0xee6362(0xc1),'required':!![],'greedy':!![],'description':a0_0xee6362(0xc8)}]},'run':async({m:_0x34679b,sock:_0x2e74f7,args:_0x288adf,flags:_0x28c1df,executeCommand:_0xc2d208})=>{const _0x4a4473=a0_0xee6362,_0x8559fc=_0x34679b[_0x4a4473(0xd5)][_0x4a4473(0xaa)],_0x2ebb9c=_0x34679b[_0x4a4473(0xd5)]['participant']||_0x8559fc,_0x3d8421=_0x34679b[_0x4a4473(0xa7)]||null,_0x212bc4=_0x288adf[_0x4a4473(0xc1)];logger[_0x4a4473(0xd6)]({'user':_0x34679b[_0x4a4473(0xa7)],'prompt':_0x212bc4},_0x4a4473(0xca));const _0x5cbc6e=new StatusUpdater(_0x2e74f7,_0x8559fc);await _0x5cbc6e[_0x4a4473(0xc2)]();try{const _0x670136=await loadMemory(_0x8559fc,_0x2ebb9c);logger['info']({},'Entering\x20Thinking\x20Layer...'),await _0x5cbc6e[_0x4a4473(0xe9)](_0x4a4473(0xa6));const _0x51142f=await thinkingLayer(_0x212bc4,_0x670136);logger[_0x4a4473(0xd6)](_0x51142f,'Thinking\x20Layer\x20finished'),logger[_0x4a4473(0xd6)]({'prompt':_0x212bc4,'decision':_0x51142f[_0x4a4473(0xc4)],'commandsToRun':_0x51142f[_0x4a4473(0xea)]},_0x4a4473(0xb8));let _0xb96dc=[];if(_0x51142f[_0x4a4473(0xea)]&&_0x51142f['commands'][_0x4a4473(0xbb)]>0x0){logger[_0x4a4473(0xd6)]({'commands':_0x51142f[_0x4a4473(0xea)]},_0x4a4473(0xe7)),await _0x5cbc6e[_0x4a4473(0xe9)](_0x4a4473(0xde)+_0x51142f['commands'][_0x4a4473(0xe4)](',\x20')+_0x4a4473(0xf0));for(const _0x172ff6 of _0x51142f[_0x4a4473(0xea)]){logger['info']({'commandString':_0x172ff6},_0x4a4473(0xb0));const _0x18b6bd=_0x172ff6[_0x4a4473(0xcb)]()['split'](/\s+/);_0x18b6bd[0x0]=_0x18b6bd[0x0]['slice'](0x1);const _0x18dfde=_0x18b6bd[0x0],_0x2e6a31=await executeAiCommand({'m':_0x34679b,'sock':_0x2e74f7,'tokens':['!'+_0x18dfde,..._0x18b6bd[_0x4a4473(0xb3)](0x1)]});if(_0x2e6a31&&!_0x2e6a31[_0x4a4473(0xa9)]){logger[_0x4a4473(0xd6)]({'command':_0x18dfde,'content':_0x2e6a31},_0x4a4473(0x9b)),await _0x5cbc6e['done'](_0x4a4473(0xba)),await _0x2e74f7[_0x4a4473(0xb2)](_0x34679b[_0x4a4473(0xd5)][_0x4a4473(0xaa)],_0x2e6a31),_0xb96dc[_0x4a4473(0xcc)]({'command':_0x18dfde,'output':_0x4a4473(0xdc)+(_0x2e6a31[_0x4a4473(0xb1)]?_0x4a4473(0xb1):_0x4a4473(0x9a))+']','isDirect':!![]});continue;}const _0x5b50bc=_0x2e6a31?_0x2e6a31[_0x4a4473(0xa9)]:'No\x20textual\x20output.';_0xb96dc[_0x4a4473(0xcc)]({'command':_0x18dfde,'output':_0x5b50bc}),logger[_0x4a4473(0xd6)]({'command':_0x18dfde,'output':_0x5b50bc},'Command\x20execution\x20finished');}}else logger[_0x4a4473(0xd6)]({},'No\x20commands\x20to\x20execute.');if(_0xb96dc[_0x4a4473(0xbb)]>0x0&&_0xb96dc[_0x4a4473(0xaf)](_0x164c8b=>_0x164c8b[_0x4a4473(0xab)])){logger[_0x4a4473(0xd6)]({},_0x4a4473(0xa3));return;}logger[_0x4a4473(0xd6)]({},_0x4a4473(0xd4));const _0x53b699={'prompt':_0x212bc4,'decision':_0x51142f[_0x4a4473(0xc4)],'commandOutputs':_0xb96dc};logger[_0x4a4473(0xd6)]({'context':_0x53b699},'Remix\x20Layer\x20context');const _0x44cb71=await remixLayer(_0x53b699);logger[_0x4a4473(0xd6)]({'finalResponse':_0x44cb71},_0x4a4473(0xd0)),await saveMemory(_0x8559fc,_0x2ebb9c,_0x212bc4,_0x44cb71,_0x3d8421,_0xb96dc),await _0x5cbc6e[_0x4a4473(0xba)](_0x44cb71);}catch(_0x1487e4){logger[_0x4a4473(0xf4)](_0x1487e4,_0x4a4473(0xd1)),await _0x5cbc6e[_0x4a4473(0xba)](_0x4a4473(0xeb));}}};async function thinkingLayer(_0x12a1bc,_0x2a276c){const _0x1c7d8d=a0_0xee6362;logger[_0x1c7d8d(0xd6)]({'prompt':_0x12a1bc},_0x1c7d8d(0xcf));const _0x2ae5ea=genAI[_0x1c7d8d(0x9e)]({'model':_0x1c7d8d(0xb9)}),_0x117a63=getCommandMap(),_0x418ebe=Array['from'](_0x117a63[_0x1c7d8d(0xe2)]())[_0x1c7d8d(0xc5)](_0x50de89=>_0x50de89[_0x1c7d8d(0xec)]['ai']!==![])['map'](_0x856315=>({'name':_0x856315[_0x1c7d8d(0xec)]['name'],'description':_0x856315['meta'][_0x1c7d8d(0xb4)],'usage':_0x856315[_0x1c7d8d(0xec)][_0x1c7d8d(0x99)],'direct':_0x856315[_0x1c7d8d(0xec)][_0x1c7d8d(0xf3)]||![],'args':(_0x856315[_0x1c7d8d(0xec)][_0x1c7d8d(0xa4)]||[])['map'](_0x911a6b=>_0x911a6b[_0x1c7d8d(0xc7)]+'\x20('+_0x911a6b[_0x1c7d8d(0xb4)]+')')[_0x1c7d8d(0xe4)](',\x20')}));logger[_0x1c7d8d(0xd6)]({'count':_0x418ebe[_0x1c7d8d(0xbb)]},'Generated\x20callable\x20command\x20list\x20for\x20AI');const _0x33fba4=_0x1c7d8d(0xd3)+JSON[_0x1c7d8d(0x98)](_0x2a276c,null,0x2)+_0x1c7d8d(0xbe)+JSON['stringify'](_0x418ebe,null,0x2)+_0x1c7d8d(0xef)+_0x12a1bc+'\x22\x0a';logger[_0x1c7d8d(0xd6)](_0x1c7d8d(0xdb));try{const _0x1ce288=await _0x2ae5ea['generateContent'](_0x33fba4),_0x80fef0=await _0x1ce288[_0x1c7d8d(0xb6)]['text']();logger['info']({'responseText':_0x80fef0},'Received\x20response\x20from\x20Gemini');const _0x1ea18f=_0x80fef0[_0x1c7d8d(0xd9)](/```json/g,'')[_0x1c7d8d(0xd9)](/```/g,'')['trim']();logger[_0x1c7d8d(0xd6)]({'cleanedText':_0x1ea18f},_0x1c7d8d(0x9c));if(!_0x1ea18f||!_0x1ea18f['includes']('{')||!_0x1ea18f[_0x1c7d8d(0xe3)]('}'))return logger[_0x1c7d8d(0xf4)]({'cleanedText':_0x1ea18f},_0x1c7d8d(0xad)),{'decision':'I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','commands':[]};const _0x1471e4=JSON[_0x1c7d8d(0x97)](_0x1ea18f);logger[_0x1c7d8d(0xd6)]({'jsonResponse':_0x1471e4},'Parsed\x20JSON\x20response');const _0x1f3af1={'decision':_0x1471e4['decision'],'commands':_0x1471e4['commands']||[]};return logger[_0x1c7d8d(0xd6)]({'thinkingResult':_0x1f3af1},_0x1c7d8d(0xc0)),_0x1f3af1;}catch(_0x5d8287){return logger['error'](_0x5d8287,_0x1c7d8d(0xe6)),{'decision':_0x1c7d8d(0xee),'commands':[]};}}async function remixLayer(_0x32e47a){const _0x1a4a0d=a0_0xee6362;logger[_0x1a4a0d(0xd6)]({'context':_0x32e47a},_0x1a4a0d(0xdd));const _0x49ef82=genAI[_0x1a4a0d(0x9e)]({'model':_0x1a4a0d(0xb9)}),_0x38d87f=_0x32e47a[_0x1a4a0d(0xf2)][_0x1a4a0d(0xc5)](_0x16f331=>!_0x16f331['isDirect']);if(_0x38d87f[_0x1a4a0d(0xbb)]===0x0&&_0x32e47a[_0x1a4a0d(0xf2)][_0x1a4a0d(0xbb)]>0x0)return logger['info']({},_0x1a4a0d(0xe8)),_0x1a4a0d(0xa0);const _0x1810d3=_0x1a4a0d(0xe0)+_0x32e47a[_0x1a4a0d(0xc1)]+_0x1a4a0d(0xed)+_0x32e47a[_0x1a4a0d(0xc4)]+_0x1a4a0d(0x96)+(_0x38d87f[_0x1a4a0d(0xc6)](_0x2e9aef=>'-\x20'+_0x2e9aef[_0x1a4a0d(0xce)]+':\x20'+_0x2e9aef[_0x1a4a0d(0xa2)])[_0x1a4a0d(0xe4)]('\x0a')||_0x1a4a0d(0xae))+_0x1a4a0d(0xe5);logger[_0x1a4a0d(0xd6)](_0x1a4a0d(0xb7));try{const _0x270116=await _0x49ef82['generateContent'](_0x1810d3),_0x204b82=await _0x270116[_0x1a4a0d(0xb6)],_0x25ef58=_0x204b82['text']()?.[_0x1a4a0d(0xcb)]();if(!_0x25ef58)return logger[_0x1a4a0d(0xf4)]({},_0x1a4a0d(0xd8)),'Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20ü§Ø';return logger[_0x1a4a0d(0xd6)]({'response':_0x25ef58},_0x1a4a0d(0xc3)),_0x25ef58;}catch(_0x1b1c6e){return logger[_0x1a4a0d(0xf4)](_0x1b1c6e,'Error\x20in\x20Gemini\x20Remix\x20Layer'),'I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.';}}