const a0_0x33afa7=a0_0x41ba;(function(_0x470f33,_0x344dbf){const _0x52d6fe=a0_0x41ba,_0x49924a=_0x470f33();while(!![]){try{const _0x5a7aef=-parseInt(_0x52d6fe(0xc7))/0x1+parseInt(_0x52d6fe(0xe2))/0x2+-parseInt(_0x52d6fe(0xc1))/0x3*(-parseInt(_0x52d6fe(0xe4))/0x4)+-parseInt(_0x52d6fe(0x10d))/0x5*(parseInt(_0x52d6fe(0xdd))/0x6)+-parseInt(_0x52d6fe(0x106))/0x7+-parseInt(_0x52d6fe(0xf5))/0x8+-parseInt(_0x52d6fe(0xd3))/0x9*(-parseInt(_0x52d6fe(0xba))/0xa);if(_0x5a7aef===_0x344dbf)break;else _0x49924a['push'](_0x49924a['shift']());}catch(_0x3908ea){_0x49924a['push'](_0x49924a['shift']());}}}(a0_0x1647,0x882ec));const fs=require('fs'),path=require(a0_0x33afa7(0xf3)),{GoogleGenerativeAI}=require(a0_0x33afa7(0x114)),{parseArgs}=require(a0_0x33afa7(0x10c)),{resolveCommand}=require('./index'),{settings:botSettings}=require(a0_0x33afa7(0xdc)),{StatusUpdater}=require(a0_0x33afa7(0xf4)),API_KEYS_FILE=path[a0_0x33afa7(0xc0)](__dirname,'..','..',a0_0x33afa7(0x113),a0_0x33afa7(0xe6));function loadApiKeys(){const _0x4c8d5e=a0_0x33afa7;if(!fs['existsSync'](API_KEYS_FILE))throw new Error('apiKeys.txt\x20not\x20found');return fs[_0x4c8d5e(0xf7)](API_KEYS_FILE,'utf8')[_0x4c8d5e(0xe0)](/\r?\n/)['filter'](Boolean);}const apiKeys=loadApiKeys();let currentKeyIndex=0x0;function setupGenAI(){const _0x1240d0=a0_0x33afa7,_0x4c4edd=apiKeys[currentKeyIndex],_0x25df87=new GoogleGenerativeAI(_0x4c4edd);return _0x25df87[_0x1240d0(0x103)]({'model':_0x1240d0(0xda)});}let model=setupGenAI();function a0_0x1647(){const _0x4eb6af=['.ai\x20<prompt>','10GbuudR','error','commandsToRun\x20is\x20not\x20an\x20array:','(command\x20ran\x20but\x20gave\x20no\x20output)','[runCommand]\x20Trying\x20to\x20resolve:','Error\x20extracting\x20commands:','join','264801eUuPuD','[extractCommands]\x20Gemini\x20raw\x20output:\x0a','.\x0aUser\x20said:\x20\x22','msg','done','raw','888113NcxGFH','âš™ï¸\x20Running\x20/','botName','[runCommand]\x20Resolved\x20to:','\x0aYou\x20are\x20a\x20sophisticated\x20command\x20interpreter\x20for\x20a\x20chatbot.\x20Your\x20primary\x20task\x20is\x20to\x20analyze\x20a\x20user\x27s\x20message\x20and\x20determine\x20if\x20it\x20contains\x20an\x20intent\x20to\x20execute\x20one\x20or\x20more\x20commands.\x0a\x0aCarefully\x20analyze\x20the\x20user\x27s\x20message:\x20\x22','now','./index','ðŸ”\x20Extracting\x20commands...','startsWith','Failed\x20to\x20extract\x20commands\x20from\x20prompt:','sendMessage','users','2621070xvgsmS','parse','writeFileSync','\x20\x0a\x0a>\x20MORA\x20AI.\x20Generated\x20by\x20AI.\x20Don\x27t\x20take\x20responses\x20too\x20seriously','ðŸ§ \x20Remixing\x20with\x20AI...','participant','run','gemini-2.5-flash','Command\x20failed','../../settings','6fEGvTA','ðŸ¤–\x20Thinking...','\x0aRespond\x20casually\x20and\x20helpfully:','split','trim','1291880mbfzcr','string','40vhJwyh','Rate\x20limit\x20error:','apiKeys.txt','\x20of\x20','message','extendedTextMessage','quotedMessage','\x22\x0a\x0aFollow\x20these\x20rules:\x0a\x0a1.\x20\x20**Identify\x20Actions\x20vs.\x20Conversation**:\x0a\x20\x20\x20\x20*\x20\x20\x20**Command\x20Intent**:\x20The\x20user\x20wants\x20to\x20perform\x20a\x20specific\x20action\x20with\x20a\x20tool\x20(e.g.,\x20\x22tell\x20me\x20a\x20joke\x22,\x20\x22make\x20an\x20image\x22,\x20\x22get\x20the\x20weather\x22,\x20\x22respond\x20with\x20audio\x22).\x20These\x20map\x20to\x20commands.\x0a\x20\x20\x20\x20*\x20\x20\x20**Conversational\x20Intent**:\x20The\x20user\x20is\x20asking\x20a\x20general\x20question,\x20making\x20a\x20statement,\x20or\x20giving\x20a\x20creative\x20prompt\x20that\x20doesn\x27t\x20require\x20a\x20specific\x20tool\x20(e.g.,\x20\x22what\x27s\x20the\x20capital\x20of\x20France?\x22,\x20\x22tell\x20me\x20a\x20story\x20about\x20a\x20knight\x22).\x20These\x20do\x20not\x20map\x20to\x20commands.\x0a\x0a2.\x20\x20**Handle\x20Mixed\x20Intents**:\x20A\x20user\x27s\x20message\x20can\x20have\x20both\x20conversational\x20parts\x20and\x20command\x20parts.\x20Identify\x20all\x20command-related\x20actions.\x0a\x20\x20\x20\x20*\x20\x20\x20Example:\x20\x22Tell\x20me\x20a\x20joke\x20and\x20respond\x20with\x20audio.\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20\x20\x20\x22Tell\x20me\x20a\x20joke\x22\x20->\x20This\x20is\x20a\x20command\x20intent,\x20maps\x20to\x20the\x20`joke`\x20command.\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20\x20\x20\x22respond\x20with\x20audio\x22\x20->\x20This\x20is\x20also\x20a\x20command\x20intent,\x20maps\x20to\x20the\x20`tts`\x20command.\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20\x20\x20Result:\x20You\x20should\x20identify\x20both\x20`joke`\x20and\x20`tts`.\x0a\x0a3.\x20\x20**Command\x20Matching**:\x20If\x20you\x20detect\x20Command\x20Intent,\x20match\x20the\x20action(s)\x20to\x20one\x20or\x20more\x20commands\x20from\x20this\x20list:\x0a\x20\x20\x20\x20','role','extractCommands:\x20Expected\x20array,\x20got:','global','Failed\x20to\x20process\x20your\x20request.','log','\x0a\x0aUser:\x20','update','path','../../utils/statusUpdater.js','2498256jKFtjj','stringify','readFileSync','assistant','User:\x20','replace','direct','length','...','text','remoteJid','name','generateContent','contextInfo','getGenerativeModel','Switched\x20to\x20key\x20','Error\x20with\x20current\x20API\x20key:','365722lueAuT','\x22)\x20and\x20provide\x20your\x20JSON\x20response.\x0a','âœ…\x20Command(s)\x20completed','slice','command','push','../../utils/parseArgs','46975sGrwVs','user','key','\x0a\x0aYou\x20are\x20','pow','map','secrets','@google/generative-ai','existsSync','Sorry,\x20I\x27m\x20having\x20trouble\x20processing\x20your\x20request\x20right\x20now.','.\x0aTime\x20now:\x20','keys','response','\x0aDo\x20you\x20want\x20to\x20store\x20anything?\x20Respond\x20with\x20JSON\x20{\x22user\x22:\x20\x22\x22,\x20\x22global\x22:\x20\x22\x22}','You\x27re\x20a\x20smart,\x20witty,\x20Gen-Z\x20chatbot\x20with\x20a\x20chill,\x20upbeat\x20tone.\x0aYou\x20use\x20modern\x20slang\x20casually\x20(e.g.,\x20\x22bet\x22,\x20\x22vibe\x22,\x20\x22real\x20talk\x22,\x20\x22fr\x22,\x20\x22no\x20cap\x22\x20etc.\x20Use\x20sensibly).\x0aYou\x27re\x20still\x20helpful\x20and\x20concise\x20â€”\x20keep\x20replies\x20short\x20and\x20energetic.\x20ðŸŽ§ðŸ”¥','meta','isArray','toLocaleString'];a0_0x1647=function(){return _0x4eb6af;};return a0_0x1647();}function rotateKey(){const _0x2db420=a0_0x33afa7;currentKeyIndex=(currentKeyIndex+0x1)%apiKeys[_0x2db420(0xfc)],model=setupGenAI(),console[_0x2db420(0xf0)](_0x2db420(0x104)+(currentKeyIndex+0x1)+_0x2db420(0xe7)+apiKeys[_0x2db420(0xfc)]);}const persona=a0_0x33afa7(0xb5),MEM_FILE=path['join'](__dirname,'..','..',a0_0x33afa7(0x113),'ai_memory.json'),REM_FILE=path[a0_0x33afa7(0xc0)](__dirname,'..','..',a0_0x33afa7(0x113),'ai_remember.json'),loadJson=(_0x2968c6,_0x20799c={})=>fs[a0_0x33afa7(0x115)](_0x2968c6)?JSON[a0_0x33afa7(0xd4)](fs[a0_0x33afa7(0xf7)](_0x2968c6,'utf8')):_0x20799c,saveJson=(_0x19ef4b,_0x1bb10c)=>fs[a0_0x33afa7(0xd5)](_0x19ef4b,JSON[a0_0x33afa7(0xf6)](_0x1bb10c,null,0x2)),MEMORY=loadJson(MEM_FILE,{}),REMEMBER=loadJson(REM_FILE,{'users':{},'global':''}),MAX_MEMORY=0xf,addMemory=(_0x1291a8,_0x2a8f46,_0x343db4)=>{const _0x354258=a0_0x33afa7;if(!MEMORY[_0x1291a8])MEMORY[_0x1291a8]=[];MEMORY[_0x1291a8][_0x354258(0x10b)]({'role':_0x2a8f46,'msg':_0x343db4,'ts':Date[_0x354258(0xcc)]()});if(MEMORY[_0x1291a8][_0x354258(0xfc)]>MAX_MEMORY)MEMORY[_0x1291a8]['shift']();saveJson(MEM_FILE,MEMORY);},getMemory=_0x48b34d=>(MEMORY[_0x48b34d]||[])[a0_0x33afa7(0x109)](-MAX_MEMORY)[a0_0x33afa7(0x112)](_0x2b8fdb=>_0x2b8fdb[a0_0x33afa7(0xec)]+':\x20'+_0x2b8fdb[a0_0x33afa7(0xc4)])[a0_0x33afa7(0xc0)]('\x0a');function a0_0x41ba(_0x4c0c3b,_0x533793){const _0x164777=a0_0x1647();return a0_0x41ba=function(_0x41bacc,_0x716040){_0x41bacc=_0x41bacc-0xb2;let _0x5dfb17=_0x164777[_0x41bacc];return _0x5dfb17;},a0_0x41ba(_0x4c0c3b,_0x533793);}async function runCommand(_0x52958b,_0xc676e0,_0x26d5ed,_0x15834a,_0x140e64,_0x167c38=null){const _0xaf375f=a0_0x33afa7;console['log'](_0xaf375f(0xbe),_0x52958b);const _0x4cb4b2=resolveCommand(_0x52958b);console[_0xaf375f(0xf0)](_0xaf375f(0xca),_0x4cb4b2?.[_0xaf375f(0x10a)]?.[_0xaf375f(0xb6)]?.[_0xaf375f(0x100)]||'âŒ\x20not\x20found');if(!_0x4cb4b2)return{'output':null,'directUsed':![]};const {command:_0x504bba}=_0x4cb4b2,_0x5fda66=_0x167c38?(_0x167c38+'\x20'+_0xc676e0)[_0xaf375f(0xe1)]():_0xc676e0,_0x262575=_0x5fda66[_0xaf375f(0xe1)]()['split'](/\s+/),{args:_0x546d05,flags:_0x471d91}=parseArgs(_0x262575,_0x504bba[_0xaf375f(0xb6)]['args']||[]);let _0x134008='',_0x4ca271=![];const _0x27ddfc={'sendMessage':async(_0x2e985a,_0x52a7cc)=>{const _0x5231b1=_0xaf375f,_0x47bd57=typeof _0x52a7cc===_0x5231b1(0xe3)?_0x52a7cc:_0x52a7cc[_0x5231b1(0xfe)]||'';_0x134008+=_0x47bd57,_0x504bba[_0x5231b1(0xb6)][_0x5231b1(0xfb)]===!![]&&(await _0x15834a['sendMessage'](_0x26d5ed,_0x52a7cc),_0x4ca271=!![]);}};try{await _0x504bba[_0xaf375f(0xd9)]({'m':{'key':{'remoteJid':_0x26d5ed},'message':{'extendedTextMessage':{'contextInfo':{'quotedMessage':_0x140e64}}}},'sock':_0x27ddfc,'args':_0x546d05,'flags':_0x471d91,'executeCommand':()=>{}});if(!_0x134008[_0xaf375f(0xe1)]())_0x134008=_0xaf375f(0xbd);}catch(_0x18a37f){_0x134008='âŒ\x20'+(_0x18a37f[_0xaf375f(0xe8)]||_0xaf375f(0xdb));}return{'output':_0x134008[_0xaf375f(0xe1)](),'directUsed':_0x4ca271};}async function extractCommands(_0x4a4774){const _0x1051dc=a0_0x33afa7,{commandMap:_0x213356,aliasMap:_0x13c1df}=require(_0x1051dc(0xcd)),_0x4f063f=[...new Set([..._0x213356[_0x1051dc(0xb2)](),..._0x13c1df['keys']()])],_0x51dfa9=_0x1051dc(0xcb)+_0x4a4774+_0x1051dc(0xeb)+_0x4f063f[_0x1051dc(0xc0)](',\x20')+'\x0a\x0a4.\x20\x20**Command\x20Chaining**:\x20If\x20multiple\x20commands\x20are\x20identified,\x20order\x20them\x20logically.\x20The\x20output\x20of\x20the\x20first\x20command\x20is\x20often\x20the\x20input\x20for\x20the\x20second.\x0a\x20\x20\x20\x20*\x20\x20\x20For\x20\x22Tell\x20me\x20a\x20joke\x20and\x20respond\x20with\x20audio\x22,\x20the\x20logical\x20order\x20is\x20`joke`\x20first,\x20then\x20`tts`.\x0a\x0a5.\x20\x20**Argument\x20Generation**:\x20For\x20each\x20command,\x20determine\x20the\x20arguments.\x0a\x20\x20\x20\x20*\x20\x20\x20If\x20a\x20command\x27s\x20input\x20is\x20the\x20output\x20of\x20a\x20previous\x20command\x20in\x20the\x20chain,\x20you\x20can\x20provide\x20empty\x20arguments.\x20For\x20the\x20joke/tts\x20example,\x20`tts`\x20would\x20take\x20its\x20input\x20from\x20`joke`.\x0a\x20\x20\x20\x20*\x20\x20\x20Example:\x20\x22make\x20a\x20detailed\x20image\x20of\x20a\x20cat\x22\x20->\x20`{\x20\x22name\x22:\x20\x22imagine\x22,\x20\x22args\x22:\x20\x22a\x20highly\x20detailed\x20digital\x20painting\x20of\x20a\x20cat\x20sitting\x20on\x20a\x20glowing\x20throne,\x20intricate\x20lighting\x20and\x20dramatic\x20shadows\x22\x20}`\x0a\x0a6.\x20\x20**No\x20Command**:\x20If\x20the\x20message\x20is\x20purely\x20conversational\x20(e.g.,\x20\x22tell\x20me\x20a\x20story\x22,\x20\x22what\x20is\x202+2\x22),\x20return\x20an\x20empty\x20array\x20`[]`.\x0a\x0a7.\x20\x20**Response\x20Format**:\x20Respond\x20ONLY\x20with\x20raw\x20JSON\x20in\x20the\x20format\x20`[{\x22name\x22:\x20\x22commandName\x22,\x20\x22args\x22:\x20\x22argument\x20string\x22}]`.\x20Do\x20not\x20include\x20any\x20explanations,\x20markdown,\x20or\x20code\x20blocks.\x0a\x0aAnalyze\x20the\x20user\x27s\x20message\x20(\x22'+_0x4a4774+_0x1051dc(0x107);try{const _0x5c324d=await model['generateContent'](_0x51dfa9);let _0x18e262=_0x5c324d[_0x1051dc(0xb3)][_0x1051dc(0xfe)]()[_0x1051dc(0xe1)]();_0x18e262=_0x18e262[_0x1051dc(0xfa)](/```json/g,'')[_0x1051dc(0xfa)](/```/g,'')[_0x1051dc(0xfa)](/`/g,''),console[_0x1051dc(0xf0)](_0x1051dc(0xc2),_0x18e262);if(!_0x18e262||!_0x18e262[_0x1051dc(0xcf)]('['))return console[_0x1051dc(0xf0)]('[extractCommands]\x20No\x20valid\x20command\x20array\x20found.\x20Returning\x20empty.'),[];const _0x266d85=JSON[_0x1051dc(0xd4)](_0x18e262);if(!Array[_0x1051dc(0xb7)](_0x266d85))return console['error'](_0x1051dc(0xed),_0x266d85),[];return _0x266d85;}catch(_0x1ba9c2){return console[_0x1051dc(0xbb)](_0x1051dc(0xd0),_0x1ba9c2),[];}}module['exports']={'meta':{'name':'ai','description':'Talk\x20to\x20MORA-AI','usage':a0_0x33afa7(0xb9),'args':[{'name':a0_0x33afa7(0xfe),'type':a0_0x33afa7(0xe3),'greedy':!![],'required':!![]}],'category':'AI'},'run':async({m:_0x543969,sock:_0x29d79b,args:_0x3fa3e5})=>{const _0x10512a=a0_0x33afa7,_0xa7ff63=_0x543969[_0x10512a(0x10f)][_0x10512a(0xff)],_0x1df1d7=_0x543969[_0x10512a(0x10f)][_0x10512a(0xd8)]||_0xa7ff63,_0xf013f=_0x3fa3e5[_0x10512a(0xfe)],_0x356711=_0x543969[_0x10512a(0xe8)]?.[_0x10512a(0xe9)]?.[_0x10512a(0x102)]?.[_0x10512a(0xea)],_0x5bb493=new StatusUpdater(_0x29d79b,_0xa7ff63);await _0x5bb493['start'](),await _0x5bb493['update'](_0x10512a(0xde)),addMemory(_0x1df1d7,_0x10512a(0x10e),_0xf013f);let _0x41c416;try{await _0x5bb493[_0x10512a(0xf2)](_0x10512a(0xce)),_0x41c416=await extractCommands(_0xf013f);}catch(_0x29136e){return console[_0x10512a(0xbb)](_0x10512a(0xbf),_0x29136e),_0x29d79b[_0x10512a(0xd1)](_0xa7ff63,{'text':_0x10512a(0xef)});}if(!Array[_0x10512a(0xb7)](_0x41c416))return console[_0x10512a(0xbb)](_0x10512a(0xbc),_0x41c416),_0x29d79b[_0x10512a(0xd1)](_0xa7ff63,{'text':_0x10512a(0xef)});const _0xf36f4e=[];let _0x5f1abf=null,_0x554f0f=![];for(const {name:_0x45500b,args:_0x5d9ea5}of _0x41c416){await _0x5bb493[_0x10512a(0xf2)](_0x10512a(0xc8)+_0x45500b+_0x10512a(0xfd));const {output:_0x43be31,directUsed:_0x153a1d}=await runCommand(_0x45500b,_0x5d9ea5,_0xa7ff63,_0x29d79b,_0x356711,_0x5f1abf);_0x43be31&&(_0xf36f4e['push']({'name':_0x45500b,'raw':_0x43be31}),_0x5f1abf=_0x43be31);if(_0x153a1d)_0x554f0f=!![];}const _0x10901b=_0xf36f4e[_0x10512a(0x112)](_0x5163d8=>_0x5163d8[_0x10512a(0x100)]+':\x20'+_0x5163d8[_0x10512a(0xc6)])[_0x10512a(0xc0)]('\x0a');if(_0x554f0f){console['log']('Command\x20used\x20direct:true\x20â€”\x20skipping\x20summary\x20AI\x20reply'),await _0x5bb493[_0x10512a(0xc5)](_0x10512a(0x108));return;}const _0x203210=persona+_0x10512a(0x110)+botSettings[_0x10512a(0xc9)]+',\x20owned\x20by\x20'+botSettings['ownerName']+_0x10512a(0x117)+new Date()[_0x10512a(0xb8)]()+_0x10512a(0xc3)+_0xf013f+'\x22\x0aCommand\x20output:\x0a'+_0x10901b+'\x0aReply\x20with\x20Gen-Z\x20style\x20in\x201â€“2\x20lines.';let _0x1845a3='';const _0x239303=0x3;let _0x5619ec=0x0;while(_0x5619ec<_0x239303){try{await _0x5bb493[_0x10512a(0xf2)](_0x10512a(0xd7));const _0xc7984e=await model[_0x10512a(0x101)](_0x203210);_0x1845a3=_0xc7984e[_0x10512a(0xb3)][_0x10512a(0xfe)]()[_0x10512a(0xe1)]();break;}catch(_0x42c2f9){if(_0x42c2f9['data']===0x1ad){console[_0x10512a(0xbb)](_0x10512a(0xe5),_0x42c2f9),_0x5619ec++;const _0x1c8501=Math[_0x10512a(0x111)](0x2,_0x5619ec)*0x3e8;await new Promise(_0x521feb=>setTimeout(_0x521feb,_0x1c8501)),rotateKey();}else{console['error'](_0x10512a(0x105),_0x42c2f9),_0x1845a3=_0x10512a(0x116);break;}}}if(!_0xf36f4e[_0x10512a(0xfc)]){const _0x1567fe=persona+_0x10512a(0xf1)+_0xf013f+_0x10512a(0xdf);try{const _0x364b2b=await model['generateContent'](_0x1567fe);_0x1845a3=_0x364b2b[_0x10512a(0xb3)][_0x10512a(0xfe)]()['trim']();}catch(_0x239f2c){console[_0x10512a(0xbb)](_0x10512a(0x105),_0x239f2c),_0x1845a3=_0x10512a(0x116);}}addMemory(_0x1df1d7,_0x10512a(0xf8),_0x1845a3);const _0x14e0b6=_0x10512a(0xf9)+_0xf013f+'\x0aCommands\x20used:\x20'+_0xf36f4e[_0x10512a(0x112)](_0x560cf4=>_0x560cf4['name'])[_0x10512a(0xc0)](',')+_0x10512a(0xb4);try{const _0x27ccb6=await model[_0x10512a(0x101)](_0x14e0b6),_0x4276fe=JSON['parse'](_0x27ccb6[_0x10512a(0xb3)]['text']());if(_0x4276fe[_0x10512a(0x10e)])REMEMBER[_0x10512a(0xd2)][_0x1df1d7]=_0x4276fe[_0x10512a(0x10e)];if(_0x4276fe[_0x10512a(0xee)])REMEMBER[_0x10512a(0xee)]=_0x4276fe['global'];saveJson(REM_FILE,REMEMBER);}catch{}const _0x4d539f=_0x1845a3+_0x10512a(0xd6);await _0x5bb493[_0x10512a(0xc5)](_0x4d539f);}};