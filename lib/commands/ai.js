const a0_0xa9f26=a0_0x42bf;(function(_0x21d351,_0x2e87a0){const _0x146fab=a0_0x42bf,_0xb51a02=_0x21d351();while(!![]){try{const _0xb532e6=-parseInt(_0x146fab(0x156))/0x1+parseInt(_0x146fab(0x148))/0x2*(parseInt(_0x146fab(0x157))/0x3)+-parseInt(_0x146fab(0x14e))/0x4+-parseInt(_0x146fab(0x112))/0x5*(parseInt(_0x146fab(0x154))/0x6)+parseInt(_0x146fab(0x11d))/0x7*(-parseInt(_0x146fab(0x124))/0x8)+parseInt(_0x146fab(0x142))/0x9+parseInt(_0x146fab(0x14c))/0xa;if(_0xb532e6===_0x2e87a0)break;else _0xb51a02['push'](_0xb51a02['shift']());}catch(_0x336cae){_0xb51a02['push'](_0xb51a02['shift']());}}}(a0_0x9992,0xda58b));function a0_0x42bf(_0x53e405,_0x2734fa){const _0x999221=a0_0x9992();return a0_0x42bf=function(_0x42bf4a,_0x30c812){_0x42bf4a=_0x42bf4a-0x10e;let _0x32b927=_0x999221[_0x42bf4a];return _0x32b927;},a0_0x42bf(_0x53e405,_0x2734fa);}const {GoogleGenerativeAI}=require(a0_0xa9f26(0x138)),{getCommandMap}=require(a0_0xa9f26(0x15d)),{executeAiCommand}=require('../core/executeCommand'),{StatusUpdater}=require(a0_0xa9f26(0x152)),logger={'info':(_0x4dde3a,_0xea6ac9)=>console['log']('[INFO]\x20'+_0xea6ac9,_0x4dde3a),'error':(_0x106c4f,_0x5898dc)=>console[a0_0xa9f26(0x155)]('[ERROR]\x20'+_0x5898dc,_0x106c4f)},genAI=new GoogleGenerativeAI(a0_0xa9f26(0x11f));function a0_0x9992(){const _0x40f16e=['2019bvRkvX','Executing\x20command','description','Returning\x20from\x20Thinking\x20Layer','🤔\x20Thinking....','info','./index','Remix\x20Layer\x20received\x20context.','filter','commandOutputs','Received\x20final\x20response\x20from\x20Gemini.','stringify','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','push','remoteJid','AI\x20command\x20invoked','Thinking\x20Layer\x20finished','Command\x20returned\x20a\x20file.\x20Sending\x20directly.','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','slice','5pLfRvh','AI\x20command\x20failed','unknown','args','Error\x20in\x20Gemini\x20Remix\x20Layer','None','Generated\x20callable\x20command\x20list\x20for\x20AI','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a','map','Error\x20in\x20Gemini\x20Thinking\x20Layer','decision','343qYxzTD','meta','AIzaSyDO4v1a36TNgunFzm7N-FzT3WYJnwIpbRI','key','[Sent\x20a\x20file:\x20','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','name','58576fLbisB','trim','split','isDirect','Parsed\x20JSON\x20response','Running\x20command(s):\x20','done','No\x20commands\x20to\x20execute.','gemini-2.5-pro','audio','No\x20textual\x20output.','getGenerativeModel','direct','join','Command\x20execution\x20finished','All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.','replace','prompt','.ai\x20<prompt>','start','@google/generative-ai','from','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','participant','response','Remix\x20Layer\x20finished','pushName','length','commands','values','3057741qalRZx','Gotcha,\x20all\x20commands\x20handled.\x20✨','update','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20😵‍💫','Received\x20response\x20from\x20Gemini','Remix\x20Layer\x20context','1796QXFpPJ','generateContent','Cleaned\x20Gemini\x20response','The\x20prompt\x20for\x20the\x20AI.','10170840PJCryC','text','2410288IhEUoB','Sending\x20system\x20prompt\x20to\x20Gemini','Entering\x20Command\x20Execution\x20phase','command','../../utils/statusUpdater.js','usage','384978bIgoUz','error','41327JXhkkX'];a0_0x9992=function(){return _0x40f16e;};return a0_0x9992();}module['exports']={'meta':{'name':'ai','description':'A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','usage':a0_0xa9f26(0x136),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':a0_0xa9f26(0x135),'required':!![],'greedy':!![],'description':a0_0xa9f26(0x14b)}]},'run':async({m:_0x4a4983,sock:_0x147171,args:_0x322b59,flags:_0x2a7f8f,executeCommand:_0x407522})=>{const _0x4b2e0b=a0_0xa9f26,_0x1afb50=_0x4a4983[_0x4b2e0b(0x120)][_0x4b2e0b(0x165)],_0x2a6a44=_0x4a4983[_0x4b2e0b(0x120)][_0x4b2e0b(0x13b)]||_0x1afb50,_0x2e6897=_0x322b59[_0x4b2e0b(0x135)];logger[_0x4b2e0b(0x15c)]({'user':_0x4a4983[_0x4b2e0b(0x13e)],'prompt':_0x2e6897},_0x4b2e0b(0x166));const _0x394abc=new StatusUpdater(_0x147171,_0x1afb50);await _0x394abc[_0x4b2e0b(0x137)]();try{logger[_0x4b2e0b(0x15c)]({},'Entering\x20Thinking\x20Layer...'),await _0x394abc[_0x4b2e0b(0x144)](_0x4b2e0b(0x15b));const _0x2cce5c=await thinkingLayer(_0x2e6897);logger[_0x4b2e0b(0x15c)](_0x2cce5c,_0x4b2e0b(0x10e)),logger[_0x4b2e0b(0x15c)]({'prompt':_0x2e6897,'decision':_0x2cce5c['decision'],'commandsToRun':_0x2cce5c[_0x4b2e0b(0x140)]},'AI\x20Thinking\x20Layer\x20Processed');let _0x2e985c=[];if(_0x2cce5c[_0x4b2e0b(0x140)]&&_0x2cce5c['commands']['length']>0x0){logger[_0x4b2e0b(0x15c)]({'commands':_0x2cce5c['commands']},_0x4b2e0b(0x150)),await _0x394abc['update'](_0x4b2e0b(0x129)+_0x2cce5c[_0x4b2e0b(0x140)]['join'](',\x20')+'...');for(const _0x16df5e of _0x2cce5c[_0x4b2e0b(0x140)]){logger[_0x4b2e0b(0x15c)]({'commandString':_0x16df5e},_0x4b2e0b(0x158));const _0x5cf44c=_0x16df5e[_0x4b2e0b(0x125)]()[_0x4b2e0b(0x126)](/\s+/);_0x5cf44c[0x0]=_0x5cf44c[0x0]['slice'](0x1);const _0x538882=_0x5cf44c[0x0],_0x9e64be=await executeAiCommand({'m':_0x4a4983,'sock':_0x147171,'tokens':['!'+_0x538882,..._0x5cf44c[_0x4b2e0b(0x111)](0x1)]});if(_0x9e64be&&!_0x9e64be[_0x4b2e0b(0x14d)]){logger[_0x4b2e0b(0x15c)]({'command':_0x538882,'content':_0x9e64be},_0x4b2e0b(0x10f)),await _0x394abc[_0x4b2e0b(0x12a)](_0x4b2e0b(0x12a)),await _0x147171['sendMessage'](_0x4a4983[_0x4b2e0b(0x120)]['remoteJid'],_0x9e64be),_0x2e985c[_0x4b2e0b(0x164)]({'command':_0x538882,'output':_0x4b2e0b(0x121)+(_0x9e64be[_0x4b2e0b(0x12d)]?_0x4b2e0b(0x12d):_0x4b2e0b(0x114))+']','isDirect':!![]});continue;}const _0x47785c=_0x9e64be?_0x9e64be['text']:_0x4b2e0b(0x12e);_0x2e985c[_0x4b2e0b(0x164)]({'command':_0x538882,'output':_0x47785c}),logger[_0x4b2e0b(0x15c)]({'command':_0x538882,'output':_0x47785c},_0x4b2e0b(0x132));}}else logger[_0x4b2e0b(0x15c)]({},_0x4b2e0b(0x12b));if(_0x2e985c['length']>0x0&&_0x2e985c['every'](_0x2daa23=>_0x2daa23[_0x4b2e0b(0x127)])){logger[_0x4b2e0b(0x15c)]({},'All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.');return;}logger[_0x4b2e0b(0x15c)]({},'Entering\x20Remix\x20Layer...');const _0x4b8c6b={'prompt':_0x2e6897,'decision':_0x2cce5c[_0x4b2e0b(0x11c)],'commandOutputs':_0x2e985c};logger[_0x4b2e0b(0x15c)]({'context':_0x4b8c6b},_0x4b2e0b(0x147));const _0x2a000b=await remixLayer(_0x4b8c6b);logger[_0x4b2e0b(0x15c)]({'finalResponse':_0x2a000b},_0x4b2e0b(0x13d)),await _0x394abc[_0x4b2e0b(0x12a)](_0x2a000b);}catch(_0x26bf61){logger[_0x4b2e0b(0x155)](_0x26bf61,_0x4b2e0b(0x113)),await _0x394abc[_0x4b2e0b(0x12a)](_0x4b2e0b(0x145));}}};async function thinkingLayer(_0x20e5e9){const _0x5100f5=a0_0xa9f26;logger['info']({'prompt':_0x20e5e9},'Thinking\x20Layer\x20received\x20prompt.');const _0x248e9c=genAI[_0x5100f5(0x12f)]({'model':_0x5100f5(0x12c)}),_0x4b9647=getCommandMap(),_0x3ec860=Array[_0x5100f5(0x139)](_0x4b9647[_0x5100f5(0x141)]())[_0x5100f5(0x15f)](_0x13faee=>_0x13faee[_0x5100f5(0x11e)]['ai']!==![])[_0x5100f5(0x11a)](_0x3834ac=>({'name':_0x3834ac[_0x5100f5(0x11e)][_0x5100f5(0x123)],'description':_0x3834ac['meta'][_0x5100f5(0x159)],'usage':_0x3834ac[_0x5100f5(0x11e)][_0x5100f5(0x153)],'direct':_0x3834ac[_0x5100f5(0x11e)][_0x5100f5(0x130)]||![],'args':(_0x3834ac[_0x5100f5(0x11e)][_0x5100f5(0x115)]||[])['map'](_0x816879=>_0x816879[_0x5100f5(0x123)]+'\x20('+_0x816879[_0x5100f5(0x159)]+')')[_0x5100f5(0x131)](',\x20')}));logger['info']({'count':_0x3ec860[_0x5100f5(0x13f)]},_0x5100f5(0x118));const _0x49c742='\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a'+JSON[_0x5100f5(0x162)](_0x3ec860,null,0x2)+'\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Don\x27t\x20add\x20prefix\x20with\x20command\x20e.g\x20\x27.weather\x27\x20you\x20shuld\x20just\x20run\x20\x27weather\x27\x0a\x0aUser\x20Prompt:\x20\x22'+_0x20e5e9+'\x22\x0a';logger[_0x5100f5(0x15c)](_0x5100f5(0x14f));try{const _0x1f7569=await _0x248e9c[_0x5100f5(0x149)](_0x49c742),_0x224458=await _0x1f7569[_0x5100f5(0x13c)][_0x5100f5(0x14d)]();logger['info']({'responseText':_0x224458},_0x5100f5(0x146));const _0x53672a=_0x224458[_0x5100f5(0x134)](/```json/g,'')[_0x5100f5(0x134)](/```/g,'')[_0x5100f5(0x125)]();logger[_0x5100f5(0x15c)]({'cleanedText':_0x53672a},_0x5100f5(0x14a));const _0x9597c3=JSON['parse'](_0x53672a);logger[_0x5100f5(0x15c)]({'jsonResponse':_0x9597c3},_0x5100f5(0x128));const _0x21e95e={'decision':_0x9597c3[_0x5100f5(0x11c)],'commands':_0x9597c3['commands']||[]};return logger['info']({'thinkingResult':_0x21e95e},_0x5100f5(0x15a)),_0x21e95e;}catch(_0x235950){return logger['error'](_0x235950,_0x5100f5(0x11b)),{'decision':_0x5100f5(0x110),'commands':[]};}}async function remixLayer(_0x2bd88b){const _0x1c4007=a0_0xa9f26;logger[_0x1c4007(0x15c)]({'context':_0x2bd88b},_0x1c4007(0x15e));const _0x1fc09e=genAI[_0x1c4007(0x12f)]({'model':_0x1c4007(0x12c)}),_0x3aed37=_0x2bd88b['commandOutputs']['filter'](_0x4f4af3=>!_0x4f4af3[_0x1c4007(0x127)]);if(_0x3aed37[_0x1c4007(0x13f)]===0x0&&_0x2bd88b[_0x1c4007(0x160)]['length']>0x0)return logger[_0x1c4007(0x15c)]({},_0x1c4007(0x133)),_0x1c4007(0x143);const _0x5aa7b5=_0x1c4007(0x13a)+_0x2bd88b['prompt']+'\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22'+_0x2bd88b[_0x1c4007(0x11c)]+_0x1c4007(0x163)+(_0x3aed37[_0x1c4007(0x11a)](_0xfacc3=>'-\x20'+_0xfacc3[_0x1c4007(0x151)]+':\x20'+_0xfacc3['output'])[_0x1c4007(0x131)]('\x0a')||_0x1c4007(0x117))+_0x1c4007(0x119);logger[_0x1c4007(0x15c)](_0x1c4007(0x122));try{const _0x11acbf=await _0x1fc09e[_0x1c4007(0x149)](_0x5aa7b5),_0x560951=await _0x11acbf['response'],_0x21750c=_0x560951[_0x1c4007(0x14d)]();return logger['info']({'response':_0x21750c},_0x1c4007(0x161)),_0x21750c;}catch(_0x4862fc){return logger['error'](_0x4862fc,_0x1c4007(0x116)),'I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.';}}