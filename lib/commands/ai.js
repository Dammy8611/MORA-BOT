function a0_0x3ee6(){const _0x3d3f55=['push','No\x20commands\x20to\x20execute.','output','replace','Remix\x20Layer\x20finished','message','ðŸ¤”\x20Thinking....','\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','Executing\x20command','Running\x20command(s):\x20','description','.ai\x20<prompt>','info','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','usage','name','decision','Command\x20returned\x20a\x20file.\x20Sending\x20directly.','generateContent','1019666rtuLUH','done','3544709Cdsgca','Thinking\x20Layer\x20received\x20prompt.','[INFO]\x20','meta','Invalid\x20or\x20empty\x20Gemini\x20JSON\x20response','update','contextInfo','Cleaned\x20Gemini\x20response','...','[Sent\x20a\x20file:\x20','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','All\x20commands\x20were\x20handled\x20directly.\x20Skipping\x20Remix\x20Layer.','audio','prompt','slice','participant','getGenerativeModel','args','filter','12lEOTYZ','9MzzRQB','text','6NUMymz','440NdzxeN','[ERROR]\x20','trim','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','isDirect','remoteJid','../memory.js','Sending\x20system\x20prompt\x20to\x20Gemini','Entering\x20Remix\x20Layer...','commandOutputs','698505HGBTNL','start','map','commands','includes','extendedTextMessage','../core/executeCommand','Sending\x20final\x20prompt\x20to\x20Gemini\x20for\x20remixing.','37672UNwvOu','8499890sHBRAL','Error\x20in\x20Gemini\x20Remix\x20Layer','Gotcha,\x20all\x20commands\x20handled.\x20âœ¨','31442268utdxTm','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','@google/generative-ai','gemini-2.5-flash','sendMessage','error','A\x20friendly\x20AI\x20assistant\x20named\x20Mora.','The\x20prompt\x20for\x20the\x20AI.','\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a','./index','length','Entering\x20Command\x20Execution\x20phase','Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20ðŸ˜µâ€ðŸ’«','Error\x20in\x20Gemini\x20Thinking\x20Layer','Remix\x20Layer\x20received\x20context.','Uhh,\x20I\x20spaced\x20out\x20for\x20a\x20second\x20there\x20ðŸ¤¯','AI\x20Thinking\x20Layer\x20Processed','AIzaSyCHDhotAUDVO7xV0C9jgJFTyf5NJYOItOo','I\x27m\x20a\x20bit\x20flustered\x20right\x20now,\x20something\x20went\x20wrong\x20while\x20I\x20was\x20trying\x20to\x20be\x20witty.','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22',',\x20JID/ID:\x20','split','direct','Generated\x20callable\x20command\x20list\x20for\x20AI','conversation','None','response','key','2426024mZMuNE','6pVEzwd','Received\x20response\x20from\x20Gemini','command','Received\x20final\x20response\x20from\x20Gemini.','from','join','stringify','Remix\x20layer\x20returned\x20empty\x20text','pushName'];a0_0x3ee6=function(){return _0x3d3f55;};return a0_0x3ee6();}const a0_0xa3eebf=a0_0x4ee7;(function(_0xb2c912,_0x5d77a2){const _0x26e3f7=a0_0x4ee7,_0x2e5e59=_0xb2c912();while(!![]){try{const _0x508b2a=parseInt(_0x26e3f7(0x18c))/0x1+parseInt(_0x26e3f7(0x1d1))/0x2*(-parseInt(_0x26e3f7(0x1e9))/0x3)+-parseInt(_0x26e3f7(0x194))/0x4*(parseInt(_0x26e3f7(0x1ea))/0x5)+-parseInt(_0x26e3f7(0x1b5))/0x6*(parseInt(_0x26e3f7(0x1d3))/0x7)+parseInt(_0x26e3f7(0x1b4))/0x8+-parseInt(_0x26e3f7(0x1e7))/0x9*(parseInt(_0x26e3f7(0x195))/0xa)+parseInt(_0x26e3f7(0x198))/0xb*(parseInt(_0x26e3f7(0x1e6))/0xc);if(_0x508b2a===_0x5d77a2)break;else _0x2e5e59['push'](_0x2e5e59['shift']());}catch(_0x1fdeec){_0x2e5e59['push'](_0x2e5e59['shift']());}}}(a0_0x3ee6,0x9ffd8));function a0_0x4ee7(_0x4ed99f,_0x1efd94){const _0x3ee693=a0_0x3ee6();return a0_0x4ee7=function(_0x4ee7c6,_0x2c855d){_0x4ee7c6=_0x4ee7c6-0x18a;let _0x2a54b4=_0x3ee693[_0x4ee7c6];return _0x2a54b4;},a0_0x4ee7(_0x4ed99f,_0x1efd94);}const {GoogleGenerativeAI}=require(a0_0xa3eebf(0x19a)),{getCommandMap}=require(a0_0xa3eebf(0x1a1)),{executeAiCommand}=require(a0_0xa3eebf(0x192)),{StatusUpdater}=require('../../utils/statusUpdater.js'),{loadMemory,saveMemory}=require(a0_0xa3eebf(0x1f0)),logger={'info':(_0x4025ce,_0x477864)=>console['log'](a0_0xa3eebf(0x1d5)+_0x477864,_0x4025ce),'error':(_0x33232a,_0x13739f)=>console[a0_0xa3eebf(0x19d)](a0_0xa3eebf(0x1eb)+_0x13739f,_0x33232a)},genAI=new GoogleGenerativeAI(a0_0xa3eebf(0x1a9));module['exports']={'meta':{'name':'ai','description':a0_0xa3eebf(0x19e),'usage':a0_0xa3eebf(0x1c9),'category':'AI','ownerOnly':![],'ai':![],'args':[{'name':'prompt','required':!![],'greedy':!![],'description':a0_0xa3eebf(0x19f)}]},'run':async({m:_0xac37e3,sock:_0x18b136,args:_0x3b0e2a,flags:_0x14542a,executeCommand:_0x19de30,metadata:_0x4fb1c5})=>{const _0x2079ab=a0_0xa3eebf,_0x1ff36a=_0xac37e3[_0x2079ab(0x1b3)][_0x2079ab(0x1ef)],_0xa8b327=_0xac37e3['key'][_0x2079ab(0x1e2)]||_0x1ff36a,_0x504d7f=_0xac37e3[_0x2079ab(0x1bd)]||null,_0x393a29=_0x3b0e2a[_0x2079ab(0x1e0)];logger[_0x2079ab(0x1ca)]({'user':_0xac37e3['pushName'],'prompt':_0x393a29},'AI\x20command\x20invoked');const _0x535ca0=new StatusUpdater(_0x18b136,_0x1ff36a);await _0x535ca0[_0x2079ab(0x18d)]();try{const _0x96b4c3=await loadMemory(_0x1ff36a,_0xa8b327);logger[_0x2079ab(0x1ca)]({},'Entering\x20Thinking\x20Layer...'),await _0x535ca0[_0x2079ab(0x1d8)](_0x2079ab(0x1c4));const _0x42d80c=await thinkingLayer(_0x393a29,_0x96b4c3,_0xac37e3,_0x4fb1c5);logger[_0x2079ab(0x1ca)](_0x42d80c,'Thinking\x20Layer\x20finished'),logger[_0x2079ab(0x1ca)]({'prompt':_0x393a29,'decision':_0x42d80c[_0x2079ab(0x1ce)],'commandsToRun':_0x42d80c[_0x2079ab(0x18f)]},_0x2079ab(0x1a8));let _0x5d0cb2=[];if(_0x42d80c['commands']&&_0x42d80c['commands'][_0x2079ab(0x1a2)]>0x0){logger[_0x2079ab(0x1ca)]({'commands':_0x42d80c['commands']},_0x2079ab(0x1a3)),await _0x535ca0[_0x2079ab(0x1d8)](_0x2079ab(0x1c7)+_0x42d80c[_0x2079ab(0x18f)]['join'](',\x20')+_0x2079ab(0x1db));for(const _0x1d0f32 of _0x42d80c[_0x2079ab(0x18f)]){logger[_0x2079ab(0x1ca)]({'commandString':_0x1d0f32},_0x2079ab(0x1c6));const _0x5e1028=_0x1d0f32[_0x2079ab(0x1ec)]()[_0x2079ab(0x1ad)](/\s+/);_0x5e1028[0x0]=_0x5e1028[0x0][_0x2079ab(0x1e1)](0x1);const _0x1de6ed=_0x5e1028[0x0],_0x256c74=await executeAiCommand({'m':_0xac37e3,'sock':_0x18b136,'tokens':['!'+_0x1de6ed,..._0x5e1028[_0x2079ab(0x1e1)](0x1)],'metadata':_0x4fb1c5});if(_0x256c74&&!_0x256c74['text']){logger[_0x2079ab(0x1ca)]({'command':_0x1de6ed,'content':_0x256c74},_0x2079ab(0x1cf)),await _0x535ca0[_0x2079ab(0x1d2)](_0x2079ab(0x1d2)),await _0x18b136[_0x2079ab(0x19c)](_0xac37e3[_0x2079ab(0x1b3)][_0x2079ab(0x1ef)],_0x256c74),_0x5d0cb2[_0x2079ab(0x1be)]({'command':_0x1de6ed,'output':_0x2079ab(0x1dc)+(_0x256c74[_0x2079ab(0x1df)]?'audio':'unknown')+']','isDirect':!![]});continue;}const _0x2a3f34=_0x256c74?_0x256c74[_0x2079ab(0x1e8)]:'No\x20textual\x20output.';_0x5d0cb2[_0x2079ab(0x1be)]({'command':_0x1de6ed,'output':_0x2a3f34}),logger[_0x2079ab(0x1ca)]({'command':_0x1de6ed,'output':_0x2a3f34},'Command\x20execution\x20finished');}}else logger[_0x2079ab(0x1ca)]({},_0x2079ab(0x1bf));if(_0x5d0cb2[_0x2079ab(0x1a2)]>0x0&&_0x5d0cb2['every'](_0x353b05=>_0x353b05[_0x2079ab(0x1ee)])){logger[_0x2079ab(0x1ca)]({},_0x2079ab(0x1de));return;}logger['info']({},_0x2079ab(0x18a));const _0x28bfd3={'prompt':_0x393a29,'decision':_0x42d80c[_0x2079ab(0x1ce)],'commandOutputs':_0x5d0cb2};logger[_0x2079ab(0x1ca)]({'context':_0x28bfd3},'Remix\x20Layer\x20context');const _0x169d21=await remixLayer(_0x28bfd3,_0xac37e3);logger[_0x2079ab(0x1ca)]({'finalResponse':_0x169d21},_0x2079ab(0x1c2)),await saveMemory(_0x1ff36a,_0xa8b327,_0x393a29,_0x169d21,_0x504d7f,_0x5d0cb2),await _0x535ca0['done'](_0x169d21);}catch(_0x45da34){logger[_0x2079ab(0x19d)](_0x45da34,'AI\x20command\x20failed'),await _0x535ca0[_0x2079ab(0x1d2)](_0x2079ab(0x1a4));}}};async function thinkingLayer(_0x23f77f,_0x4abc01,_0x9bed5c,_0x34c6d5){const _0x58c453=a0_0xa3eebf;logger[_0x58c453(0x1ca)]({'prompt':_0x23f77f},_0x58c453(0x1d4));const _0x351bc3=genAI[_0x58c453(0x1e3)]({'model':_0x58c453(0x19b)}),_0x4d7c60=getCommandMap(),_0x1b6ea5=Array[_0x58c453(0x1b9)](_0x4d7c60['values']())[_0x58c453(0x1e5)](_0x2ed64a=>_0x2ed64a[_0x58c453(0x1d6)]['ai']!==![])['map'](_0x438546=>({'name':_0x438546['meta']['name'],'description':_0x438546[_0x58c453(0x1d6)][_0x58c453(0x1c8)],'usage':_0x438546[_0x58c453(0x1d6)][_0x58c453(0x1cc)],'direct':_0x438546[_0x58c453(0x1d6)][_0x58c453(0x1ae)]||![],'args':(_0x438546[_0x58c453(0x1d6)][_0x58c453(0x1e4)]||[])['map'](_0xd240a3=>_0xd240a3[_0x58c453(0x1cd)]+'\x20('+_0xd240a3[_0x58c453(0x1c8)]+')')[_0x58c453(0x1ba)](',\x20')}));logger['info']({'count':_0x1b6ea5['length']},_0x58c453(0x1af));const _0x32c021='\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a'+JSON[_0x58c453(0x1bb)](_0x4abc01,null,0x2)+_0x58c453(0x199)+JSON[_0x58c453(0x1bb)](_0x1b6ea5,null,0x2)+_0x58c453(0x1a0)+(_0x9bed5c[_0x58c453(0x1c3)][_0x58c453(0x191)]?.[_0x58c453(0x1d9)]?.['quotedMessage']?.[_0x58c453(0x1b0)]||'None')+_0x58c453(0x1c5)+_0x9bed5c[_0x58c453(0x1bd)]+_0x58c453(0x1ac)+(_0x9bed5c[_0x58c453(0x1b3)][_0x58c453(0x1e2)]||_0x9bed5c[_0x58c453(0x1b3)][_0x58c453(0x1ef)])+'\x0a\x0aUser\x20Prompt:\x20\x22'+_0x23f77f+'\x22\x0a';logger[_0x58c453(0x1ca)](_0x58c453(0x1f1));try{const _0xceaa42=await _0x351bc3[_0x58c453(0x1d0)](_0x32c021),_0x48092c=await _0xceaa42['response'][_0x58c453(0x1e8)]();logger['info']({'responseText':_0x48092c},_0x58c453(0x1b6));const _0x1d1b0b=_0x48092c[_0x58c453(0x1c1)](/```json/g,'')[_0x58c453(0x1c1)](/```/g,'')['trim']();logger[_0x58c453(0x1ca)]({'cleanedText':_0x1d1b0b},_0x58c453(0x1da));if(!_0x1d1b0b||!_0x1d1b0b['includes']('{')||!_0x1d1b0b[_0x58c453(0x190)]('}'))return logger['error']({'cleanedText':_0x1d1b0b},_0x58c453(0x1d7)),{'decision':'I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do\x20from\x20that.','commands':[]};const _0x288677=JSON['parse'](_0x1d1b0b);logger[_0x58c453(0x1ca)]({'jsonResponse':_0x288677},'Parsed\x20JSON\x20response');const _0x2f0ed9={'decision':_0x288677[_0x58c453(0x1ce)],'commands':_0x288677['commands']||[]};return logger['info']({'thinkingResult':_0x2f0ed9},'Returning\x20from\x20Thinking\x20Layer'),_0x2f0ed9;}catch(_0x11573b){return logger[_0x58c453(0x19d)](_0x11573b,_0x58c453(0x1a5)),{'decision':_0x58c453(0x1ed),'commands':[]};}}async function remixLayer(_0x427c70,_0x10ae57){const _0x5a9fd2=a0_0xa3eebf;logger[_0x5a9fd2(0x1ca)]({'context':_0x427c70},_0x5a9fd2(0x1a6));const _0x197cd3=genAI[_0x5a9fd2(0x1e3)]({'model':_0x5a9fd2(0x19b)}),_0x4ff8cc=_0x427c70[_0x5a9fd2(0x18b)][_0x5a9fd2(0x1e5)](_0x453caf=>!_0x453caf['isDirect']);if(_0x4ff8cc[_0x5a9fd2(0x1a2)]===0x0&&_0x427c70[_0x5a9fd2(0x18b)][_0x5a9fd2(0x1a2)]>0x0)return logger[_0x5a9fd2(0x1ca)]({},'All\x20command\x20outputs\x20were\x20handled\x20directly.\x20Skipping\x20Remix.'),_0x5a9fd2(0x197);const _0x19d846=_0x5a9fd2(0x1cb)+_0x427c70[_0x5a9fd2(0x1e0)]+_0x5a9fd2(0x1ab)+_0x427c70['decision']+'\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a'+(_0x4ff8cc[_0x5a9fd2(0x18e)](_0x573628=>'-\x20'+_0x573628[_0x5a9fd2(0x1b7)]+':\x20'+_0x573628[_0x5a9fd2(0x1c0)])[_0x5a9fd2(0x1ba)]('\x0a')||_0x5a9fd2(0x1b1))+_0x5a9fd2(0x1dd)+_0x10ae57[_0x5a9fd2(0x1bd)]+',\x20JID/ID:\x20'+(_0x10ae57['key'][_0x5a9fd2(0x1e2)]||_0x10ae57[_0x5a9fd2(0x1b3)][_0x5a9fd2(0x1ef)])+'\x0a';logger[_0x5a9fd2(0x1ca)](_0x5a9fd2(0x193));try{const _0x35731=await _0x197cd3[_0x5a9fd2(0x1d0)](_0x19d846),_0x829205=await _0x35731[_0x5a9fd2(0x1b2)],_0x223d7a=_0x829205[_0x5a9fd2(0x1e8)]()?.[_0x5a9fd2(0x1ec)]();if(!_0x223d7a)return logger[_0x5a9fd2(0x19d)]({},_0x5a9fd2(0x1bc)),_0x5a9fd2(0x1a7);return logger['info']({'response':_0x223d7a},_0x5a9fd2(0x1b8)),_0x223d7a;}catch(_0x4115ab){return logger[_0x5a9fd2(0x19d)](_0x4115ab,_0x5a9fd2(0x196)),_0x5a9fd2(0x1aa);}}