const a0_0x13deb8=a0_0x56d1;(function(_0x25f22c,_0x4dc578){const _0x143ca3=a0_0x56d1,_0x1efe55=_0x25f22c();while(!![]){try{const _0x1bb95a=-parseInt(_0x143ca3(0x212))/0x1*(-parseInt(_0x143ca3(0x1d7))/0x2)+parseInt(_0x143ca3(0x1f3))/0x3+-parseInt(_0x143ca3(0x1f6))/0x4+-parseInt(_0x143ca3(0x217))/0x5*(-parseInt(_0x143ca3(0x1d0))/0x6)+-parseInt(_0x143ca3(0x22b))/0x7*(parseInt(_0x143ca3(0x1e4))/0x8)+parseInt(_0x143ca3(0x1e6))/0x9*(parseInt(_0x143ca3(0x203))/0xa)+-parseInt(_0x143ca3(0x1f7))/0xb*(parseInt(_0x143ca3(0x211))/0xc);if(_0x1bb95a===_0x4dc578)break;else _0x1efe55['push'](_0x1efe55['shift']());}catch(_0x292f3d){_0x1efe55['push'](_0x1efe55['shift']());}}}(a0_0x1fb5,0x2d3fa));const {getCommandMap}=require(a0_0x13deb8(0x202)),{executeAiCommand}=require(a0_0x13deb8(0x1f5)),{StatusUpdater}=require('../../utils/statusUpdater.js'),{loadMemory,saveMemory}=require('../memory.js'),lidToJid=require('../../utils/lidToJid.js'),normalizeMentions=require(a0_0x13deb8(0x1f8)),logger={'info':(_0x13bc56,_0x21c4d6)=>console[a0_0x13deb8(0x220)](a0_0x13deb8(0x204)+_0x21c4d6,_0x13bc56),'error':(_0xdea058,_0x2da807)=>console[a0_0x13deb8(0x224)](a0_0x13deb8(0x214)+_0x2da807,_0xdea058)};async function processAIRequest({m:_0x5b7124,sock:_0x2e36bc,args:_0x46eb80,flags:_0x175993,metadata:_0x2d9b99,aiProvider:_0x590264,aiName:aiName='AI',statusEmoji:statusEmoji='ðŸ¤–'}){const _0x24eef0=a0_0x13deb8,_0x3e161c=_0x5b7124[_0x24eef0(0x1d6)][_0x24eef0(0x1de)],_0x153afb=_0x5b7124[_0x24eef0(0x1d6)][_0x24eef0(0x1f0)]||_0x3e161c,_0x967d7c=_0x5b7124[_0x24eef0(0x218)]||null;let _0x277479=[],_0x2993cb=_0x46eb80[_0x24eef0(0x1ef)];if(_0x3e161c[_0x24eef0(0x1ed)](_0x24eef0(0x1fd))&&_0x5b7124[_0x24eef0(0x1dd)]?.[_0x24eef0(0x1fa)]?.[_0x24eef0(0x226)]?.['mentionedJid']){const _0x16b8d7=_0x5b7124[_0x24eef0(0x1dd)]['extendedTextMessage'][_0x24eef0(0x226)][_0x24eef0(0x225)];console['log'](_0x24eef0(0x1ea),_0x16b8d7);const {normalizedText:_0x321f8b,mentions:_0x2b824e}=await normalizeMentions(_0x2993cb,_0x16b8d7,_0x2d9b99,lidToJid);_0x2993cb=_0x321f8b,_0x277479=_0x2b824e;}logger[_0x24eef0(0x1f2)]({'user':_0x5b7124[_0x24eef0(0x218)],'prompt':_0x2993cb},aiName+_0x24eef0(0x22a));const _0x3e6b84=new StatusUpdater(_0x2e36bc,_0x3e161c);await _0x3e6b84[_0x24eef0(0x20c)]();try{const _0x51daf3=await loadMemory(_0x3e161c,_0x153afb);logger[_0x24eef0(0x1f2)]({},_0x24eef0(0x1e9)),await _0x3e6b84[_0x24eef0(0x221)](statusEmoji+_0x24eef0(0x20f));const _0xb8c7c7=await thinkingLayer(_0x2993cb,_0x51daf3,_0x5b7124,_0x2d9b99,_0x590264);logger[_0x24eef0(0x1f2)](_0xb8c7c7,_0x24eef0(0x21a)),logger[_0x24eef0(0x1f2)]({'prompt':_0x2993cb,'decision':_0xb8c7c7[_0x24eef0(0x1d4)],'commandsToRun':_0xb8c7c7[_0x24eef0(0x1da)]},aiName+'\x20Thinking\x20Layer\x20Processed');let _0x57438e=[];if(_0xb8c7c7[_0x24eef0(0x1da)]&&_0xb8c7c7[_0x24eef0(0x1da)][_0x24eef0(0x1dc)]>0x0){logger[_0x24eef0(0x1f2)]({'commands':_0xb8c7c7['commands']},_0x24eef0(0x1db)),await _0x3e6b84[_0x24eef0(0x221)](_0x24eef0(0x20a)+_0xb8c7c7[_0x24eef0(0x1da)][_0x24eef0(0x21b)](',\x20')+'...');for(const _0xac7136 of _0xb8c7c7[_0x24eef0(0x1da)]){logger[_0x24eef0(0x1f2)]({'commandString':_0xac7136},_0x24eef0(0x1f9));const _0x1c96c6=_0xac7136[_0x24eef0(0x1e7)]()[_0x24eef0(0x1e0)](/\s+/);_0x1c96c6[0x0]=_0x1c96c6[0x0][_0x24eef0(0x21d)](0x1);const _0x46344f=_0x1c96c6[0x0],_0x59786a=await executeAiCommand({'m':_0x5b7124,'sock':_0x2e36bc,'tokens':['!'+_0x46344f,..._0x1c96c6['slice'](0x1)],'metadata':_0x2d9b99});_0x59786a&&_0x59786a[_0x24eef0(0x227)]!==_0x24eef0(0x1d5)&&(logger[_0x24eef0(0x1f2)]({'command':_0x46344f,'type':_0x59786a['type']},_0x24eef0(0x1ff)),await _0x2e36bc[_0x24eef0(0x201)](_0x5b7124['key'][_0x24eef0(0x1de)],_0x59786a['raw'])),_0x57438e[_0x24eef0(0x222)]({'command':_0x46344f,'type':_0x59786a[_0x24eef0(0x227)],'output':_0x59786a[_0x24eef0(0x1eb)]||_0x59786a[_0x24eef0(0x1d5)]}),logger['info']({'command':_0x46344f,'output':_0x59786a},_0x24eef0(0x216));}}else logger[_0x24eef0(0x1f2)]({},'No\x20commands\x20to\x20execute.');logger[_0x24eef0(0x1f2)]({},'Entering\x20Remix\x20Layer...');const _0x2f1821={'prompt':_0x2993cb,'decision':_0xb8c7c7['decision'],'commandOutputs':_0x57438e};logger['info']({'context':_0x2f1821},_0x24eef0(0x1e5));const _0x3066cd=await remixLayer(_0x2f1821,_0x5b7124,_0x590264,aiName);logger[_0x24eef0(0x1f2)]({'finalResponse':_0x3066cd},'Remix\x20Layer\x20finished');const _0xde2d50=await extractJidsFromText(_0x3066cd,_0x2d9b99);console[_0x24eef0(0x220)](_0xde2d50);const _0x19e9a5=Array['from'](new Set([..._0x277479,..._0xde2d50]));await saveMemory(_0x3e161c,_0x153afb,_0x2993cb,_0x3066cd,_0x967d7c,_0x57438e,_0x19e9a5),await _0x3e6b84['done']({'text':_0x3066cd,'mentions':_0x19e9a5});}catch(_0x44b615){logger[_0x24eef0(0x224)](_0x44b615,aiName+_0x24eef0(0x1ec)),await _0x3e6b84['done']('Sorry,\x20something\x20went\x20wrong\x20with\x20my\x20circuits.\x20ðŸ˜µâ€ðŸ’«');}}function extractJidsFromText(_0x4b2b8c,_0x59d021){const _0x179183=a0_0x13deb8,_0x152c6c=/@[0-9]+/g,_0xde9d83=/[0-9]+@s\.whatsapp\.net/g,_0x32bebe=[..._0x4b2b8c[_0x179183(0x213)](_0x152c6c)||[],..._0x4b2b8c[_0x179183(0x213)](_0xde9d83)||[]];return Promise[_0x179183(0x215)](_0x32bebe[_0x179183(0x1e8)](_0x23ef0f=>lidToJid(_0x23ef0f,_0x59d021)['split']('@')[0x1]+_0x179183(0x1e1)));}function a0_0x1fb5(){const _0x3e5566=['message','remoteJid','\x22\x0aMy\x20internal\x20thought\x20process:\x20\x22','split','@s.whatsapp.net','replace','\x0a\x20\x20You\x20are\x20Mora,\x20a\x20smart,\x20witty\x20Gen\x20Z\x20assistant\x20powered\x20by\x20','872GGDJxk','Remix\x20Layer\x20context','600291BlFssh','trim','map','Entering\x20Thinking\x20Layer...','Raw\x20lids:','placeholder','\x20command\x20failed','endsWith','I\x27m\x20a\x20bit\x20flustered\x20rn\x20ðŸ˜µâ€ðŸ’«','prompt','participant','.\x0aYour\x20personality\x20is\x20helpful,\x20a\x20little\x20sassy,\x20and\x20you\x20use\x20modern\x20slang.\x0aBased\x20on\x20the\x20following\x20information,\x20craft\x20a\x20response\x20to\x20the\x20user.\x0a\x0a---\x0aOriginal\x20User\x20Prompt:\x20\x22','info','86697vFCxix',',\x20JID/ID:\x20','../core/executeCommand','4276hrMViy','22YvEELJ','../../utils/normalize.js','Executing\x20command','extendedTextMessage','Error\x20in\x20Remix\x20Layer','There\x20was\x20an\x20error\x20in\x20my\x20thinking\x20process.','@g.us','\x22\x0aCommands\x20I\x20ran\x20and\x20their\x20output:\x0a','Command\x20returned\x20media.\x20Sending\x20directly.','name','sendMessage','../commands/index','50ZIembE','[INFO]\x20','meta','args','\x0a---\x0a\x0aYour\x20response\x20should\x20be\x20natural\x20and\x20conversational.\x20Don\x27t\x20just\x20state\x20the\x20facts,\x20remix\x20them\x20into\x20a\x20proper\x20answer.\x0aMake\x20your\x20responses\x20short\x20and\x20concise\x20like\x20you\x20are\x20talking\x20to\x20a\x20friend\x0aDont\x20make\x20refrences\x20to\x20your\x20thinking\x20layer,\x20your\x20output\x20should\x20be\x20as\x20though\x20you\x20already\x20know\x20it\x0a\x0aOther\x20information:\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20','remix','Error\x20in\x20AI\x20Thinking\x20Layer','Running\x20command(s):\x20','exports','start','stringify','quotedMessage','\x20Thinking....','I\x20couldn\x27t\x20figure\x20out\x20what\x20to\x20do.','2995752VrEiEy','1slhrFe','match','[ERROR]\x20','all','Command\x20execution\x20finished','1766705XqSdsE','pushName','includes','Thinking\x20Layer\x20finished','join','conversation','slice','Remix\x20Layer\x20received\x20context.','\x0a\x0aUser\x20Prompt:\x20\x22','log','update','push','description','error','mentionedJid','contextInfo','type','filter','\x0aYou\x20are\x20the\x20\x22Thinking\x20Layer\x22\x20for\x20a\x20bot\x20named\x20Mora.\x20Your\x20job\x20is\x20to\x20analyze\x20a\x20user\x27s\x20prompt\x20and\x20decide\x20which,\x20if\x20any,\x20of\x20the\x20available\x20commands\x20should\x20be\x20executed.\x0a\x0aYou\x20must\x20respond\x20in\x20a\x20JSON\x20format\x20with\x20two\x20properties:\x0a1.\x20\x22decision\x22:\x20A\x20string\x20explaining\x20your\x20reasoning.\x0a2.\x20\x22commands\x22:\x20An\x20array\x20of\x20strings,\x20where\x20each\x20string\x20is\x20the\x20full\x20command\x20to\x20execute\x20(e.g.,\x20\x22.weather\x20London\x22).\x0a\x0aHere\x20is\x20the\x20recent\x20conversation\x20history\x20(if\x20any):\x0a','\x20command\x20invoked','11669WCLeBw','6ukIJXu','command','\x0a\x0aHere\x20are\x20the\x20available\x20commands\x20you\x20can\x20use:\x0a','commandOutputs','decision','text','key','303334BYBMxT','None','from','commands','Entering\x20Command\x20Execution\x20phase','length'];a0_0x1fb5=function(){return _0x3e5566;};return a0_0x1fb5();}async function thinkingLayer(_0x380d3b,_0x3b1c0f,_0x2c5e78,_0x566e9c,_0x8cf99c){const _0x493de4=a0_0x13deb8;logger[_0x493de4(0x1f2)]({'prompt':_0x380d3b},'Thinking\x20Layer\x20received\x20prompt.');const _0x22da0e=getCommandMap(),_0x360e17=Array[_0x493de4(0x1d9)](_0x22da0e['values']())[_0x493de4(0x228)](_0x38e124=>_0x38e124[_0x493de4(0x205)]['ai']!==![])[_0x493de4(0x1e8)](_0x143e7e=>({'name':_0x143e7e['meta'][_0x493de4(0x200)],'description':_0x143e7e[_0x493de4(0x205)][_0x493de4(0x223)],'usage':_0x143e7e[_0x493de4(0x205)]['usage'],'direct':_0x143e7e[_0x493de4(0x205)]['direct']||![],'args':(_0x143e7e['meta'][_0x493de4(0x206)]||[])[_0x493de4(0x1e8)](_0x302f6a=>_0x302f6a[_0x493de4(0x200)]+'\x20('+_0x302f6a[_0x493de4(0x223)]+')')[_0x493de4(0x21b)](',\x20')})),_0x2e5ca3=_0x493de4(0x229)+JSON[_0x493de4(0x20d)](_0x3b1c0f,null,0x2)+_0x493de4(0x1d2)+JSON[_0x493de4(0x20d)](_0x360e17,null,0x2)+'\x0a\x0aMessage\x20reply\x20(if\x20any).\x20If\x20null\x20then\x20reply\x20is\x20an\x20image\x20or\x20video\x20you\x20can\x27t\x20see\x20those\x20yet:\x0a'+(_0x2c5e78[_0x493de4(0x1dd)][_0x493de4(0x1fa)]?.[_0x493de4(0x226)]?.[_0x493de4(0x20e)]?.[_0x493de4(0x21c)]||'None')+'\x0a\x0aAnalyze\x20the\x20user\x27s\x20prompt\x20and\x20determine\x20the\x20most\x20appropriate\x20command(s)\x20to\x20run.\x0a-\x20If\x20a\x20command\x20needs\x20arguments,\x20extract\x20them\x20from\x20the\x20prompt.\x0a-\x20Understand\x20the\x20users\x20prompt\x20first\x20and\x20command\x20argument.\x20Don\x27t\x20just\x20use\x20the\x20users\x20prompt\x20word\x20for\x20word\x0a-\x20If\x20the\x20prompt\x20is\x20just\x20a\x20greeting\x20or\x20a\x20general\x20chat\x20message,\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20Do\x20not\x20try\x20to\x20run\x20commands\x20that\x20are\x20not\x20on\x20the\x20list.\x0a-\x20If\x20the\x20user\x20asks\x20for\x20something\x20that\x20requires\x20a\x20command,\x20but\x20doesn\x27t\x20provide\x20the\x20necessary\x20arguments\x20(e.g.,\x20\x22.weather\x22),\x20ask\x20them\x20for\x20the\x20missing\x20information\x20in\x20your\x20\x22decision\x22\x20and\x20return\x20an\x20empty\x20\x22commands\x22\x20array.\x0a-\x20If\x20a\x20user\x20mentions\x20another\x20user\x20for\x20example\x20@2349134622805\x20You\x20can\x20also\x20mention\x20the\x20user\x20as\x20well\x20using\x20the\x20same\x20format.\x20Tell\x20this\x20to\x20your\x20next\x20layer\x0a-\x20If\x20the\x20user\x20asks\x20or\x20responds\x20to\x20something\x20in\x20the\x20recent\x20conversation\x20history,\x20your\x20response\x20decision\x20should\x20be\x20detailed\x20because\x20your\x20remix\x20layer\x20has\x20no\x20access\x20to\x20the\x20previuos\x20memory\x20and\x20so\x20it\x20knows\x20what\x20the\x20context\x20is\x20exactly.\x0a-\x20Make\x20your\x20decision\x20very\x20detailed\x20because\x20you\x20are\x20the\x20brain\x20of\x20a\x20system\x20and\x20other\x20components\x20won\x27t\x20work\x20well\x20if\x20the\x20brain\x20provides\x20very\x20little\x20or\x20insufficient\x20information\x0a\x0aOther\x20information:\x0a-\x20Your\x20maker/developer\x20is\x20Dtechy,\x20his\x20number\x20is\x202349134622805,\x20JID/ID:\x202349134622805@s.whatsapp.net\x0a-\x20Your\x20name\x20is\x20mora\x0a-\x20Your\x20current\x20user\x20is\x20'+_0x2c5e78[_0x493de4(0x218)]+_0x493de4(0x1f4)+(_0x2c5e78[_0x493de4(0x1d6)][_0x493de4(0x1f0)]||_0x2c5e78[_0x493de4(0x1d6)][_0x493de4(0x1de)])+_0x493de4(0x21f)+_0x380d3b+'\x22\x0a';try{const _0x2d75bc=await _0x8cf99c(_0x2e5ca3,'thinking'),_0x210d83=_0x2d75bc['replace'](/```json/g,'')[_0x493de4(0x1e2)](/```/g,'')[_0x493de4(0x1e7)]();if(!_0x210d83[_0x493de4(0x219)]('{'))return{'decision':_0x493de4(0x210),'commands':[]};const _0x5b548a=JSON['parse'](_0x210d83);return{'decision':_0x5b548a[_0x493de4(0x1d4)],'commands':_0x5b548a[_0x493de4(0x1da)]||[]};}catch(_0x3c5de8){return logger[_0x493de4(0x224)](_0x3c5de8,_0x493de4(0x209)),{'decision':_0x493de4(0x1fc),'commands':[]};}}async function remixLayer(_0x21a6f8,_0xf6d2f2,_0x116a0a,_0xb8d52d){const _0x1f21ee=a0_0x13deb8;logger[_0x1f21ee(0x1f2)]({'context':_0x21a6f8},_0x1f21ee(0x21e));const _0x5842ff=_0x21a6f8[_0x1f21ee(0x1d3)][_0x1f21ee(0x1e8)](_0x4e515f=>'-\x20'+_0x4e515f[_0x1f21ee(0x1d1)]+':\x20'+_0x4e515f['output'])[_0x1f21ee(0x21b)]('\x0a'),_0xd8b05d=_0x1f21ee(0x1e3)+_0xb8d52d+_0x1f21ee(0x1f1)+_0x21a6f8[_0x1f21ee(0x1ef)]+_0x1f21ee(0x1df)+_0x21a6f8[_0x1f21ee(0x1d4)]+_0x1f21ee(0x1fe)+(_0x5842ff||_0x1f21ee(0x1d8))+_0x1f21ee(0x207)+_0xf6d2f2[_0x1f21ee(0x218)]+_0x1f21ee(0x1f4)+(_0xf6d2f2[_0x1f21ee(0x1d6)][_0x1f21ee(0x1f0)]||_0xf6d2f2[_0x1f21ee(0x1d6)][_0x1f21ee(0x1de)])+'\x0a';try{const _0xb505a3=await _0x116a0a(_0xd8b05d,_0x1f21ee(0x208));return _0xb505a3?.[_0x1f21ee(0x1e7)]()||'Here\x20you\x20go\x20âœ¨';}catch(_0x359809){return logger[_0x1f21ee(0x224)](_0x359809,_0x1f21ee(0x1fb)),_0x1f21ee(0x1ee);}}function a0_0x56d1(_0x1e70e6,_0x26bbb3){const _0x1fb518=a0_0x1fb5();return a0_0x56d1=function(_0x56d134,_0x369216){_0x56d134=_0x56d134-0x1d0;let _0x528663=_0x1fb518[_0x56d134];return _0x528663;},a0_0x56d1(_0x1e70e6,_0x26bbb3);}module[a0_0x13deb8(0x20b)]={'processAIRequest':processAIRequest,'extractJidsFromText':extractJidsFromText,'thinkingLayer':thinkingLayer,'remixLayer':remixLayer};