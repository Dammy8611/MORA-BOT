const a0_0x524adc=a0_0x25ed;(function(_0x19c21b,_0x48f94f){const _0x50dd69=a0_0x25ed,_0x19d32a=_0x19c21b();while(!![]){try{const _0x5ab9a3=parseInt(_0x50dd69(0x1ae))/0x1+parseInt(_0x50dd69(0x1ad))/0x2*(-parseInt(_0x50dd69(0x1c1))/0x3)+parseInt(_0x50dd69(0x18e))/0x4*(parseInt(_0x50dd69(0x194))/0x5)+parseInt(_0x50dd69(0x1a3))/0x6+-parseInt(_0x50dd69(0x1b2))/0x7*(parseInt(_0x50dd69(0x1d3))/0x8)+-parseInt(_0x50dd69(0x1d5))/0x9+-parseInt(_0x50dd69(0x1a6))/0xa;if(_0x5ab9a3===_0x48f94f)break;else _0x19d32a['push'](_0x19d32a['shift']());}catch(_0x9ba7c9){_0x19d32a['push'](_0x19d32a['shift']());}}}(a0_0x1653,0x50729));const fs=require('fs'),path=require('path'),{GoogleGenerativeAI}=require(a0_0x524adc(0x1a0)),{parseArgs}=require('../utils/parseArgs'),{resolveCommand}=require(a0_0x524adc(0x1a1)),{settings:botSettings}=require(a0_0x524adc(0x18c)),{StatusUpdater}=require(a0_0x524adc(0x1ce)),API_KEYS_FILE=path[a0_0x524adc(0x17f)](__dirname,'..',a0_0x524adc(0x1cb));function loadApiKeys(){const _0xc28d8a=a0_0x524adc;if(!fs[_0xc28d8a(0x19d)](API_KEYS_FILE))throw new Error(_0xc28d8a(0x1d8));return fs['readFileSync'](API_KEYS_FILE,_0xc28d8a(0x1c7))[_0xc28d8a(0x18b)](/\r?\n/)[_0xc28d8a(0x17d)](Boolean);}const apiKeys=loadApiKeys();let currentKeyIndex=0x0;function setupGenAI(){const _0x246e8f=a0_0x524adc,_0x270b7e=apiKeys[currentKeyIndex],_0x2539e1=new GoogleGenerativeAI(_0x270b7e);return _0x2539e1['getGenerativeModel']({'model':_0x246e8f(0x1b1)});}let model=setupGenAI();function rotateKey(){const _0xdcd1d2=a0_0x524adc;currentKeyIndex=(currentKeyIndex+0x1)%apiKeys[_0xdcd1d2(0x1a5)],model=setupGenAI(),console['log']('Switched\x20to\x20key\x20'+(currentKeyIndex+0x1)+_0xdcd1d2(0x186)+apiKeys[_0xdcd1d2(0x1a5)]);}const persona=a0_0x524adc(0x1bb),MEM_FILE=path[a0_0x524adc(0x17f)](__dirname,'..',a0_0x524adc(0x18f)),REM_FILE=path[a0_0x524adc(0x17f)](__dirname,'..',a0_0x524adc(0x1cd)),loadJson=(_0x4483c9,_0x45cb24={})=>fs[a0_0x524adc(0x19d)](_0x4483c9)?JSON['parse'](fs[a0_0x524adc(0x1c9)](_0x4483c9,a0_0x524adc(0x1c7))):_0x45cb24,saveJson=(_0x3b1f4e,_0x2c9938)=>fs['writeFileSync'](_0x3b1f4e,JSON['stringify'](_0x2c9938,null,0x2)),MEMORY=loadJson(MEM_FILE,{}),REMEMBER=loadJson(REM_FILE,{'users':{},'global':''}),MAX_MEMORY=0xf,addMemory=(_0xfcd79d,_0x512a76,_0x1479fa)=>{const _0x4eaa5f=a0_0x524adc;if(!MEMORY[_0xfcd79d])MEMORY[_0xfcd79d]=[];MEMORY[_0xfcd79d]['push']({'role':_0x512a76,'msg':_0x1479fa,'ts':Date[_0x4eaa5f(0x182)]()});if(MEMORY[_0xfcd79d][_0x4eaa5f(0x1a5)]>MAX_MEMORY)MEMORY[_0xfcd79d]['shift']();saveJson(MEM_FILE,MEMORY);},getMemory=_0x73b686=>(MEMORY[_0x73b686]||[])['slice'](-MAX_MEMORY)[a0_0x524adc(0x19e)](_0x4dbf98=>_0x4dbf98[a0_0x524adc(0x18d)]+':\x20'+_0x4dbf98[a0_0x524adc(0x1d1)])[a0_0x524adc(0x17f)]('\x0a');async function runCommand(_0x4033c2,_0x50766c,_0x578b35,_0xf08934,_0x5abd2b){const _0x329ab1=a0_0x524adc;console[_0x329ab1(0x1b8)]('[runCommand]\x20Trying\x20to\x20resolve:',_0x4033c2);const _0x3fc6f3=resolveCommand(_0x4033c2);console[_0x329ab1(0x1b8)](_0x329ab1(0x187),_0x3fc6f3?.['command']?.[_0x329ab1(0x1b7)]?.[_0x329ab1(0x1b3)]||_0x329ab1(0x1d2));if(!_0x3fc6f3)return{'output':null,'directUsed':![]};const {command:_0x54fd8b}=_0x3fc6f3,_0x5ca5be=_0x50766c[_0x329ab1(0x1ba)]()[_0x329ab1(0x18b)](/\s+/),{args:_0x5a96d3,flags:_0x307647}=parseArgs(_0x5ca5be,_0x54fd8b[_0x329ab1(0x1b7)][_0x329ab1(0x185)]||[]);let _0x101bb6='',_0xce419c=![];const _0x45d938={'sendMessage':async(_0x2973e0,_0x1cf3ec)=>{const _0x3424c8=_0x329ab1,_0x3a5a28=typeof _0x1cf3ec===_0x3424c8(0x183)?_0x1cf3ec:_0x1cf3ec['text']||'';_0x101bb6+=_0x3a5a28,_0x54fd8b[_0x3424c8(0x1b7)][_0x3424c8(0x1a7)]===!![]&&(await _0xf08934[_0x3424c8(0x1ac)](_0x578b35,_0x1cf3ec),_0xce419c=!![]);}};try{await _0x54fd8b[_0x329ab1(0x17e)]({'m':{'key':{'remoteJid':_0x578b35},'message':{'extendedTextMessage':{'contextInfo':{'quotedMessage':_0x5abd2b}}}},'sock':_0x45d938,'args':_0x5a96d3,'flags':_0x307647,'executeCommand':()=>{}});if(!_0x101bb6[_0x329ab1(0x1ba)]())_0x101bb6='(command\x20ran\x20but\x20gave\x20no\x20output)';}catch(_0x25d2ac){_0x101bb6='âŒ\x20'+(_0x25d2ac['message']||_0x329ab1(0x19a));}return{'output':_0x101bb6[_0x329ab1(0x1ba)](),'directUsed':_0xce419c};}function a0_0x25ed(_0x17d246,_0x8b6dc3){const _0x1653e7=a0_0x1653();return a0_0x25ed=function(_0x25ed54,_0x2eaf09){_0x25ed54=_0x25ed54-0x17b;let _0x371d8a=_0x1653e7[_0x25ed54];return _0x371d8a;},a0_0x25ed(_0x17d246,_0x8b6dc3);}function a0_0x1653(){const _0x173c7e=['remoteJid','apiKeys.txt\x20not\x20found','isArray','update','filter','run','join','error','âœ…\x20Command(s)\x20completed','now','string','User:\x20','args','\x20of\x20','[runCommand]\x20Resolved\x20to:','Talk\x20to\x20MORA-AI','Error\x20extracting\x20commands:','commandsToRun\x20is\x20not\x20an\x20array:','split','../settings','role','4VposGl','ai_memory.json','pow','quotedMessage','\x20\x0a\x0a>\x20MORA\x20AI.\x20Generated\x20by\x20AI.\x20Don\x27t\x20take\x20responses\x20too\x20seriously','\x0a\x0aUser:\x20','2203415RdDHhU','response','user','contextInfo','parse','Error\x20with\x20current\x20API\x20key:','Command\x20failed','.ai\x20<prompt>','Failed\x20to\x20process\x20your\x20request.','existsSync','map','global','@google/generative-ai','../commands','done','3646476Wlrwyt','extendedTextMessage','length','2925610oZhKUk','direct','text','\x0a\x0aYou\x20are\x20','key','âš™ï¸\x20Running\x20/','sendMessage','102236tsMyZD','305668qxZutK','.\x0aUser\x20said:\x20\x22','ownerName','gemini-2.5-flash','75229CTtiHE','name','\x0aReply\x20with\x20Gen-Z\x20style\x20in\x201â€“2\x20lines.','toLocaleString','Command\x20used\x20direct:true\x20â€”\x20skipping\x20summary\x20AI\x20reply','meta','log','push','trim','You\x27re\x20a\x20smart,\x20witty,\x20Gen-Z\x20chatbot\x20with\x20a\x20chill,\x20upbeat\x20tone.\x0aYou\x20use\x20modern\x20slang\x20casually\x20(e.g.,\x20\x22bet\x22,\x20\x22vibe\x22,\x20\x22real\x20talk\x22,\x20\x22fr\x22,\x20\x22no\x20cap\x22\x20etc.\x20Use\x20sensibly).\x0aYou\x27re\x20still\x20helpful\x20and\x20concise\x20â€”\x20keep\x20replies\x20short\x20and\x20energetic.\x20ðŸŽ§ðŸ”¥',',\x20owned\x20by\x20','participant','\x22\x0aCommand\x20output:\x0a','\x0a\x0aFor\x20each\x20command,\x20generate\x20useful\x20arguments\x20based\x20on\x20what\x20the\x20user\x20is\x20asking.\x20Expand\x20short\x20or\x20vague\x20requests\x20into\x20rich,\x20descriptive\x20arguments.\x0aFor\x20example,\x20if\x20a\x20user\x20says:\x0a\x22make\x20a\x20detailed\x20image\x20of\x20a\x20cat\x22\x0a\x0aYou\x20should\x20return:\x0a[\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22image\x22,\x0a\x20\x20\x20\x20\x22args\x22:\x20\x22a\x20highly\x20detailed\x20digital\x20painting\x20of\x20a\x20cat\x20sitting\x20on\x20a\x20glowing\x20throne,\x20intricate\x20lighting\x20and\x20dramatic\x20shadows\x22\x0a\x20\x20}\x0a]\x0a\x0aAvoid\x20returning\x20\x22ai\x22\x20as\x20a\x20command\x20unless\x20the\x20user\x20explicitly\x20asks\x20to\x20chat\x20or\x20talk\x20with\x20the\x20bot.\x0a\x0aRespond\x20ONLY\x20with\x20raw\x20JSON\x20like:\x0a[\x0a\x20\x20{\x20\x22name\x22:\x20\x22commandName\x22,\x20\x22args\x22:\x20\x22argument\x20string\x22\x20}\x0a]\x0a\x0aNo\x20explanations,\x20no\x20markdown,\x20no\x20code\x20blocks.\x0a','generateContent','9flkGvm','ðŸ”\x20Extracting\x20commands...','extractCommands:\x20Expected\x20array,\x20got:','replace','ðŸ§ \x20Remixing\x20with\x20AI...','Sorry,\x20I\x27m\x20having\x20trouble\x20processing\x20your\x20request\x20right\x20now.','utf8','users','readFileSync','.\x0aTime\x20now:\x20','apiKeys.txt','...','ai_remember.json','../utils/statusUpdater.js','raw','ðŸ¤–\x20Thinking...','msg','âŒ\x20not\x20found','8jgFmEZ','\x0aRespond\x20casually\x20and\x20helpfully:','5111298ClSUlD','keys'];a0_0x1653=function(){return _0x173c7e;};return a0_0x1653();}async function extractCommands(_0x1b845c){const _0xd4ddb9=a0_0x524adc,{commandMap:_0x476d9c,aliasMap:_0x3b6803}=require(_0xd4ddb9(0x1a1)),_0x5410be=[...new Set([..._0x476d9c[_0xd4ddb9(0x1d6)](),..._0x3b6803[_0xd4ddb9(0x1d6)]()])],_0x19be8e='\x0aYou\x20are\x20a\x20command\x20interpreter\x20for\x20a\x20chatbot.\x0a\x0aFrom\x20the\x20user\x27s\x20message:\x20\x22'+_0x1b845c+'\x22\x0a\x0aMatch\x20it\x20to\x20one\x20or\x20more\x20commands\x20from\x20this\x20list:\x0a'+_0x5410be['join'](',\x20')+_0xd4ddb9(0x1bf);try{const _0x137ac1=await model[_0xd4ddb9(0x1c0)](_0x19be8e);let _0x1a0663=_0x137ac1['response'][_0xd4ddb9(0x1a8)]()[_0xd4ddb9(0x1ba)]();_0x1a0663=_0x1a0663[_0xd4ddb9(0x1c4)](/`/g,'')['replace'](/```json/g,'')[_0xd4ddb9(0x1c4)](/```/g,''),console[_0xd4ddb9(0x1b8)]('[extractCommands]\x20Gemini\x20raw\x20output:\x0a',_0x1a0663);const _0x9eb3aa=JSON[_0xd4ddb9(0x198)](_0x1a0663);if(!Array[_0xd4ddb9(0x17b)](_0x9eb3aa))return console[_0xd4ddb9(0x180)](_0xd4ddb9(0x1c3),_0x9eb3aa),[];return _0x9eb3aa;}catch(_0x5cc49f){return console['error']('Failed\x20to\x20extract\x20commands\x20from\x20prompt:',_0x5cc49f),[];}}module['exports']={'meta':{'name':'ai','description':a0_0x524adc(0x188),'usage':a0_0x524adc(0x19b),'args':[{'name':a0_0x524adc(0x1a8),'type':a0_0x524adc(0x183),'greedy':!![],'required':!![]}],'category':'AI'},'run':async({m:_0x2b7772,sock:_0x2efc1a,args:_0x39ffa2})=>{const _0x527af9=a0_0x524adc,_0x190558=_0x2b7772[_0x527af9(0x1aa)][_0x527af9(0x1d7)],_0x443107=_0x2b7772[_0x527af9(0x1aa)][_0x527af9(0x1bd)]||_0x190558,_0x11d1f7=_0x39ffa2[_0x527af9(0x1a8)],_0x3b12c9=_0x2b7772['message']?.[_0x527af9(0x1a4)]?.[_0x527af9(0x197)]?.[_0x527af9(0x191)],_0x1073fd=new StatusUpdater(_0x2efc1a,_0x190558);await _0x1073fd['start'](),await _0x1073fd['update'](_0x527af9(0x1d0)),addMemory(_0x443107,_0x527af9(0x196),_0x11d1f7);let _0xf60420;try{await _0x1073fd[_0x527af9(0x17c)](_0x527af9(0x1c2)),_0xf60420=await extractCommands(_0x11d1f7);}catch(_0x555961){return console[_0x527af9(0x180)](_0x527af9(0x189),_0x555961),_0x2efc1a[_0x527af9(0x1ac)](_0x190558,{'text':'Failed\x20to\x20process\x20your\x20request.'});}if(!Array[_0x527af9(0x17b)](_0xf60420))return console[_0x527af9(0x180)](_0x527af9(0x18a),_0xf60420),_0x2efc1a[_0x527af9(0x1ac)](_0x190558,{'text':_0x527af9(0x19c)});const _0x58c7d4=[];let _0x47467f=![];for(const {name:_0x4d3da2,args:_0x42c62b}of _0xf60420){await _0x1073fd[_0x527af9(0x17c)](_0x527af9(0x1ab)+_0x4d3da2+_0x527af9(0x1cc));const {output:_0x15a6d8,directUsed:_0x156940}=await runCommand(_0x4d3da2,_0x42c62b,_0x190558,_0x2efc1a,_0x3b12c9);if(_0x15a6d8)_0x58c7d4[_0x527af9(0x1b9)]({'name':_0x4d3da2,'raw':_0x15a6d8});if(_0x156940)_0x47467f=!![];}const _0xf097a1=_0x58c7d4[_0x527af9(0x19e)](_0x15375d=>_0x15375d[_0x527af9(0x1b3)]+':\x20'+_0x15375d[_0x527af9(0x1cf)])['join']('\x0a');if(_0x47467f){console[_0x527af9(0x1b8)](_0x527af9(0x1b6)),await _0x1073fd[_0x527af9(0x1a2)](_0x527af9(0x181));return;}const _0x5f5d4b=persona+_0x527af9(0x1a9)+botSettings['botName']+_0x527af9(0x1bc)+botSettings[_0x527af9(0x1b0)]+_0x527af9(0x1ca)+new Date()[_0x527af9(0x1b5)]()+_0x527af9(0x1af)+_0x11d1f7+_0x527af9(0x1be)+_0xf097a1+_0x527af9(0x1b4);let _0x4626a5='';const _0x373315=0x3;let _0x329096=0x0;while(_0x329096<_0x373315){try{await _0x1073fd[_0x527af9(0x17c)](_0x527af9(0x1c5));const _0x535c1f=await model[_0x527af9(0x1c0)](_0x5f5d4b);_0x4626a5=_0x535c1f['response'][_0x527af9(0x1a8)]()[_0x527af9(0x1ba)]();break;}catch(_0x38e19c){if(_0x38e19c['data']===0x1ad){console[_0x527af9(0x180)]('Rate\x20limit\x20error:',_0x38e19c),_0x329096++;const _0x30424a=Math[_0x527af9(0x190)](0x2,_0x329096)*0x3e8;await new Promise(_0x2f7b78=>setTimeout(_0x2f7b78,_0x30424a)),rotateKey();}else{console[_0x527af9(0x180)](_0x527af9(0x199),_0x38e19c),_0x4626a5=_0x527af9(0x1c6);break;}}}if(!_0x58c7d4['length']){const _0xd76f0c=persona+_0x527af9(0x193)+_0x11d1f7+_0x527af9(0x1d4);try{const _0x346217=await model[_0x527af9(0x1c0)](_0xd76f0c);_0x4626a5=_0x346217[_0x527af9(0x195)][_0x527af9(0x1a8)]()['trim']();}catch(_0xca4fda){console[_0x527af9(0x180)](_0x527af9(0x199),_0xca4fda),_0x4626a5=_0x527af9(0x1c6);}}addMemory(_0x443107,'assistant',_0x4626a5);const _0x31ef5e=_0x527af9(0x184)+_0x11d1f7+'\x0aCommands\x20used:\x20'+_0x58c7d4['map'](_0x20d811=>_0x20d811[_0x527af9(0x1b3)])[_0x527af9(0x17f)](',')+'\x0aDo\x20you\x20want\x20to\x20store\x20anything?\x20Respond\x20with\x20JSON\x20{\x22user\x22:\x20\x22\x22,\x20\x22global\x22:\x20\x22\x22}';try{const _0x36538a=await model[_0x527af9(0x1c0)](_0x31ef5e),_0x2474fd=JSON[_0x527af9(0x198)](_0x36538a['response'][_0x527af9(0x1a8)]());if(_0x2474fd[_0x527af9(0x196)])REMEMBER[_0x527af9(0x1c8)][_0x443107]=_0x2474fd[_0x527af9(0x196)];if(_0x2474fd[_0x527af9(0x19f)])REMEMBER[_0x527af9(0x19f)]=_0x2474fd[_0x527af9(0x19f)];saveJson(REM_FILE,REMEMBER);}catch{}const _0x1311b2=_0x4626a5+_0x527af9(0x192);await _0x1073fd[_0x527af9(0x1a2)](_0x1311b2);}};